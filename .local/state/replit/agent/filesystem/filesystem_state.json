{"file_contents":{"yuzha/src/counter/counterButtons.tsx":{"content":"import React from \"react\";\nimport { stageToViewportCoords, type StageTransform } from \"@shared/layer\";\nimport { requireAssetUrl } from \"@shared/asset/assetResolver\";\n\nconst iconBack = requireAssetUrl(\"general_icon_jiantou1\");\nconst iconReset = requireAssetUrl(\"general_icon_shuaxin\");\nconst iconSettings = requireAssetUrl(\"general_icon_shezhi\");\n\ntype ScreenPosition = { x: number; y: number };\n\ntype BaseButtonProps = {\n  screenPosition: ScreenPosition;\n  onClick?: () => void;\n  size?: number;\n  icon: string;\n  label: string;\n};\n\nconst BUTTON_BASE_SIZE = 56;\n\nfunction FloatingButton({\n  screenPosition,\n  onClick,\n  size = BUTTON_BASE_SIZE,\n  icon,\n  label,\n}: BaseButtonProps) {\n  return (\n    <div\n      className=\"pointer-events-none fixed z-30\"\n      style={{ left: screenPosition.x, top: screenPosition.y }}\n    >\n      <button\n        type=\"button\"\n        className=\"pointer-events-auto rounded-lg bg-transparent shadow-sm shadow-black/30 transition hover:scale-[1.05] active:scale-95\"\n        onClick={onClick}\n        aria-label={label}\n        style={{ width: size, height: size }}\n      >\n        <img src={icon} alt={label} className=\"h-full w-full object-contain\" draggable={false} />\n      </button>\n    </div>\n  );\n}\n\nexport function CounterBackButton(props: Omit<BaseButtonProps, \"icon\">) {\n  return <FloatingButton {...props} icon={iconBack} label=\"Back\" />;\n}\n\nexport function CounterResetButton(props: Omit<BaseButtonProps, \"icon\">) {\n  return <FloatingButton {...props} icon={iconReset} label=\"Reset\" />;\n}\n\nexport function CounterSettingsButton(props: Omit<BaseButtonProps, \"icon\">) {\n  return <FloatingButton {...props} icon={iconSettings} label=\"Settings\" />;\n}\n\nexport { BUTTON_BASE_SIZE };\n\ntype CounterControlsProps = {\n  transform: StageTransform;\n  backStagePosition?: ScreenPosition;\n  resetStagePosition: ScreenPosition;\n  settingsStagePosition: ScreenPosition;\n  onBack?: () => void;\n  onReset: () => void;\n  onToggleSettings: () => void;\n  showSettings: boolean;\n};\n\ntype ScreenResult = { x: number; y: number };\n\nconst MIN_SIZE = 48;\nconst MAX_SIZE = 72;\n\nfunction clampToViewport(pos: ScreenResult, size: number): ScreenResult {\n  if (typeof window === \"undefined\") return pos;\n  const margin = 8;\n  const maxX = Math.max(margin, window.innerWidth - size - margin);\n  const maxY = Math.max(margin, window.innerHeight - size - margin);\n  return {\n    x: Math.min(maxX, Math.max(margin, pos.x)),\n    y: Math.min(maxY, Math.max(margin, pos.y)),\n  };\n}\n\nfunction resolveOverlap(items: ScreenResult[], size: number): ScreenResult[] {\n  const gap = size + 8;\n  const resolved: ScreenResult[] = [];\n\n  items.forEach((pos) => {\n    const adjusted = { ...pos };\n    for (const prev of resolved) {\n      const overlapX = Math.abs(adjusted.x - prev.x) < size * 0.5;\n      const overlapY = Math.abs(adjusted.y - prev.y) < size * 0.5;\n      if (overlapX && overlapY) {\n        adjusted.y = Math.max(adjusted.y, prev.y + gap);\n      }\n    }\n    resolved.push(adjusted);\n  });\n\n  return resolved;\n}\n\nexport function CounterControls({\n  transform,\n  backStagePosition,\n  resetStagePosition,\n  settingsStagePosition,\n  onBack,\n  onReset,\n  onToggleSettings,\n  showSettings,\n}: CounterControlsProps) {\n  const controlButtonSize = React.useMemo(() => {\n    const scaled = BUTTON_BASE_SIZE * transform.scale;\n    return Math.max(MIN_SIZE, Math.min(MAX_SIZE, scaled));\n  }, [transform.scale]);\n\n  const { backPos, resetPos, settingsPos } = React.useMemo(() => {\n    const results: Array<ScreenResult> = [];\n    const includeBack = Boolean(onBack && backStagePosition);\n\n    const toScreen = (stage: ScreenPosition): ScreenResult => {\n      const { x, y } = stageToViewportCoords(stage.x, stage.y, transform);\n      const half = controlButtonSize / 2;\n      return clampToViewport({ x: x - half, y: y - half }, controlButtonSize);\n    };\n\n    if (includeBack && backStagePosition) {\n      results.push(toScreen(backStagePosition));\n    }\n    results.push(toScreen(resetStagePosition));\n    results.push(toScreen(settingsStagePosition));\n\n    const resolved = resolveOverlap(results, controlButtonSize);\n\n    return {\n      backPos: includeBack ? resolved[0] : null,\n      resetPos: includeBack ? resolved[1] : resolved[0],\n      settingsPos: includeBack ? resolved[2] : resolved[1],\n    };\n  }, [backStagePosition, controlButtonSize, onBack, resetStagePosition, settingsStagePosition, transform]);\n\n  return (\n    <>\n      {onBack && backPos ? (\n        <CounterBackButton screenPosition={backPos} onClick={onBack} label=\"Back\" size={controlButtonSize} />\n      ) : null}\n      {resetPos ? (\n        <CounterResetButton\n          screenPosition={resetPos}\n          onClick={onReset}\n          label=\"Reset\"\n          size={controlButtonSize}\n        />\n      ) : null}\n      {settingsPos ? (\n        <CounterSettingsButton\n          screenPosition={settingsPos}\n          onClick={onToggleSettings}\n          label={showSettings ? \"Hide\" : \"Settings\"}\n          size={controlButtonSize}\n        />\n      ) : null}\n    </>\n  );\n}\n","path":null,"size_bytes":5046,"size_tokens":null},"yuzha/src/counter/counterScreen.tsx":{"content":"import React, { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport * as THREE from \"three\";\nimport { createCounterPipeline } from \"./createCounterPipeline\";\nimport {\n  createStageTransformer,\n  toRendererInput,\n  roundStagePoint,\n  computeLayerBounds,\n  isLayerWithinStageBounds,\n  runPipeline,\n  createPipelineCache,\n  AnimationConstants,\n  type StagePipeline,\n  type LayerMetadata,\n  type EnhancedLayerData,\n  type LayerProcessor,\n  type LayerBounds,\n  computeCoverTransform,\n  stageToViewportCoords,\n  type StageTransform,\n} from \"@shared/layer\";\nimport { getDeviceCapability } from \"@shared/utils/DeviceCapability\";\nimport CounterFloating from \"./counterFloating\";\nimport CounterFloatingMessage from \"./counterFloatingMessage\";\nimport CounterSettings from \"./counterSettings\";\nimport { CounterControls } from \"./counterButtons\";\nimport CounterEffectDemo from \"./counterEffectDemo\";\n\nif (import.meta.hot) {\n  import.meta.hot.accept();\n}\n\ntype ThreeTransformCache = {\n  scaledWidth: number;\n  scaledHeight: number;\n  hasRotation: boolean;\n};\n\ntype ThreeMeshEntry = {\n  mesh: THREE.Mesh;\n  group: THREE.Group;\n  orbitLine?: THREE.Line;\n  baseData: EnhancedLayerData;\n  processors: LayerProcessor[];\n  transformCache: ThreeTransformCache;\n  isStatic: boolean;\n  hasAnimation: boolean;\n  baseBounds: LayerBounds;\n  geometryKey: string;\n};\n\ntype PlaneGeometryEntry = {\n  geometry: THREE.PlaneGeometry;\n  refCount: number;\n};\n\ntype WebGLAttributes = NonNullable<ReturnType<WebGLRenderingContext[\"getContextAttributes\"]>>;\n\nconst planeGeometryCache = new Map<string, PlaneGeometryEntry>();\nconst orbitLineGeometryCache = new Map<number, THREE.BufferGeometry>();\n\nconst planeGeometryKey = (width: number, height: number): string =>\n  `${width.toFixed(3)}x${height.toFixed(3)}`;\n\nconst acquirePlaneGeometry = (\n  width: number,\n  height: number,\n): { geometry: THREE.PlaneGeometry; key: string } => {\n  const key = planeGeometryKey(width, height);\n  const cached = planeGeometryCache.get(key);\n  if (cached) {\n    cached.refCount += 1;\n    return { geometry: cached.geometry, key };\n  }\n  const geometry = new THREE.PlaneGeometry(width, height);\n  planeGeometryCache.set(key, { geometry, refCount: 1 });\n  return { geometry, key };\n};\n\nconst releasePlaneGeometry = (key: string): void => {\n  const cached = planeGeometryCache.get(key);\n  if (!cached) return;\n  cached.refCount -= 1;\n  if (cached.refCount <= 0) {\n    cached.geometry.dispose();\n    planeGeometryCache.delete(key);\n  }\n};\n\nconst getOrbitLineGeometry = (segments: number): THREE.BufferGeometry => {\n  const cached = orbitLineGeometryCache.get(segments);\n  if (cached) return cached;\n  const points: THREE.Vector3[] = [];\n  for (let i = 0; i <= segments; i += 1) {\n    const angle = (i / segments) * Math.PI * 2;\n    points.push(new THREE.Vector3(Math.cos(angle), Math.sin(angle), 0));\n  }\n  const geometry = new THREE.BufferGeometry().setFromPoints(points);\n  orbitLineGeometryCache.set(segments, geometry);\n  return geometry;\n};\n\nasync function mountThreeLayers(\n  scene: THREE.Scene,\n  renderer: THREE.WebGLRenderer,\n  camera: THREE.Camera,\n  layersWithProcessors: Array<{\n    data: EnhancedLayerData;\n    processors: LayerProcessor[];\n    metadata: LayerMetadata;\n  }>,\n  stageSize: number,\n): Promise<() => void> {\n  const meshData: ThreeMeshEntry[] = [];\n  const textureLoader = new THREE.TextureLoader();\n  const pipelineCache = createPipelineCache<EnhancedLayerData>();\n  const halfStage = stageSize / 2;\n  const computeRuntimeBounds = (data: EnhancedLayerData): LayerBounds =>\n    computeLayerBounds(data.position, data.scale, data.imageMapping);\n  const shouldRenderEntry = (entry: ThreeMeshEntry, enhanced: EnhancedLayerData): boolean => {\n    if (enhanced.visible === false) return false;\n    const padding = entry.hasAnimation ? 96 : 40;\n    return isLayerWithinStageBounds(computeRuntimeBounds(enhanced), stageSize, padding);\n  };\n\n  const texturePromises = layersWithProcessors.map(async (item) => {\n    try {\n      const texture = await textureLoader.loadAsync(item.data.imageUrl);\n      texture.flipY = false;\n      texture.premultiplyAlpha = false;\n      texture.colorSpace = THREE.SRGBColorSpace;\n      texture.minFilter = THREE.LinearFilter;\n      texture.magFilter = THREE.LinearFilter;\n      texture.anisotropy = 1;\n      texture.generateMipmaps = false;\n      if (item.data.blendMode === \"additive\") {\n        texture.wrapS = THREE.ClampToEdgeWrapping;\n        texture.wrapT = THREE.ClampToEdgeWrapping;\n      }\n      return { item, texture };\n    } catch (error) {\n      console.error(`[CounterStageThree] Failed to load texture for \"${item.data.ImageID}\"`, error);\n      return null;\n    }\n  });\n\n  const results = await Promise.all(texturePromises);\n\n  for (const result of results) {\n    if (!result) continue;\n\n    const { item, texture } = result;\n    const { data, processors, metadata } = item;\n    const { isStatic, hasAnimation, baseBounds, visibleByDefault } = metadata;\n    const opacity = data.opacity ?? 1;\n    const blendMode =\n      data.blendMode === \"additive\" ? THREE.AdditiveBlending : THREE.NormalBlending;\n    const useLuminanceAlpha = data.blendMode === \"additive\";\n    const alphaTestValue = useLuminanceAlpha ? 0.1 : 0;\n\n    const scaledWidth = texture.image.width * data.scale.x;\n    const scaledHeight = texture.image.height * data.scale.y;\n\n    const transformCache: ThreeTransformCache = {\n      scaledWidth,\n      scaledHeight,\n      hasRotation: (data.rotation ?? 0) !== 0,\n    };\n    const offscreenStatic =\n      isStatic && visibleByDefault && !isLayerWithinStageBounds(baseBounds, stageSize);\n    if (offscreenStatic) {\n      if (typeof texture.dispose === \"function\") {\n        texture.dispose();\n      }\n      continue;\n    }\n\n    const { geometry: planeGeometry, key: geometryKey } = acquirePlaneGeometry(\n      scaledWidth,\n      scaledHeight,\n    );\n    const materialConfig: THREE.MeshBasicMaterialParameters = {\n      map: texture,\n      transparent: true,\n      side: THREE.DoubleSide,\n      depthWrite: false,\n      blending: blendMode,\n      opacity,\n    };\n    if (useLuminanceAlpha) {\n      materialConfig.alphaMap = texture;\n      materialConfig.alphaTest = alphaTestValue;\n    }\n    const planeMaterial = new THREE.MeshBasicMaterial(materialConfig);\n\n    const mesh = new THREE.Mesh(planeGeometry, planeMaterial);\n    const group = new THREE.Group();\n\n    const initialPosition = roundStagePoint(data.position);\n    group.position.set(initialPosition.x - halfStage, halfStage - initialPosition.y, 0);\n    group.add(mesh);\n    scene.add(group);\n\n    let orbitLine: THREE.Line | undefined;\n    const baseRadiusRounded = Math.max(0, Math.round(data.orbitRadius ?? 0));\n    if (data.orbitLineVisible && baseRadiusRounded > 0 && data.orbitStagePoint) {\n      const circleGeometry = getOrbitLineGeometry(64);\n      const circleMaterial = new THREE.LineBasicMaterial({\n        color: 0xffffff,\n        transparent: true,\n        opacity: 0.25,\n      });\n      orbitLine = new THREE.LineLoop(circleGeometry, circleMaterial);\n      orbitLine.userData = { baseRadius: Math.max(baseRadiusRounded, 1) };\n      const roundedStagePoint = roundStagePoint(data.orbitStagePoint);\n      orbitLine.position.set(roundedStagePoint.x - halfStage, halfStage - roundedStagePoint.y, 0);\n      orbitLine.scale.set(baseRadiusRounded, baseRadiusRounded, 1);\n      scene.add(orbitLine);\n    }\n\n    meshData.push({\n      mesh,\n      group,\n      orbitLine,\n      baseData: data,\n      processors,\n      transformCache,\n      isStatic,\n      hasAnimation,\n      baseBounds,\n      geometryKey,\n    });\n  }\n\n  let animationFrameId: number | null = null;\n  const animate = (timestamp: number) => {\n    for (const entry of meshData) {\n      const enhanced =\n        entry.hasAnimation && entry.processors.length > 0\n          ? pipelineCache.get(entry.baseData.LayerID, () =>\n              runPipeline(entry.baseData, entry.processors, timestamp),\n            )\n          : entry.baseData;\n      const currentOpacity = enhanced.opacity ?? 1;\n      if (entry.mesh.material instanceof THREE.Material) {\n        entry.mesh.material.opacity = currentOpacity;\n      }\n\n      const isVisible = shouldRenderEntry(entry, enhanced);\n      entry.group.visible = isVisible;\n      entry.mesh.visible = isVisible;\n      if (!isVisible) {\n        if (entry.orbitLine) {\n          entry.orbitLine.visible = false;\n        }\n        continue;\n      }\n\n      const position =\n        enhanced.hasOrbitalAnimation || enhanced.hasSpinAnimation\n          ? enhanced.position\n          : roundStagePoint(enhanced.position);\n      entry.group.position.set(position.x - halfStage, halfStage - position.y, 0);\n\n      const rotation =\n        enhanced.currentRotation ?? enhanced.rotation ?? entry.baseData.rotation ?? 0;\n      entry.group.rotation.z = -(rotation * AnimationConstants.DEG_TO_RAD);\n\n      if (entry.orbitLine) {\n        const roundedStagePoint = enhanced.orbitStagePoint\n          ? roundStagePoint(enhanced.orbitStagePoint)\n          : undefined;\n        const roundedRadius = Math.max(0, Math.round(enhanced.orbitLineStyle?.radius ?? 0));\n        if (\n          enhanced.orbitLineStyle?.visible &&\n          roundedStagePoint &&\n          roundedRadius > 0 &&\n          enhanced.visible !== false\n        ) {\n          const baseRadius = entry.orbitLine.userData?.baseRadius ?? 1;\n          const scale = baseRadius > 0 ? roundedRadius / baseRadius : 1;\n          entry.orbitLine.visible = true;\n          entry.orbitLine.position.set(\n            roundedStagePoint.x - halfStage,\n            -(roundedStagePoint.y - halfStage),\n            0,\n          );\n          entry.orbitLine.scale.set(baseRadius * scale, baseRadius * scale, 1);\n        } else {\n          entry.orbitLine.visible = false;\n        }\n      }\n    }\n\n    renderer.render(scene, camera);\n    pipelineCache.nextFrame();\n    animationFrameId = requestAnimationFrame(animate);\n  };\n\n  animationFrameId = requestAnimationFrame(animate);\n\n  return () => {\n    if (animationFrameId !== null) cancelAnimationFrame(animationFrameId);\n\n    meshData.forEach((entry) => {\n      scene.remove(entry.group);\n      releasePlaneGeometry(entry.geometryKey);\n      if (entry.mesh.material instanceof THREE.Material) {\n        entry.mesh.material.dispose();\n      }\n      if (entry.orbitLine) {\n        scene.remove(entry.orbitLine);\n        if (entry.orbitLine.material instanceof THREE.Material) {\n          entry.orbitLine.material.dispose();\n        }\n      }\n    });\n\n    pipelineCache.clear();\n    meshData.length = 0;\n    renderer.dispose();\n  };\n}\n\nasync function mountThreeRenderer(\n  container: HTMLDivElement,\n  canvas: HTMLCanvasElement,\n  pipeline: StagePipeline,\n): Promise<() => void> {\n  const deviceCap = getDeviceCapability();\n\n  canvas.width = pipeline.stageSize;\n  canvas.height = pipeline.stageSize;\n\n  const webglAttributes: WebGLAttributes = {\n    alpha: true,\n    antialias: deviceCap.enableAntialiasing,\n    premultipliedAlpha: true,\n    powerPreference: deviceCap.isLowEndDevice ? \"low-power\" : \"default\",\n  };\n\n  const webglContext =\n    (canvas.getContext(\"webgl2\", webglAttributes) as WebGL2RenderingContext | null) ??\n    (canvas.getContext(\"webgl\", webglAttributes) as WebGLRenderingContext | null);\n\n  if (webglContext) {\n    // texImage3D in WebGL2 rejects flipY/premultiplied uploads, so clear the flags up front.\n    webglContext.pixelStorei(webglContext.UNPACK_FLIP_Y_WEBGL, 0);\n    webglContext.pixelStorei(webglContext.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 0);\n  }\n\n  const renderer = new THREE.WebGLRenderer({\n    canvas,\n    context: webglContext ?? undefined,\n    alpha: true,\n    antialias: deviceCap.enableAntialiasing,\n    powerPreference: webglAttributes.powerPreference,\n    premultipliedAlpha: true,\n  });\n  renderer.setPixelRatio(deviceCap.pixelRatio);\n  renderer.setSize(pipeline.stageSize, pipeline.stageSize, false);\n  renderer.setClearColor(0x000000, 0);\n  renderer.outputColorSpace = THREE.SRGBColorSpace;\n\n  const half = pipeline.stageSize / 2;\n  const camera = new THREE.OrthographicCamera(-half, half, half, -half, 0.1, 2000);\n  camera.position.z = 1000;\n\n  const scene = new THREE.Scene();\n\n  const cleanupTransform = createStageTransformer(canvas, container, { resizeDebounce: 100 });\n\n  const cleanupLayers = await mountThreeLayers(\n    scene,\n    renderer,\n    camera,\n    toRendererInput(pipeline),\n    pipeline.stageSize,\n  );\n\n  return () => {\n    cleanupTransform?.();\n    cleanupLayers?.();\n    renderer.dispose();\n  };\n}\n\nfunction CounterStageThree() {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const container = containerRef.current;\n    const canvas = canvasRef.current;\n    if (!container || !canvas) return;\n\n    let cleanup: (() => void) | undefined;\n    let active = true;\n\n    (async () => {\n      const pipeline = await createCounterPipeline();\n      if (!active) return;\n      cleanup = await mountThreeRenderer(container, canvas, pipeline);\n    })().catch((error) => {\n      console.error(\"[CounterStageThree] Failed to initialize Three.js stage\", error);\n    });\n\n    return () => {\n      active = false;\n      cleanup?.();\n    };\n  }, []);\n\n  return (\n    <div ref={containerRef} className=\"absolute inset-0 z-0 pointer-events-none\">\n      <canvas ref={canvasRef} className=\"block\" />\n    </div>\n  );\n}\n\nexport type CounterScreenProps = {\n  onBack?: () => void;\n};\n\nconst COUNT_STORAGE_KEY = \"counter/progress/v1\";\nconst INITIAL_TRANSFORM: StageTransform = { scale: 1, offsetX: 0, offsetY: 0, width: 2048, height: 2048 };\n\nfunction useStageTransform() {\n  const [transform, setTransform] = useState<StageTransform>(() =>\n    typeof window !== \"undefined\"\n      ? computeCoverTransform(window.innerWidth, window.innerHeight)\n      : INITIAL_TRANSFORM,\n  );\n\n  useEffect(() => {\n    const handleResize = () => {\n      setTransform(computeCoverTransform(window.innerWidth, window.innerHeight));\n    };\n    handleResize();\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n\n  const clampToViewport = useCallback((pos: { x: number; y: number }, size: number) => {\n    if (typeof window === \"undefined\") return pos;\n    const margin = 8;\n    const maxX = Math.max(margin, window.innerWidth - size - margin);\n    const maxY = Math.max(margin, window.innerHeight - size - margin);\n    return {\n      x: Math.min(maxX, Math.max(margin, pos.x)),\n      y: Math.min(maxY, Math.max(margin, pos.y)),\n    };\n  }, []);\n\n  const toScreenPosition = useCallback(\n    (stagePos: { x: number; y: number }, size: number) => {\n      const { x, y } = stageToViewportCoords(stagePos.x, stagePos.y, transform);\n      const half = size / 2;\n      return clampToViewport({ x: x - half, y: y - half }, size);\n    },\n    [clampToViewport, transform],\n  );\n\n  return { transform, toScreenPosition };\n}\n\nfunction useCounterActions(hapticsEnabled: boolean, soundEnabled: boolean) {\n  const [count, setCount] = useState(0);\n  const [isBumping, setIsBumping] = useState(false);\n  const bumpTimeoutRef = useRef<number | undefined>(undefined);\n\n  useEffect(() => {\n    const saved = window.localStorage.getItem(COUNT_STORAGE_KEY);\n    if (saved !== null) {\n      const parsed = Number(saved);\n      if (!Number.isNaN(parsed)) {\n        setCount(parsed);\n      }\n    }\n    return () => {\n      if (bumpTimeoutRef.current !== undefined) {\n        clearTimeout(bumpTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  const triggerFeedback = useCallback(() => {\n    setIsBumping(true);\n    if (bumpTimeoutRef.current !== undefined) {\n      clearTimeout(bumpTimeoutRef.current);\n    }\n    bumpTimeoutRef.current = window.setTimeout(() => setIsBumping(false), 250);\n\n    if (hapticsEnabled && \"vibrate\" in navigator) {\n      navigator.vibrate(20);\n    }\n    if (soundEnabled) {\n      const audio = new Audio(\"/sound/dice.wav\");\n      audio.volume = 0.2;\n      audio.play().catch(() => {});\n    }\n  }, [hapticsEnabled, soundEnabled]);\n\n  const increment = useCallback(() => {\n    setCount((prev) => {\n      const next = prev + 1;\n      window.localStorage.setItem(COUNT_STORAGE_KEY, String(next));\n      return next;\n    });\n    triggerFeedback();\n  }, [triggerFeedback]);\n\n  const reset = useCallback(() => {\n    setCount(0);\n    window.localStorage.setItem(COUNT_STORAGE_KEY, \"0\");\n    triggerFeedback();\n  }, [triggerFeedback]);\n\n  return { count, isBumping, increment, reset };\n}\n\nexport default function CounterScreen({ onBack }: CounterScreenProps) {\n  const [floatingSize, setFloatingSize] = useState(250);\n  const [messageSize, setMessageSize] = useState(240);\n  const [messageFontSize, setMessageFontSize] = useState(90);\n  const [messageColor, setMessageColor] = useState(\"#ffffff\");\n  const [hapticsEnabled, setHapticsEnabled] = useState(true);\n  const [soundEnabled, setSoundEnabled] = useState(false);\n  const [showSettings, setShowSettings] = useState(false);\n  const [showEffectDemo, setShowEffectDemo] = useState(false);\n  const [stagePosition, setStagePosition] = useState({ x: 1024, y: 1300 });\n  const [messageStagePosition, setMessageStagePosition] = useState({ x: 1024, y: 400 });\n  const [backStagePosition, setBackStagePosition] = useState({ x: 180, y: 180 });\n  const [resetStagePosition, setResetStagePosition] = useState({ x: 280, y: 180 });\n  const [settingsStagePosition, setSettingsStagePosition] = useState({ x: 380, y: 180 });\n\n  const { transform, toScreenPosition } = useStageTransform();\n  const { count, isBumping, increment, reset } = useCounterActions(hapticsEnabled, soundEnabled);\n\n  const floatingScreenPosition = useMemo(\n    () => toScreenPosition(stagePosition, floatingSize),\n    [floatingSize, stagePosition, toScreenPosition],\n  );\n\n  const messageScreenPosition = useMemo(\n    () => toScreenPosition(messageStagePosition, messageSize),\n    [messageSize, messageStagePosition, toScreenPosition],\n  );\n\n  const handleContextMenu = React.useCallback((event: React.MouseEvent) => {\n    event.preventDefault();\n  }, []);\n\n  return (\n    <div\n      className=\"counter-no-context relative h-screen w-screen overflow-hidden bg-slate-950 text-white\"\n      onContextMenu={handleContextMenu}\n    >\n      <CounterStageThree />\n      {showSettings && (\n        <CounterSettings\n          size={floatingSize}\n          onSizeChange={setFloatingSize}\n          position={stagePosition}\n          onPositionChange={setStagePosition}\n          messageSize={messageSize}\n          onMessageSizeChange={setMessageSize}\n          messagePosition={messageStagePosition}\n          onMessagePositionChange={setMessageStagePosition}\n          messageFontSize={messageFontSize}\n          onMessageFontSizeChange={setMessageFontSize}\n          messageColor={messageColor}\n          onMessageColorChange={setMessageColor}\n          hapticsEnabled={hapticsEnabled}\n          onHapticsToggle={setHapticsEnabled}\n          soundEnabled={soundEnabled}\n          onSoundToggle={setSoundEnabled}\n          backPosition={backStagePosition}\n          onBackPositionChange={setBackStagePosition}\n          resetPosition={resetStagePosition}\n          onResetPositionChange={setResetStagePosition}\n          settingsPosition={settingsStagePosition}\n          onSettingsPositionChange={setSettingsStagePosition}\n          onOpenDemo={() => setShowEffectDemo(true)}\n          onClose={() => setShowSettings(false)}\n        />\n      )}\n      {showEffectDemo && <CounterEffectDemo onClose={() => setShowEffectDemo(false)} />}\n      <CounterControls\n        transform={transform}\n        backStagePosition={backStagePosition}\n        resetStagePosition={resetStagePosition}\n        settingsStagePosition={settingsStagePosition}\n        onBack={onBack}\n        onReset={reset}\n        onToggleSettings={() => setShowSettings((prev) => !prev)}\n        showSettings={showSettings}\n      />\n      <CounterFloating\n        size={floatingSize}\n        screenPosition={floatingScreenPosition}\n        onActivate={increment}\n      />\n      <CounterFloatingMessage size={messageSize} screenPosition={messageScreenPosition}>\n        <div\n          className={`flex w-full items-center justify-center text-white drop-shadow ${\n            isBumping ? \"count-bump\" : \"\"\n          }`}\n          style={{\n            fontFamily: \"Taimingda, sans-serif\",\n            fontSize: messageFontSize,\n            color: messageColor,\n            WebkitTextStroke: \"1px rgba(0,0,0,0.6)\", //stroke for better visibility\n            textShadow: \"0 0 5px rgba(0,0,0,0.8)\",\n          }}\n        >\n          {count}\n        </div>\n      </CounterFloatingMessage>\n    </div>\n  );\n}\n","path":null,"size_bytes":20714,"size_tokens":null},"meng/tailwind.config.ts":{"content":"import type { Config } from 'tailwindcss'\n\n/**\n * Tailwind CSS Configuration\n *\n * Purpose: Configure Tailwind utility classes and design system\n * Theme: Garden/Nature inspired color palette for restaurant website\n *\n * For future AI agents:\n * - Primary color: Green (garden theme)\n * - Secondary: Warm earth tones\n * - Responsive breakpoints: sm, md, lg, xl, 2xl\n * - Custom animations and transitions configured\n */\nexport default {\n  content: ['./index.html', './src/**/*.{js,ts,jsx,tsx}'],\n  theme: {\n    extend: {\n      colors: {\n        primary: {\n          50: '#f0fdf4',\n          100: '#dcfce7',\n          200: '#bbf7d0',\n          300: '#86efac',\n          400: '#4ade80',\n          500: '#22c55e',\n          600: '#16a34a',\n          700: '#15803d',\n          800: '#166534',\n          900: '#14532d',\n        },\n        secondary: {\n          50: '#fef3c7',\n          100: '#fde68a',\n          200: '#fcd34d',\n          300: '#fbbf24',\n          400: '#f59e0b',\n          500: '#d97706',\n          600: '#b45309',\n          700: '#92400e',\n          800: '#78350f',\n          900: '#451a03',\n        },\n      },\n      fontFamily: {\n        sans: ['Inter', 'system-ui', 'sans-serif'],\n        display: ['Poppins', 'system-ui', 'sans-serif'],\n      },\n      animation: {\n        'fade-in': 'fadeIn 0.5s ease-in-out',\n        'slide-up': 'slideUp 0.6s ease-out',\n        'scale-in': 'scaleIn 0.4s ease-out',\n      },\n      keyframes: {\n        fadeIn: {\n          '0%': { opacity: '0' },\n          '100%': { opacity: '1' },\n        },\n        slideUp: {\n          '0%': { transform: 'translateY(20px)', opacity: '0' },\n          '100%': { transform: 'translateY(0)', opacity: '1' },\n        },\n        scaleIn: {\n          '0%': { transform: 'scale(0.95)', opacity: '0' },\n          '100%': { transform: 'scale(1)', opacity: '1' },\n        },\n      },\n    },\n  },\n  plugins: [],\n} satisfies Config\n","path":null,"size_bytes":1909,"size_tokens":null},"shared/utils/DeviceCapability.ts":{"content":"/**\n * Device capability detection for adaptive performance settings\n * Optimized for mid-low end Android devices\n */\n\nexport type DevicePerformanceLevel = \"high\" | \"medium\" | \"low\";\n\nexport interface DeviceCapability {\n  performanceLevel: DevicePerformanceLevel;\n  isMobile: boolean;\n  isLowEndDevice: boolean;\n  pixelRatio: number;\n  enableAntialiasing: boolean;\n  maxTextureSize: number;\n}\n\nfunction detectPerformanceLevel(): DevicePerformanceLevel {\n  if (typeof navigator === \"undefined\") return \"medium\";\n\n  const cores = navigator.hardwareConcurrency || 4;\n  const memory = (navigator as any).deviceMemory || 4;\n\n  if (cores <= 4 || memory <= 2) return \"low\";\n  if (cores <= 6 || memory <= 4) return \"medium\";\n  return \"high\";\n}\n\nfunction isMobileDevice(): boolean {\n  if (typeof window === \"undefined\") return false;\n\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n}\n\nexport function getDeviceCapability(): DeviceCapability {\n  const performanceLevel = detectPerformanceLevel();\n  const isMobile = isMobileDevice();\n  const isLowEndDevice = performanceLevel === \"low\" || (isMobile && performanceLevel === \"medium\");\n\n  const pixelRatio = isLowEndDevice ? 1 : Math.min(window.devicePixelRatio || 1, 2);\n\n  const enableAntialiasing = !isMobile && performanceLevel === \"high\";\n\n  const maxTextureSize = isLowEndDevice ? 1024 : 2048;\n\n  return {\n    performanceLevel,\n    isMobile,\n    isLowEndDevice,\n    pixelRatio,\n    enableAntialiasing,\n    maxTextureSize,\n  };\n}\n","path":null,"size_bytes":1527,"size_tokens":null},"shared/component/collapsible_collapsible-outline-3.tsx":{"content":"import { Info } from \"lucide-react\";\n\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from \"@/components/ui/collapsible\";\n\nexport const title = \"Info Box Outline\";\n\nconst Example = () => (\n  <Collapsible className=\"w-full max-w-lg rounded-lg border-2 border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950\">\n    <CollapsibleTrigger className=\"flex w-full items-center gap-3 p-4\">\n      <Info className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n      <span className=\"font-medium text-blue-900 dark:text-blue-100\">\n        Important Notice\n      </span>\n    </CollapsibleTrigger>\n    <CollapsibleContent className=\"border-blue-200 border-t-2 px-4 py-3 text-blue-800 text-sm dark:border-blue-900 dark:text-blue-200\">\n      This is an informational message that provides additional context and\n      details when expanded.\n    </CollapsibleContent>\n  </Collapsible>\n);\n\nexport default Example;\n","path":null,"size_bytes":927,"size_tokens":null},"shared/component/command_command-dialog-5.tsx":{"content":"\"use client\";\n\nimport { Mail, MapPin, Phone, User } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  CommandDialog,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\n\nexport const title = \"Command Dialog with Descriptions\";\n\nconst Example = () => {\n  const [open, setOpen] = useState(false);\n\n  return (\n    <>\n      <Button onClick={() => setOpen(true)}>Search Contacts</Button>\n      <CommandDialog onOpenChange={setOpen} open={open}>\n        <CommandInput placeholder=\"Search contacts...\" />\n        <CommandList>\n          <CommandEmpty>No contacts found.</CommandEmpty>\n          <CommandGroup heading=\"Contacts\">\n            <CommandItem>\n              <User />\n              <div className=\"flex flex-col\">\n                <span>John Doe</span>\n                <span className=\"text-muted-foreground text-xs\">\n                  Software Engineer\n                </span>\n              </div>\n            </CommandItem>\n            <CommandItem>\n              <Mail />\n              <div className=\"flex flex-col\">\n                <span>jane@example.com</span>\n                <span className=\"text-muted-foreground text-xs\">Email</span>\n              </div>\n            </CommandItem>\n            <CommandItem>\n              <Phone />\n              <div className=\"flex flex-col\">\n                <span>+1 (555) 123-4567</span>\n                <span className=\"text-muted-foreground text-xs\">Mobile</span>\n              </div>\n            </CommandItem>\n            <CommandItem>\n              <MapPin />\n              <div className=\"flex flex-col\">\n                <span>San Francisco, CA</span>\n                <span className=\"text-muted-foreground text-xs\">Location</span>\n              </div>\n            </CommandItem>\n          </CommandGroup>\n        </CommandList>\n      </CommandDialog>\n    </>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":1974,"size_tokens":null},"yuzha/src/MainScreen.tsx":{"content":"import React, { useMemo, useState } from \"react\";\nimport StageCanvas from \"@shared/layer/StageCanvas\";\nimport StageThree from \"@shared/layer/StageThree\";\nimport { getRendererType } from \"@shared/utils/RendererDetector\";\nimport { useMainScreenBtnGesture, MainScreenUpdater } from \"./MainScreenUtils\";\n\nexport type RendererMode = \"auto\" | \"canvas\" | \"three\";\nexport type RendererType = \"canvas\" | \"three\";\n\nexport type MainScreenProps = {\n  children?: React.ReactNode;\n  onOpenCounterScreen?: () => void;\n  onOpenTimestampScreen?: () => void;\n  onOpenFloatingScreen?: () => void;\n  onOpenAlphaRemoveScreen?: () => void;\n};\n\nfunction MainScreenOverlay({\n  rendererLabel,\n  rendererMode,\n  onRendererModeChange,\n  onOpenCounterScreen,\n  onOpenTimestampScreen,\n  onOpenFloatingScreen,\n  onOpenAlphaRemoveScreen,\n}: {\n  rendererLabel: string;\n  rendererMode: RendererMode;\n  onRendererModeChange: (mode: RendererMode) => void;\n  onOpenCounterScreen?: () => void;\n  onOpenTimestampScreen?: () => void;\n  onOpenFloatingScreen?: () => void;\n  onOpenAlphaRemoveScreen?: () => void;\n}) {\n  const gesture = useMainScreenBtnGesture();\n\n  return (\n    <>\n      <div {...gesture.bindTargetProps()} className=\"absolute inset-0 pointer-events-auto z-20\" />\n      <MainScreenUpdater\n        visible={gesture.open}\n        rendererLabel={rendererLabel}\n        rendererMode={rendererMode}\n        onRendererModeChange={onRendererModeChange}\n        onOpenCounterScreen={onOpenCounterScreen}\n        onOpenTimestampScreen={onOpenTimestampScreen}\n        onOpenFloatingScreen={onOpenFloatingScreen}\n        onOpenAlphaRemoveScreen={onOpenAlphaRemoveScreen}\n      />\n    </>\n  );\n}\n\n/**\n * MainScreen with MainScreenUtils attached\n * Testing if overlay components break stage centering\n */\nexport default function MainScreen({\n  children,\n  onOpenCounterScreen,\n  onOpenTimestampScreen,\n  onOpenFloatingScreen,\n  onOpenAlphaRemoveScreen,\n}: MainScreenProps) {\n  const autoDetectedRenderer = useMemo(() => getRendererType(), []);\n  const [rendererMode, setRendererMode] = useState<RendererMode>(\"auto\");\n\n  const activeRenderer: RendererType =\n    rendererMode === \"auto\" ? autoDetectedRenderer : rendererMode;\n\n  const rendererLabel = React.useMemo(() => {\n    const baseLabel = activeRenderer === \"three\" ? \"Three.js WebGL Renderer\" : \"Canvas 2D Renderer\";\n    const modeLabel = rendererMode === \"auto\" ? \" (Auto)\" : ` (Manual: ${rendererMode})`;\n    return baseLabel + modeLabel;\n  }, [activeRenderer, rendererMode]);\n\n  return (\n    <div className=\"relative w-screen h-screen overflow-hidden\">\n      {activeRenderer === \"three\" ? <StageThree /> : <StageCanvas />}\n      {children ?? (\n        <MainScreenOverlay\n          rendererLabel={rendererLabel}\n          rendererMode={rendererMode}\n          onRendererModeChange={setRendererMode}\n          onOpenCounterScreen={onOpenCounterScreen}\n          onOpenTimestampScreen={onOpenTimestampScreen}\n          onOpenFloatingScreen={onOpenFloatingScreen}\n          onOpenAlphaRemoveScreen={onOpenAlphaRemoveScreen}\n        />\n      )}\n    </div>\n  );\n}\n\nexport { MainScreenOverlay };\n","path":null,"size_bytes":3111,"size_tokens":null},"yuzha/src/timestamp/ImageFloating.tsx":{"content":"import React, { forwardRef, useImperativeHandle, useRef, useState, useEffect, useCallback } from \"react\";\nimport FloatingBorderless from \"@shared/floating/FloatingBorderless\";\nimport type { BoundingRect } from \"@shared/floating/FloatingBorderless\";\nimport type { OverlayBounds } from \"./types\";\nimport { checkAABBCollision, resolveAllCollisions } from \"./types\";\n\nexport type ImageFloatingRef = {\n  getRelativePosition: () => { x: number; y: number };\n  getSize: () => { width: number; height: number };\n  setRelativePosition: (pos: { x: number; y: number }) => void;\n  setSize: (size: { width: number; height: number }) => void;\n  getBounds: () => OverlayBounds;\n};\n\nexport type ImageFloatingProps = {\n  id: string;\n  src: string;\n  boundingRect: BoundingRect;\n  initialRelativePos?: { x: number; y: number };\n  initialSize?: { width: number; height: number };\n  otherOverlayBounds?: OverlayBounds[];\n  onCollision?: (collidingId: string) => void;\n  onSizeChange?: (size: { width: number; height: number }) => void;\n  onDelete?: () => void;\n  showDebugBounds?: boolean;\n};\n\nconst ImageFloating = forwardRef<ImageFloatingRef, ImageFloatingProps>(\n  (\n    {\n      id,\n      src,\n      boundingRect,\n      initialRelativePos = { x: 20, y: 20 },\n      initialSize = { width: 100, height: 100 },\n      otherOverlayBounds = [],\n      onCollision,\n      onSizeChange,\n      onDelete,\n      showDebugBounds = false,\n    },\n    ref\n  ) => {\n    const [relativePos, setRelativePos] = useState(initialRelativePos);\n    const [size, setSize] = useState(initialSize);\n    const [isColliding, setIsColliding] = useState(false);\n    const [isHovered, setIsHovered] = useState(false);\n    const prevRelativePosRef = useRef(relativePos);\n\n    useEffect(() => {\n      prevRelativePosRef.current = relativePos;\n    }, [relativePos]);\n\n    const getBounds = useCallback((): OverlayBounds => ({\n      id,\n      x: relativePos.x,\n      y: relativePos.y,\n      width: size.width,\n      height: size.height,\n    }), [id, relativePos, size]);\n\n    useImperativeHandle(ref, () => ({\n      getRelativePosition: () => relativePos,\n      getSize: () => size,\n      setRelativePosition: (pos: { x: number; y: number }) => setRelativePos(pos),\n      setSize: (newSize: { width: number; height: number }) => setSize(newSize),\n      getBounds,\n    }));\n\n    const handleChange = useCallback((absPos: { x: number; y: number }, newSize: { width: number; height: number }) => {\n      let newRelativeX = absPos.x - boundingRect.x;\n      let newRelativeY = absPos.y - boundingRect.y;\n\n      const sizeChanged = newSize.width !== size.width || newSize.height !== size.height;\n      if (sizeChanged) {\n        setSize(newSize);\n        onSizeChange?.(newSize);\n      }\n\n      const myBounds = {\n        x: newRelativeX,\n        y: newRelativeY,\n        width: newSize.width,\n        height: newSize.height,\n      };\n\n      const result = resolveAllCollisions(myBounds, otherOverlayBounds, prevRelativePosRef.current);\n      newRelativeX = result.x;\n      newRelativeY = result.y;\n\n      if (result.hasCollision) {\n        otherOverlayBounds.forEach((other) => {\n          if (checkAABBCollision({ x: newRelativeX, y: newRelativeY, width: newSize.width, height: newSize.height }, other)) {\n            onCollision?.(other.id);\n          }\n        });\n      }\n\n      const maxX = Math.max(0, boundingRect.width - newSize.width);\n      const maxY = Math.max(0, boundingRect.height - newSize.height);\n      newRelativeX = Math.max(0, Math.min(newRelativeX, maxX));\n      newRelativeY = Math.max(0, Math.min(newRelativeY, maxY));\n\n      const finalBounds = {\n        x: newRelativeX,\n        y: newRelativeY,\n        width: newSize.width,\n        height: newSize.height,\n      };\n      const stillColliding = otherOverlayBounds.some((other) => checkAABBCollision(finalBounds, other));\n      if (stillColliding) {\n        newRelativeX = prevRelativePosRef.current.x;\n        newRelativeY = prevRelativePosRef.current.y;\n      }\n\n      setIsColliding(result.hasCollision || stillColliding);\n      setRelativePos({ x: newRelativeX, y: newRelativeY });\n    }, [boundingRect, size, otherOverlayBounds, onCollision, onSizeChange]);\n\n    const absolutePos = {\n      x: boundingRect.x + relativePos.x,\n      y: boundingRect.y + relativePos.y,\n    };\n\n    const containerStyle: React.CSSProperties = {\n      position: \"relative\",\n      width: \"100%\",\n      height: \"100%\",\n      transition: \"outline 0.15s ease-out\",\n      ...(isColliding ? {\n        outline: \"2px solid rgba(255, 100, 100, 0.8)\",\n        outlineOffset: \"-2px\",\n        borderRadius: \"2px\",\n      } : {}),\n      ...(showDebugBounds && !isColliding ? {\n        outline: \"1px dashed rgba(0, 255, 255, 0.6)\",\n        outlineOffset: \"0px\",\n      } : {}),\n    };\n\n    const imageStyle: React.CSSProperties = {\n      width: \"100%\",\n      height: \"100%\",\n      objectFit: \"contain\",\n      userSelect: \"none\",\n      pointerEvents: \"none\",\n    };\n\n    const deleteButtonStyle: React.CSSProperties = {\n      position: \"absolute\",\n      top: \"-10px\",\n      right: \"-10px\",\n      width: \"24px\",\n      height: \"24px\",\n      borderRadius: \"50%\",\n      backgroundColor: \"rgba(255, 60, 60, 0.9)\",\n      color: \"white\",\n      border: \"2px solid white\",\n      cursor: \"pointer\",\n      display: isHovered ? \"flex\" : \"none\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      fontSize: \"14px\",\n      fontWeight: \"bold\",\n      zIndex: 10,\n    };\n\n    return (\n      <FloatingBorderless\n        pos={absolutePos}\n        size={size}\n        initialSize={size}\n        minWidth={30}\n        minHeight={30}\n        boundingRect={boundingRect}\n        zIndex={1100}\n        onChange={handleChange}\n      >\n        <div\n          style={containerStyle}\n          onMouseEnter={() => setIsHovered(true)}\n          onMouseLeave={() => setIsHovered(false)}\n        >\n          <img src={src} alt=\"overlay\" style={imageStyle} draggable={false} />\n          {onDelete && (\n            <button\n              style={deleteButtonStyle}\n              onClick={(e) => {\n                e.stopPropagation();\n                onDelete();\n              }}\n              title=\"Delete image\"\n            >\n              ×\n            </button>\n          )}\n        </div>\n      </FloatingBorderless>\n    );\n  }\n);\n\nImageFloating.displayName = \"ImageFloating\";\n\nexport default ImageFloating;\n","path":null,"size_bytes":6380,"size_tokens":null},"yuzha/src/counter/counterFloatingMessage.tsx":{"content":"import React from \"react\";\nimport * as THREE from \"three\";\nimport { requireAssetUrl } from \"@shared/asset/assetResolver\";\nimport { createPolarAura } from \"@shared/effect/polaraura\";\n\nconst systemMessageBg = requireAssetUrl(\"SystemMessageBg\");\n\nexport type CounterFloatingMessageProps = {\n  size?: number;\n  screenPosition?: { x: number; y: number };\n  children?: React.ReactNode;\n};\n\n/**\n * Always-visible floating image for SystemMessageBg.\n * Minimal chrome; positioning/sizing driven by props.\n */\nexport default function CounterFloatingMessage({\n  size = 240,\n  screenPosition = { x: 24, y: 24 },\n  children,\n}: CounterFloatingMessageProps) {\n  const auraCanvasRef = React.useRef<HTMLCanvasElement | null>(null);\n\n  React.useEffect(() => {\n    if (!auraCanvasRef.current) return;\n\n    const renderer = new THREE.WebGLRenderer({\n      canvas: auraCanvasRef.current,\n      alpha: true,\n      antialias: true,\n    });\n    renderer.setClearColor(0x000000, 0);\n    renderer.setPixelRatio(window.devicePixelRatio);\n    renderer.setSize(size, size);\n\n    const scene = new THREE.Scene();\n    const camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0.1, 10);\n    camera.position.z = 1;\n\n    const loader = new THREE.TextureLoader();\n    const meshes = createPolarAura(loader);\n    meshes.forEach((mesh) => scene.add(mesh));\n\n    const clock = new THREE.Clock();\n    let animationId: number;\n\n    const animate = () => {\n      const elapsed = clock.getElapsedTime();\n      meshes.forEach((mesh) => {\n        const mat = mesh.material as THREE.ShaderMaterial;\n        if (mat.uniforms?.uTime) {\n          mat.uniforms.uTime.value = elapsed;\n        }\n      });\n      renderer.render(scene, camera);\n      animationId = requestAnimationFrame(animate);\n    };\n\n    animate();\n\n    return () => {\n      cancelAnimationFrame(animationId);\n      meshes.forEach((mesh) => {\n        mesh.geometry.dispose();\n        (mesh.material as THREE.ShaderMaterial).dispose();\n        scene.remove(mesh);\n      });\n      renderer.dispose();\n    };\n  }, [size]);\n\n  return (\n    <div\n      className=\"pointer-events-none fixed z-20\"\n      style={{\n        left: screenPosition.x,\n        top: screenPosition.y,\n      }}\n    >\n      <div\n        className=\"pointer-events-auto relative rounded-xl bg-transparent overflow-hidden\"\n        style={{\n          width: size,\n          height: size,\n          maxWidth: \"90vw\",\n          maxHeight: \"90vh\",\n        }}\n      >\n        <canvas\n          ref={auraCanvasRef}\n          className=\"pointer-events-none absolute inset-0\"\n          width={size}\n          height={size}\n        />\n        <img\n          src={systemMessageBg}\n          alt=\"System Message\"\n          className=\"pointer-events-none block h-full w-full object-contain select-none\"\n          draggable={false}\n        />\n        {children ? (\n          <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n            {children}\n          </div>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3022,"size_tokens":null},"meng/src/components/Footer.tsx":{"content":"/**\n * Footer Component\n *\n * Purpose: Website footer with copyright and additional links\n *\n * Features:\n * - Copyright information\n * - Social media links (optional)\n * - Simple and clean design\n *\n * For Future AI Agents:\n * - Keep footer simple and elegant\n * - Add social media icons if needed (Instagram, Facebook, etc.)\n * - Update year dynamically\n */\n\nconst Footer = () => {\n  const currentYear = new Date().getFullYear()\n\n  return (\n    <footer className=\"bg-gray-900 text-white py-12\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"text-center\">\n          <h3 className=\"text-2xl font-display font-bold mb-4\">The Plantation Cafe & Resto</h3>\n          <p className=\"text-gray-400 mb-6\">\n            Garden Concept Restaurant • Mountain View • Swimming Pool\n          </p>\n          <div className=\"border-t border-gray-800 pt-6\">\n            <p className=\"text-gray-400 text-sm\">\n              &copy; {currentYear} The Plantation Cafe & Resto. All rights reserved.\n            </p>\n          </div>\n        </div>\n      </div>\n    </footer>\n  )\n}\n\nexport default Footer\n","path":null,"size_bytes":1126,"size_tokens":null},"meng/src/components/Gallery.tsx":{"content":"/**\n * Gallery Component\n *\n * Purpose: Photo and video gallery showcasing restaurant, food, and ambiance\n *\n * Features:\n * - Masonry/grid layout\n * - Lightbox effect on hover\n * - Responsive grid\n * - Category filtering (optional for future)\n *\n * For Future AI Agents:\n * - Data imported from src/gallery.json\n * - Images from vision_expert_agent\n * - Grid: 1 column mobile, 2 columns tablet, 3-4 columns desktop\n * - Add lightbox library like 'yet-another-react-lightbox' for full-screen view\n * - Categories: food, ambiance, pool, exterior, interior\n */\n\nimport galleryData from '../gallery.json'\nimport type { GalleryItem } from '../types'\n\nconst galleryItems = galleryData as GalleryItem[]\n\nconst Gallery = () => {\n  return (\n    <section id=\"gallery\" className=\"py-20 bg-white\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Section Header */}\n        <div className=\"text-center mb-16\">\n          <h2 className=\"text-4xl md:text-5xl font-display font-bold text-gray-900 mb-4\">\n            Gallery\n          </h2>\n          <p className=\"text-xl text-gray-600\">Explore our ambiance and delicious cuisine</p>\n        </div>\n\n        {/* Gallery Grid */}\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\n          {galleryItems.map((item) => (\n            <div\n              key={item.id}\n              className=\"relative group overflow-hidden rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 aspect-square\"\n            >\n              <img\n                src={item.url}\n                alt={item.caption || 'Gallery image'}\n                loading=\"lazy\"\n                className=\"w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-500\"\n              />\n              {/* Overlay on hover */}\n              <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-all duration-300 flex items-center justify-center\">\n                {item.caption && (\n                  <p className=\"text-white text-center px-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 font-medium\">\n                    {item.caption}\n                  </p>\n                )}\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </section>\n  )\n}\n\nexport default Gallery\n","path":null,"size_bytes":2358,"size_tokens":null},"yuzha/src/counter/counterFloating.tsx":{"content":"import React from \"react\";\nimport { requireAssetUrl } from \"@shared/asset/assetResolver\";\n\nconst prestigeOff = requireAssetUrl(\"Prestige_SlotBase_Off\");\nconst prestigeOn = requireAssetUrl(\"Prestige_SlotBase\");\nconst glow = requireAssetUrl(\"overflow_glow_01\");\n\nexport type CounterFloatingProps = {\n  size?: number;\n  screenPosition?: { x: number; y: number };\n  onActivate?: () => void;\n};\n\nexport default function CounterFloating({\n  size = 128,\n  screenPosition = { x: 24, y: 24 },\n  onActivate,\n}: CounterFloatingProps) {\n  const [active, setActive] = React.useState(false);\n\n  const handlePointerDown = () => setActive(true);\n  const handlePointerUp = () => {\n    if (active) {\n      onActivate?.();\n    }\n    setActive(false);\n  };\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLButtonElement>) => {\n    if (event.key === \" \" || event.key === \"Enter\") {\n      setActive(true);\n    }\n  };\n  const handleKeyUp = () => {\n    if (active) {\n      onActivate?.();\n    }\n    setActive(false);\n  };\n\n  return (\n    <div\n      className=\"counter-floating pointer-events-none fixed z-20\"\n      style={{\n        left: screenPosition.x,\n        top: screenPosition.y,\n      }}\n    >\n      <div\n        className=\"relative\"\n        style={{ width: size, height: size, maxWidth: \"90vw\", maxHeight: \"90vh\" }}\n      >\n        <img\n          src={glow}\n          alt=\"\"\n          className=\"pointer-events-none absolute inset-0\"\n          style={{\n            opacity: active ? 1 : 0,\n            transform: active ? \"scale(1.6)\" : \"scale(0.85)\",\n            transition: active ? \"opacity 0.45s ease-out, transform 0.45s ease-out\" : \"none\",\n          }}\n          draggable={false}\n        />\n        <button\n          type=\"button\"\n          className=\"pointer-events-auto relative z-10 rounded-xl bg-transparent transition hover:scale-[1.02] active:scale-100\"\n          onPointerDown={handlePointerDown}\n          onPointerUp={handlePointerUp}\n          onPointerLeave={handlePointerUp}\n          onKeyDown={handleKeyDown}\n          onKeyUp={handleKeyUp}\n          aria-label=\"Counter Floating Button\"\n          style={{\n            width: size,\n            height: size,\n            maxWidth: \"90vw\",\n            maxHeight: \"90vh\",\n            boxShadow: \"none\",\n          }}\n        >\n          <img\n            src={active ? prestigeOn : prestigeOff}\n            alt=\"Counter Floating\"\n            className=\"block h-full w-full object-contain\"\n            draggable={false}\n          />\n        </button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2539,"size_tokens":null},"yuzha/tailwind.config.ts":{"content":"import forms from \"@tailwindcss/forms\";\nimport typography from \"@tailwindcss/typography\";\nimport aspectRatio from \"@tailwindcss/aspect-ratio\";\n\n/** @type {import('tailwindcss').Config} */\nexport default {\n  content: [\"./index.html\", \"./src/**/*.{js,ts,jsx,tsx}\"],\n  darkMode: \"class\",\n  theme: {\n    extend: {},\n  },\n  plugins: [forms, typography, aspectRatio],\n};\n","path":null,"size_bytes":365,"size_tokens":null},"yuzha/src/counter/createCounterPipeline.ts":{"content":"import config from \"./ConfigCounter.json\";\nimport {\n  STAGE_SIZE,\n  prepareLayer,\n  is2DLayer,\n  getProcessorsForEntry,\n  buildLayerMotion,\n  computeLayerBounds,\n  isLayerWithinStageBounds,\n  type StagePipeline,\n  type EnhancedLayerData,\n  type LayerProcessor,\n  type LayerMetadata,\n  type LayerMotionMarker,\n  type LayerConfigEntry,\n} from \"@shared/layer\";\n\nfunction appendMotionMarkers(target: LayerMotionMarker[], source?: LayerMotionMarker[]) {\n  if (!source?.length) return;\n  target.push(...source);\n}\n\nexport async function createCounterPipeline(): Promise<StagePipeline> {\n  const stageSize = STAGE_SIZE;\n  const entries = (config as unknown as LayerConfigEntry[]).filter(is2DLayer);\n  const motionMarkers: LayerMotionMarker[] = [];\n\n  const layers = (\n    await Promise.all(\n      entries.map(async (entry) => {\n        const layer = await prepareLayer(entry, stageSize);\n        if (!layer) return null;\n\n        const processors = getProcessorsForEntry(entry, undefined);\n        const enhanced = layer as EnhancedLayerData;\n        const baseBounds = computeLayerBounds(\n          enhanced.position,\n          enhanced.scale,\n          enhanced.imageMapping,\n        );\n\n        const motionArtifacts = buildLayerMotion(entry, enhanced, stageSize);\n        if (motionArtifacts.processor) {\n          processors.push(motionArtifacts.processor as LayerProcessor);\n        }\n        appendMotionMarkers(motionMarkers, motionArtifacts.markers);\n\n        const hasAnimation =\n          processors.length > 0 ||\n          Boolean(\n            enhanced.hasSpinAnimation || enhanced.hasOrbitalAnimation || motionArtifacts.processor,\n          );\n\n        const metadata: LayerMetadata = {\n          baseBounds,\n          isStatic: !hasAnimation,\n          hasAnimation,\n          visibleByDefault: enhanced.visible !== false,\n        };\n\n        if (!metadata.hasAnimation && !isLayerWithinStageBounds(baseBounds, stageSize)) {\n          return null;\n        }\n\n        return { entry, data: enhanced, processors, metadata };\n      }),\n    )\n  ).filter(Boolean) as StagePipeline[\"layers\"];\n\n  return { stageSize, layers, markers: motionMarkers.length ? motionMarkers : undefined };\n}\n","path":null,"size_bytes":2188,"size_tokens":null},"shared/component/combobox_combobox-multi-select-5.tsx":{"content":"\"use client\";\n\nimport { Check, ChevronsUpDown, X } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\n\nexport const title = \"With Clear All Functionality\";\n\nconst colors = [\n  { value: \"red\", label: \"Red\" },\n  { value: \"blue\", label: \"Blue\" },\n  { value: \"green\", label: \"Green\" },\n  { value: \"yellow\", label: \"Yellow\" },\n  { value: \"purple\", label: \"Purple\" },\n];\n\nconst Example = () => {\n  const [open, setOpen] = useState(false);\n  const [selectedValues, setSelectedValues] = useState<string[]>([\n    \"red\",\n    \"blue\",\n  ]);\n\n  return (\n    <Popover onOpenChange={setOpen} open={open}>\n      <PopoverTrigger asChild>\n        <Button\n          aria-expanded={open}\n          className=\"w-[250px] justify-between\"\n          role=\"combobox\"\n          variant=\"outline\"\n        >\n          {selectedValues.length > 0\n            ? `${selectedValues.length} color(s) selected`\n            : \"Select colors...\"}\n          <div className=\"ml-2 flex items-center gap-2\">\n            {selectedValues.length > 0 && (\n              <button\n                className=\"rounded-full hover:bg-accent\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  setSelectedValues([]);\n                }}\n              >\n                <X className=\"size-4 opacity-50 hover:opacity-100\" />\n              </button>\n            )}\n            <ChevronsUpDown className=\"size-4 shrink-0 opacity-50\" />\n          </div>\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-[250px] p-0\">\n        <Command>\n          <CommandInput placeholder=\"Search colors...\" />\n          <CommandList>\n            <CommandEmpty>No color found.</CommandEmpty>\n            <CommandGroup>\n              {colors.map((color) => (\n                <CommandItem\n                  key={color.value}\n                  onSelect={(currentValue) => {\n                    setSelectedValues(\n                      selectedValues.includes(currentValue)\n                        ? selectedValues.filter((v) => v !== currentValue)\n                        : [...selectedValues, currentValue]\n                    );\n                  }}\n                  value={color.value}\n                >\n                  <Check\n                    className={cn(\n                      \"mr-2 size-4\",\n                      selectedValues.includes(color.value)\n                        ? \"opacity-100\"\n                        : \"opacity-0\"\n                    )}\n                  />\n                  {color.label}\n                </CommandItem>\n              ))}\n            </CommandGroup>\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":3048,"size_tokens":null},"shared/component/button_button-link-5.tsx":{"content":"import { Loader2 } from \"lucide-react\";\n\nimport { Button } from \"@/components/ui/button\";\n\nexport const title = \"Loading Button\";\n\nconst Example = () => (\n  <Button className=\"gap-2\" disabled variant=\"link\">\n    <Loader2 className=\"size-4 animate-spin\" />\n    Loading\n  </Button>\n);\n\nexport default Example;\n","path":null,"size_bytes":308,"size_tokens":null},"meng/src/README.md":{"content":"﻿# Plantation Cafe Resto - Codebase Guide\n\n## ðŸ“‹ Overview\n\nThis is a modern, fully responsive website for **The Plantation Cafe & Resto** - a garden-concept restaurant in Bandung, Indonesia. Built with React 18, TypeScript, Tailwind CSS, and Vite.\n\n## ðŸŽ¯ Purpose\n\nReplicate the original website at https://plantationcaferesto.com/ with modern tech stack and improved user experience.\n\n## ðŸ—ï¸ Architecture\n\n### Tech Stack\n\n- **Frontend Framework:** React 18.2.0\n- **Language:** TypeScript 5.2.2\n- **Build Tool:** Vite 5.0.8\n- **Styling:** Tailwind CSS 3.3.6\n- **Icons:** Inline SVG (local icons, no external library)\n- **Code Quality:** ESLint + Prettier\n\n### Project Structure\n\n```\n/app/meng/\n└─ src/\n   ├─ components/      # React components\n   ├─ menu.json        # Menu content (JSON-driven)\n   ├─ gallery.json     # Gallery content (JSON-driven)\n   ├─ contact.json     # Contact content (JSON-driven)\n   ├─ types.ts         # Shared TypeScript types\n   ├─ App.tsx          # Main app component\n   ├─ main.tsx         # Entry point\n   └─ index.css        # Global styles + Tailwind\npublic/                # Static assets\ndist/                  # Build output\nindex.html             # HTML template\npackage.json           # Dependencies\ntsconfig.json          # TypeScript config\nvite.config.ts         # Vite config\ntailwind.config.ts     # Tailwind config\npostcss.config.cjs     # PostCSS config\n.eslintrc.json         # ESLint rules\n.prettierrc            # Prettier config\n```\n\n## ðŸ”§ Key Components\n\n### 1. Navbar (`src/components/Navbar.tsx`)\n\n- **Purpose:** Fixed top navigation\n- **Features:** Smooth scroll, mobile menu, responsive\n- **State:** `isMenuOpen` for mobile menu toggle\n- **Links:** Home, About, Menu, Gallery, Contact\n\n### 2. Hero (`src/components/Hero.tsx`)\n\n- **Purpose:** Full-screen hero banner\n- **Image:** Garden restaurant with outdoor seating\n- **CTA:** \"View Menu\" button scrolls to menu section\n\n### 3. About (`src/components/About.tsx`)\n\n- **Purpose:** About Us (Tentang Kami) section\n- **Layout:** Two-column (image + text)\n- **Features:** Mountain view, Swimming pool, Garden concept\n- **Text:** Indonesian language content from original site\n\n### 4. Menu (`src/components/Menu.tsx`)\n\n- **Purpose:** Display menu items\n- **Data Source:** `src/menu.json`\n- **Sections:** Featured items (Iga Bakar, Hot Plate Singapore) + Main items\n- **Layout:** Responsive grid\n\n### 5. Gallery (`src/components/Gallery.tsx`)\n\n- **Purpose:** Photo gallery\n- **Data Source:** `src/gallery.json`\n- **Features:** Hover effects, responsive grid\n- **Categories:** food, ambiance, pool, exterior, interior\n\n### 6. Contact (`src/components/Contact.tsx`)\n\n- **Purpose:** Contact information and WhatsApp CTA\n- **WhatsApp:** 0811-1658-033\n- **Features:** Phone, Location, Hours cards\n- **CTA:** WhatsApp button with pre-filled message\n\n### 7. Footer (`src/components/Footer.tsx`)\n\n- **Purpose:** Website footer\n- **Content:** Copyright, tagline\n- **Dynamic:** Current year auto-updates\n\n## ðŸ“Š Data Management\n\n### Menu Items (`src/menu.json`)\n\n```json\n[\n  {\n    \"id\": \"iga-bakar\",\n    \"name\": \"Iga Bakar\",\n    \"description\": \"...\",\n    \"imageUrl\": \"https://...\",\n    \"category\": \"featured\"\n  }\n]\n```\n\n**To Add New Items:**\n\n1. Open `src/menu.json`\n2. Add, edit, or remove objects following the shape above\n3. Save; the Menu component auto-updates\n\n### Gallery Items (`src/gallery.json`)\n\n```json\n[\n  {\n    \"id\": \"gallery-1\",\n    \"url\": \"https://...\",\n    \"type\": \"image\",\n    \"caption\": \"...\",\n    \"category\": \"interior\"\n  }\n]\n```\n\n**To Add New Images:**\n\n1. Open `src/gallery.json`\n2. Add, edit, or remove objects following the shape above\n3. Save; the Gallery component auto-updates\n\n## ðŸŽ¨ Styling System\n\n### Tailwind Configuration\n\n- **Primary Color:** Green (garden theme) - `primary-600`\n- **Secondary Color:** Warm gold - `secondary-500`\n- **Fonts:**\n  - Display/Headings: Poppins\n  - Body: Inter\n- **Custom Animations:**\n  - `animate-fade-in`: Fade in effect\n  - `animate-slide-up`: Slide up from bottom\n  - `animate-scale-in`: Scale in effect\n\n### Responsive Breakpoints\n\n- `sm`: 640px\n- `md`: 768px\n- `lg`: 1024px\n- `xl`: 1280px\n- `2xl`: 1536px\n\n## ðŸš€ Development Commands\n\n```bash\n# Install dependencies\nnpm install\n\n# Start dev server (port 3001)\nnpm run dev\n\n# Type check\nnpm run typecheck\n\n# Lint code\nnpm run lint\n\n# Format code\nnpm run format\n\n# Build for production\nnpm run build\n\n# Preview production build\nnpm run preview\n```\n\n## âœ… Quality Checks\n\n### TypeScript\n\n- Strict mode enabled\n- No implicit any\n- All components fully typed\n- Run: `npm run typecheck`\n\n### ESLint\n\n- React hooks rules\n- TypeScript rules\n- No unused variables\n- Run: `npm run lint`\n\n### Prettier\n\n- Single quotes\n- No semicolons\n- 2 space tabs\n- Run: `npm run format`\n\n## ðŸ–¼ï¸ Image Sources\n\nAll images sourced from:\n\n- **Unsplash** (high-quality, royalty-free)\n- **Pexels** (high-quality, royalty-free)\n\nImages selected via `vision_expert_agent` based on:\n\n1. Restaurant outdoor garden ambiance\n2. Mountain view settings\n3. Indonesian cuisine (Iga Bakar, Hot Plate)\n4. Swimming pool with city views\n5. Cafe interior/exterior\n\n## ðŸ”„ Future Enhancements\n\n### Recommended Additions:\n\n1. **Lightbox for Gallery:** Install `yet-another-react-lightbox`\n2. **Form Validation:** Add contact form with validation\n3. **Google Maps:** Embed map for location\n4. **Menu PDF:** Downloadable full menu\n5. **Online Reservations:** Booking system\n6. **Social Media:** Instagram feed integration\n7. **Reviews:** Customer testimonials section\n8. **Multi-language:** English/Indonesian toggle\n9. **Dark Mode:** Theme switcher\n10. **Analytics:** Google Analytics integration\n\n### How to Add New Sections:\n\n1. Create component in `src/components/`\n2. Add comprehensive JSDoc comments\n3. Import in `src/App.tsx`\n4. Add to render tree\n5. Update navigation links in Navbar\n\n## ðŸ› Common Issues & Solutions\n\n### Issue: Build fails with PostCSS error\n\n**Solution:** Ensure `postcss.config.cjs` (not .ts) exists\n\n### Issue: Images not loading\n\n**Solution:** Check image URLs are valid and accessible\n\n### Issue: TypeScript errors\n\n**Solution:** Run `npm run typecheck` and fix type issues\n\n### Issue: Styles not applying\n\n**Solution:**\n\n1. Check Tailwind classes are correct\n2. Ensure `index.css` imports Tailwind directives\n3. Rebuild: `npm run build`\n\n## ðŸ“ Code Standards\n\n### Component Structure\n\n```typescript\n/**\n * Component Name\n *\n * Purpose: Brief description\n *\n * Features:\n * - Feature 1\n * - Feature 2\n *\n * For Future AI Agents:\n * - Important notes\n * - Modification guidelines\n */\n\nimport { ... } from '...'\n\nconst ComponentName = () => {\n  // State and logic\n\n  return (\n    // JSX\n  )\n}\n\nexport default ComponentName\n```\n\n### Naming Conventions\n\n- **Components:** PascalCase (e.g., `Navbar.tsx`)\n- **Functions:** camelCase (e.g., `handleClick`)\n- **Constants:** UPPER_SNAKE_CASE (e.g., `MAX_ITEMS`)\n- **Interfaces:** PascalCase (e.g., `MenuItem`)\n- **CSS Classes:** kebab-case (Tailwind)\n\n## ðŸ” Best Practices\n\n1. **Always add JSDoc comments** to components\n2. **Use TypeScript types** for all props and state\n3. **Follow responsive-first** approach (mobile â†’ desktop)\n4. **Optimize images** before adding to production\n5. **Test on multiple devices** (mobile, tablet, desktop)\n6. **Run quality checks** before committing:\n   ```bash\n   npm run typecheck && npm run lint && npm run format\n   ```\n7. **Keep components small** and focused (Single Responsibility)\n8. **Extract reusable logic** into custom hooks\n9. **Use semantic HTML** for accessibility\n10. **Add alt text** to all images\n\n## ðŸ“ž Contact & Support\n\n**Restaurant Contact:**\n\n- WhatsApp: 0811-1658-033\n- Location: Bandung, West Java, Indonesia\n\n**Development Notes:**\n\n- Built: November 2025\n- Developer: AI Agent (E1)\n- Framework: React 18 + TypeScript + Vite\n\n---\n\n## ðŸ¤– Notes for Future AI Agents\n\n### This codebase was built with you in mind!\n\nEvery file includes:\n\n- **JSDoc comments** explaining purpose and usage\n- **Type definitions** for all data structures\n- **Clear component structure** following React best practices\n- **Comprehensive documentation** in this README\n\n### When modifying this code:\n\n1. **Read component comments first** - they explain the \"why\" not just the \"what\"\n2. **Maintain type safety** - TypeScript will guide you\n3. **Run quality checks** after changes\n4. **Update documentation** if you add features\n5. **Keep the same code style** (Prettier will help)\n\n### Key Files to Understand:\n\n1. `src/App.tsx` - Application structure\n2. `src/types.ts` - Data models\n3. `src/*.json` - Content (menu/gallery/contact)\n4. Component files - UI implementation\n\n### Logging for Debugging:\n\n```typescript\n// Use console.log with descriptive messages\nconsole.log('[ComponentName] State updated:', newState)\nconsole.error('[ComponentName] Error occurred:', error)\n```\n\n**Good luck with your enhancements! ðŸš€**\n","path":null,"size_bytes":9048,"size_tokens":null},"meng/src/index.css":{"content":"/**\n * Global Styles and Tailwind CSS Imports\n * \n * Purpose: Define global CSS, Tailwind directives, and custom styles\n * \n * Structure:\n * 1. Tailwind base, components, utilities\n * 2. Google Fonts import\n * 3. Global CSS resets and defaults\n * 4. Custom utility classes\n * \n * For Future AI Agents:\n * - Tailwind processes these directives at build time\n * - Custom font: Poppins for headings, Inter for body text\n * - Smooth scroll behavior enabled globally\n */\n\n@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700;800&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n@layer base {\n  * {\n    @apply box-border;\n  }\n\n  html {\n    @apply scroll-smooth;\n  }\n\n  body {\n    @apply font-sans text-gray-900 antialiased;\n    margin: 0;\n    padding: 0;\n  }\n}\n\n@layer utilities {\n  .text-balance {\n    text-wrap: balance;\n  }\n}\n","path":null,"size_bytes":919,"size_tokens":null},"shared/effect/polaraura.ts":{"content":"import * as THREE from \"three\";\nimport { resolveAssetPath, resolveAssetUrl } from \"../layer/engine\";\nimport polarauraConfig from \"./polaraura.config.json\";\n\nfunction getTextureUrl(imageId: string): string {\n  const path = resolveAssetPath(imageId);\n  if (!path) {\n    throw new Error(`[PolarAura] Missing asset for \"${imageId}\"`);\n  }\n  return resolveAssetUrl(path);\n}\n\nexport type PolarAuraOptions = {\n  layerCount?: number;\n  baseScale?: number;\n  scaleStep?: number;\n  baseOpacity?: number;\n  opacityStep?: number;\n  layerColors?: [number, number, number][];\n  layerSizeBase?: number;\n  layerSizeStep?: number;\n  centerSize?: number;\n};\n\ntype PolarAuraConfig = Required<PolarAuraOptions>;\n\nconst defaultConfig: PolarAuraConfig = {\n  layerCount: 4,\n  baseScale: 0.9,\n  scaleStep: 0.25,\n  baseOpacity: 0.5,\n  opacityStep: 0.1,\n  layerColors: [\n    [0.2, 0.7, 1.1],\n    [0.1, 0.55, 0.9],\n    [0.3, 0.8, 1.2],\n    [0.6, 0.9, 1.2],\n  ],\n  layerSizeBase: 1.8,\n  layerSizeStep: 0.35,\n  centerSize: 0.95,\n};\n\nconst mergedConfig: PolarAuraConfig = {\n  ...defaultConfig,\n  ...(polarauraConfig as PolarAuraOptions),\n  layerColors: (polarauraConfig as PolarAuraOptions).layerColors ?? defaultConfig.layerColors,\n};\n\n/**\n * Create Polar Aura meshes (layers + center pulse) using dual noise textures.\n * Caller is responsible for adding meshes to the scene and disposing them.\n */\nexport function createPolarAura(\n  textureLoader: THREE.TextureLoader,\n  {\n    layerCount = mergedConfig.layerCount,\n    baseScale = mergedConfig.baseScale,\n    scaleStep = mergedConfig.scaleStep,\n    baseOpacity = mergedConfig.baseOpacity,\n    opacityStep = mergedConfig.opacityStep,\n    layerColors = mergedConfig.layerColors,\n    layerSizeBase = mergedConfig.layerSizeBase,\n    layerSizeStep = mergedConfig.layerSizeStep,\n    centerSize = mergedConfig.centerSize,\n  }: PolarAuraOptions = mergedConfig,\n): THREE.Mesh[] {\n  const noiseTexture1 = textureLoader.load(getTextureUrl(\"alpha_noise_256_wave_22\"));\n  noiseTexture1.wrapS = THREE.RepeatWrapping;\n  noiseTexture1.wrapT = THREE.RepeatWrapping;\n\n  const noiseTexture2 = textureLoader.load(getTextureUrl(\"alpha_noise_256_wave_04\"));\n  noiseTexture2.wrapS = THREE.RepeatWrapping;\n  noiseTexture2.wrapT = THREE.RepeatWrapping;\n\n  const vertexShader = `\n    varying vec2 vUv;\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  `;\n\n  const fragmentShader = `\n    uniform sampler2D uTexture1;\n    uniform sampler2D uTexture2;\n    uniform float uTime;\n    uniform float uScale;\n    uniform float uOpacity;\n    uniform vec3 uColor;\n    varying vec2 vUv;\n\n    void main() {\n      vec2 center = vec2(0.5);\n      vec2 pos = (vUv - center) * uScale;\n      float r = length(pos);\n      float angle = atan(pos.y, pos.x);\n\n      // Swirl and drift with two distinct noise fields\n      float swirl1 = sin(angle * 7.0 + uTime * 1.4) * 0.08;\n      float swirl2 = cos(angle * 5.0 - uTime * 1.1) * 0.06;\n      vec2 uv1 = vec2(angle / 6.2831853 + swirl1, r * 1.6 - uTime * 0.12);\n      vec2 uv2 = vec2(angle / 6.2831853 * 1.25 + swirl2, r * 2.4 - uTime * 0.18);\n\n      vec4 n1 = texture2D(uTexture1, uv1);\n      vec4 n2 = texture2D(uTexture2, uv2);\n\n      float noiseBroad = n2.r;\n      float noiseDetail = n1.r;\n      float noiseMix = mix(noiseBroad, noiseDetail, 0.55);\n      float alphaMix = n1.a * 0.5 + n2.a * 0.5;\n\n      // Shape: bright core + rim\n      float inner = smoothstep(0.32, 0.0, r);\n      float rim = smoothstep(0.44, 0.26, r);\n      float edgeFalloff = smoothstep(0.65, 0.32, r);\n\n      // Pulse\n      float pulse = 0.9 + sin(uTime * 1.3 + r * 6.0) * 0.12;\n\n      vec3 hot = vec3(1.0, 0.98, 1.0);\n      vec3 color = mix(uColor, hot, smoothstep(0.2, 0.0, r) * 0.7);\n      color = mix(color, uColor * 1.2, noiseMix);\n\n      float alpha = (inner * 0.9 + rim) * alphaMix * uOpacity * pulse * edgeFalloff;\n\n      gl_FragColor = vec4(color, alpha);\n    }\n  `;\n\n  const meshes: THREE.Mesh[] = [];\n\n  for (let i = 0; i < layerCount; i++) {\n    const layerColorTuple = layerColors[i % layerColors.length] ?? [1, 1, 1];\n    const layerColor = new THREE.Color(\n      layerColorTuple[0],\n      layerColorTuple[1],\n      layerColorTuple[2],\n    );\n    const material = new THREE.ShaderMaterial({\n      vertexShader,\n      fragmentShader,\n      uniforms: {\n        uTexture1: { value: noiseTexture1 },\n        uTexture2: { value: noiseTexture2 },\n        uTime: { value: 0 },\n        uScale: { value: baseScale + i * scaleStep },\n        uOpacity: { value: baseOpacity - i * opacityStep },\n        uColor: { value: layerColor },\n      },\n      transparent: true,\n      blending: THREE.AdditiveBlending,\n      depthWrite: false,\n    });\n\n    const size = layerSizeBase + i * layerSizeStep;\n    const geometry = new THREE.PlaneGeometry(size, size);\n    const mesh = new THREE.Mesh(geometry, material);\n    mesh.position.z = -i * 0.01;\n    meshes.push(mesh);\n  }\n\n  // Center pulse layer\n  const centerMaterial = new THREE.ShaderMaterial({\n    vertexShader,\n    fragmentShader: `\n      varying vec2 vUv;\n      uniform float uTime;\n      void main() {\n        vec2 center = vec2(0.5);\n        float d = length(vUv - center);\n        float pulse = 0.85 + sin(uTime * 2.2) * 0.15;\n        float glow = smoothstep(0.3, 0.0, d) * pulse;\n        vec3 inner = vec3(1.0, 0.98, 1.0);\n        vec3 edge = vec3(0.25, 0.85, 1.0);\n        vec3 color = mix(edge, inner, smoothstep(0.18, 0.0, d));\n        gl_FragColor = vec4(color, glow * 0.8);\n      }\n    `,\n    uniforms: {\n      uTime: { value: 0 },\n    },\n    transparent: true,\n    blending: THREE.AdditiveBlending,\n    depthWrite: false,\n  });\n\n  const centerGeometry = new THREE.PlaneGeometry(centerSize, centerSize);\n  const centerMesh = new THREE.Mesh(centerGeometry, centerMaterial);\n  centerMesh.position.z = 0.05;\n  meshes.push(centerMesh);\n\n  return meshes;\n}\n","path":null,"size_bytes":5885,"size_tokens":null},"meng/src/types.ts":{"content":"/**\n * Shared Type Definitions\n *\n * Components remain static while content comes from JSON files.\n */\n\nexport interface MenuItem {\n  id: string\n  name: string\n  description: string\n  imageUrl: string\n  category: 'featured' | 'main' | 'appetizer' | 'dessert' | 'beverage'\n}\n\nexport interface GalleryItem {\n  id: string\n  url: string\n  type: 'image' | 'video'\n  caption?: string\n  category: 'food' | 'ambiance' | 'pool' | 'exterior' | 'interior'\n}\n\nexport interface ContactContent {\n  heading: string\n  subheading: string\n  cards: {\n    phone: { title: string; value: string }\n    location: { title: string; lines: string[] }\n    hours: { title: string; days: string; hours: string }\n  }\n  whatsapp: { number: string; message: string; label: string }\n  ctaNote: string\n}\n","path":null,"size_bytes":770,"size_tokens":null},"eslint.config.ts":{"content":"import js from \"@eslint/js\";\nimport tseslint from \"@typescript-eslint/eslint-plugin\";\nimport tsparser from \"@typescript-eslint/parser\";\nimport globals from \"globals\";\n\nexport default [\n  // -- IGNORE --\n  {\n    ignores: [\n      \"dist\",\n      \"node_modules\",\n      \"coverage\",\n      \"apps/**/dist\",\n      \"apps/**/coverage\",\n      \"**/*.min.js\",\n      \"frontend/node_modules/**\",\n      \"backend/__pycache__/**\",\n    ],\n  },\n\n  // -- DEFAULT: browser TS/TSX --\n  {\n    files: [\"**/*.{ts,tsx}\"],\n    languageOptions: {\n      parser: tsparser,\n      parserOptions: {\n        ecmaVersion: 2022,\n        sourceType: \"module\",\n        ecmaFeatures: { jsx: true },\n      },\n      globals: {\n        ...globals.browser,\n        ...globals.es2022,\n      },\n    },\n    plugins: {\n      \"@typescript-eslint\": tseslint,\n    },\n    rules: {\n      ...(js.configs?.recommended?.rules ?? {}),\n      ...(tseslint.configs?.recommended?.rules ?? {}),\n      \"@typescript-eslint/no-unused-vars\": [\n        \"error\",\n        { argsIgnorePattern: \"^_\", varsIgnorePattern: \"^_\" },\n      ],\n      \"@typescript-eslint/consistent-type-imports\": [\"error\", { prefer: \"type-imports\" }],\n      \"@typescript-eslint/no-explicit-any\": \"off\",\n      \"@typescript-eslint/ban-ts-comment\": \"off\",\n      \"no-empty\": [\"error\", { allowEmptyCatch: true }],\n    },\n  },\n\n  // -- OVERRIDE: Node env untuk file config & scripts --\n  //  -> bikin 'process', '__dirname', dsb dikenali; matiin no-undef bila perlu\n  {\n    files: [\"**/*.config.{ts,js}\", \"vite.config.{ts,js}\", \"**/scripts/**/*.{ts,js}\"],\n    languageOptions: {\n      parser: tsparser,\n      parserOptions: {\n        ecmaVersion: 2022,\n        sourceType: \"module\",\n      },\n      globals: {\n        ...globals.node,\n        ...globals.es2022,\n      },\n    },\n    rules: {\n      // di Node files, no-undef sering false positive karena globals Node\n      \"no-undef\": \"off\",\n    },\n  },\n\n  // -- OVERRIDE: Test (Vitest) --\n  {\n    files: [\"**/*.{test,spec}.{ts,tsx}\"],\n    languageOptions: {\n      parser: tsparser,\n      parserOptions: {\n        ecmaVersion: 2022,\n        sourceType: \"module\",\n      },\n      globals: {\n        ...globals.node,\n        ...globals.jest, // cukup dekat utk vitest (describe,it,expect)\n        vi: \"readonly\", // vitest mock/timer\n      },\n    },\n  },\n];\n","path":null,"size_bytes":2300,"size_tokens":null},"shared/floating/FloatingScreen.tsx":{"content":"import React from \"react\";\nimport FloatingWindowTemplate from \"./FloatingWindowTemplate\";\n\nexport type FloatingScreenProps = {\n  onBack?: () => void;\n};\n\n/**\n * FloatingScreen - Demo screen showing FloatingWindowTemplate usage\n *\n * This demonstrates how to use the FloatingWindowTemplate component\n * with custom content inside.\n */\nexport default function FloatingScreen({ onBack }: FloatingScreenProps) {\n  const [showWindow1, setShowWindow1] = React.useState(true);\n  const [showWindow2, setShowWindow2] = React.useState(false);\n\n  return (\n    <div className=\"relative w-screen h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 overflow-hidden\">\n      {/* Info Panel */}\n      <div className=\"absolute top-6 left-6 z-10 max-w-md space-y-4\">\n        <div className=\"rounded-lg bg-black/40 backdrop-blur-sm p-4 text-white\">\n          <h2 className=\"text-lg font-semibold mb-2\">Floating Window Template Demo</h2>\n          <p className=\"text-sm text-slate-300 mb-3\">\n            Drag windows by their header. Resize from edges and corners. Works on desktop and mobile\n            devices.\n          </p>\n\n          <div className=\"flex gap-2\">\n            <button\n              type=\"button\"\n              onClick={() => setShowWindow1(!showWindow1)}\n              className=\"px-3 py-1.5 text-sm rounded bg-blue-600 hover:bg-blue-500 transition-colors\"\n            >\n              {showWindow1 ? \"Hide\" : \"Show\"} Window 1\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => setShowWindow2(!showWindow2)}\n              className=\"px-3 py-1.5 text-sm rounded bg-purple-600 hover:bg-purple-500 transition-colors\"\n            >\n              {showWindow2 ? \"Hide\" : \"Show\"} Window 2\n            </button>\n          </div>\n        </div>\n\n        {onBack && (\n          <button\n            type=\"button\"\n            onClick={onBack}\n            className=\"w-full rounded-lg bg-slate-800 hover:bg-slate-700 px-4 py-2 text-sm font-medium text-white transition-colors\"\n          >\n            ← Back to Main\n          </button>\n        )}\n      </div>\n\n      {/* Floating Window 1 - Control Panel Example */}\n      {showWindow1 && (\n        <FloatingWindowTemplate\n          title=\"Control Panel\"\n          initialPos={{ x: 120, y: 120 }}\n          initialSize={{ width: 350, height: 400 }}\n          onClose={() => setShowWindow1(false)}\n        >\n          <div className=\"space-y-4\">\n            <div>\n              <h4 className=\"text-sm font-semibold text-gray-700 mb-2\">Settings</h4>\n              <div className=\"space-y-2\">\n                <label className=\"flex items-center gap-2 text-sm\">\n                  <input type=\"checkbox\" className=\"rounded\" defaultChecked />\n                  <span>Enable notifications</span>\n                </label>\n                <label className=\"flex items-center gap-2 text-sm\">\n                  <input type=\"checkbox\" className=\"rounded\" />\n                  <span>Auto-save changes</span>\n                </label>\n              </div>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Volume</label>\n              <input type=\"range\" className=\"w-full\" min=\"0\" max=\"100\" defaultValue=\"50\" />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Name</label>\n              <input\n                type=\"text\"\n                placeholder=\"Enter name...\"\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-700 mb-2\">Description</label>\n              <textarea\n                placeholder=\"Enter description...\"\n                rows={4}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-sm resize-none focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              />\n            </div>\n\n            <button\n              type=\"button\"\n              className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors\"\n            >\n              Apply Changes\n            </button>\n          </div>\n        </FloatingWindowTemplate>\n      )}\n\n      {/* Floating Window 2 - Stats Example */}\n      {showWindow2 && (\n        <FloatingWindowTemplate\n          title=\"Statistics Dashboard\"\n          initialPos={{ x: 500, y: 200 }}\n          initialSize={{ width: 300, height: 250 }}\n          minWidth={250}\n          minHeight={200}\n          onClose={() => setShowWindow2(false)}\n        >\n          <div className=\"space-y-3\">\n            <div className=\"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-3\">\n              <div className=\"text-xs text-blue-600 font-medium\">Total Users</div>\n              <div className=\"text-2xl font-bold text-blue-900\">1,234</div>\n              <div className=\"text-xs text-blue-600\">↑ 12% from last week</div>\n            </div>\n\n            <div className=\"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-3\">\n              <div className=\"text-xs text-purple-600 font-medium\">Active Sessions</div>\n              <div className=\"text-2xl font-bold text-purple-900\">89</div>\n              <div className=\"text-xs text-purple-600\">↓ 5% from yesterday</div>\n            </div>\n\n            <div className=\"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-3\">\n              <div className=\"text-xs text-green-600 font-medium\">Revenue</div>\n              <div className=\"text-2xl font-bold text-green-900\">$45.2K</div>\n              <div className=\"text-xs text-green-600\">↑ 23% from last month</div>\n            </div>\n          </div>\n        </FloatingWindowTemplate>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":5893,"size_tokens":null},"shared/floating/FloatingWindowTemplate.tsx":{"content":"import React, { useEffect, useRef, useState } from \"react\";\nimport type { CSSProperties } from \"react\";\n\n/**\n * FloatingWindowTemplate - Draggable & Resizable Window Component\n *\n * Features:\n * - Drag from header to move\n * - Resize from 8 handles (4 corners + 4 edges)\n * - Support desktop (mouse) and mobile (touch) via Pointer Events API\n * - Boundary constraints to keep window in viewport\n * - Minimum size constraints\n *\n * Usage:\n * ```tsx\n * <FloatingWindowTemplate title=\"Control Panel\">\n *   <YourContent />\n * </FloatingWindowTemplate>\n * ```\n */\n\ninterface Position {\n  x: number;\n  y: number;\n}\n\ninterface Size {\n  width: number;\n  height: number;\n}\n\ntype ResizeHandle = \"n\" | \"s\" | \"e\" | \"w\" | \"ne\" | \"nw\" | \"se\" | \"sw\" | null;\n\ninterface FloatingWindowProps {\n  children: React.ReactNode;\n  title?: string;\n  initialPos?: Position;\n  initialSize?: Size;\n  minWidth?: number;\n  minHeight?: number;\n  onClose?: () => void;\n}\n\nexport default function FloatingWindowTemplate({\n  children,\n  title = \"Floating Window\",\n  initialPos = { x: 100, y: 100 },\n  initialSize = { width: 400, height: 300 },\n  minWidth = 200,\n  minHeight = 150,\n  onClose,\n}: FloatingWindowProps) {\n  const viewportMargin = 12; // keep a small gutter so the window never touches the edges\n\n  const [position, setPosition] = useState<Position>(initialPos);\n  const [size, setSize] = useState<Size>(initialSize);\n  const [isDragging, setIsDragging] = useState(false);\n  const [isResizing, setIsResizing] = useState(false);\n  const [activeHandle, setActiveHandle] = useState<ResizeHandle>(null);\n\n  const dragStartRef = useRef<Position>({ x: 0, y: 0 });\n  const resizeStartRef = useRef<{ pos: Position; size: Size }>({\n    pos: { x: 0, y: 0 },\n    size: { width: 0, height: 0 },\n  });\n\n  // Drag handlers\n  const handleDragStart = (e: React.PointerEvent<HTMLDivElement>) => {\n    if ((e.target as HTMLElement).closest(\".resize-handle\")) return;\n\n    setIsDragging(true);\n    dragStartRef.current = {\n      x: e.clientX - position.x,\n      y: e.clientY - position.y,\n    };\n    e.currentTarget.setPointerCapture(e.pointerId);\n  };\n\n  const handleDrag = (e: PointerEvent) => {\n    if (!isDragging) return;\n\n    const maxX = Math.max(0, window.innerWidth - size.width - viewportMargin);\n    const maxY = Math.max(0, window.innerHeight - size.height - viewportMargin);\n    const minX = viewportMargin;\n    const minY = viewportMargin;\n\n    const newX = e.clientX - dragStartRef.current.x;\n    const newY = e.clientY - dragStartRef.current.y;\n\n    setPosition({\n      x: Math.max(minX, Math.min(newX, maxX)),\n      y: Math.max(minY, Math.min(newY, maxY)),\n    });\n  };\n\n  const handleDragEnd = () => {\n    setIsDragging(false);\n  };\n\n  // Resize handlers\n  const handleResizeStart = (e: React.PointerEvent<HTMLDivElement>, handle: ResizeHandle) => {\n    e.stopPropagation();\n    setIsResizing(true);\n    setActiveHandle(handle);\n    resizeStartRef.current = {\n      pos: { x: e.clientX, y: e.clientY },\n      size: { ...size },\n    };\n    e.currentTarget.setPointerCapture(e.pointerId);\n  };\n\n  const handleResize = (e: PointerEvent) => {\n    if (!isResizing || !activeHandle) return;\n\n    const deltaX = e.clientX - resizeStartRef.current.pos.x;\n    const deltaY = e.clientY - resizeStartRef.current.pos.y;\n\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n\n    let newWidth = resizeStartRef.current.size.width;\n    let newHeight = resizeStartRef.current.size.height;\n    let newX = position.x;\n    let newY = position.y;\n\n    // Handle horizontal resize\n    if (activeHandle.includes(\"e\")) {\n      newWidth = Math.max(minWidth, resizeStartRef.current.size.width + deltaX);\n    } else if (activeHandle.includes(\"w\")) {\n      const proposedWidth = resizeStartRef.current.size.width - deltaX;\n      if (proposedWidth >= minWidth) {\n        newWidth = proposedWidth;\n        newX = position.x + deltaX;\n      }\n    }\n\n    // Handle vertical resize\n    if (activeHandle.includes(\"s\")) {\n      newHeight = Math.max(minHeight, resizeStartRef.current.size.height + deltaY);\n    } else if (activeHandle.includes(\"n\")) {\n      const proposedHeight = resizeStartRef.current.size.height - deltaY;\n      if (proposedHeight >= minHeight) {\n        newHeight = proposedHeight;\n        newY = position.y + deltaY;\n      }\n    }\n\n    // Apply boundary constraints\n    const fitDimension = (value: number, min: number, max: number) =>\n      Math.max(Math.min(value, max), Math.min(min, max));\n\n    const maxWidth = Math.max(0, viewportWidth - newX - viewportMargin);\n    const maxHeight = Math.max(0, viewportHeight - newY - viewportMargin);\n    newWidth = fitDimension(newWidth, minWidth, maxWidth);\n    newHeight = fitDimension(newHeight, minHeight, maxHeight);\n\n    if (newX < viewportMargin) {\n      const diff = viewportMargin - newX;\n      newX = viewportMargin;\n      newWidth = Math.max(minWidth, newWidth - diff);\n    }\n    if (newY < viewportMargin) {\n      const diff = viewportMargin - newY;\n      newY = viewportMargin;\n      newHeight = Math.max(minHeight, newHeight - diff);\n    }\n\n    setSize({ width: newWidth, height: newHeight });\n    setPosition({ x: newX, y: newY });\n  };\n\n  const handleResizeEnd = () => {\n    setIsResizing(false);\n    setActiveHandle(null);\n  };\n\n  // Global event listeners\n  useEffect(() => {\n    if (isDragging) {\n      window.addEventListener(\"pointermove\", handleDrag);\n      window.addEventListener(\"pointerup\", handleDragEnd);\n      return () => {\n        window.removeEventListener(\"pointermove\", handleDrag);\n        window.removeEventListener(\"pointerup\", handleDragEnd);\n      };\n    }\n  }, [isDragging, position, size]);\n\n  useEffect(() => {\n    if (isResizing) {\n      window.addEventListener(\"pointermove\", handleResize);\n      window.addEventListener(\"pointerup\", handleResizeEnd);\n      return () => {\n        window.removeEventListener(\"pointermove\", handleResize);\n        window.removeEventListener(\"pointerup\", handleResizeEnd);\n      };\n    }\n  }, [isResizing, activeHandle, position, size]);\n\n  // Detect touch device for larger handles (deferred to client to avoid SSR issues)\n  const [isTouchDevice, setIsTouchDevice] = useState(false);\n  useEffect(() => {\n    if (typeof window !== \"undefined\") {\n      setIsTouchDevice(\"ontouchstart\" in window || navigator.maxTouchPoints > 0);\n    }\n  }, []);\n\n  // Clamp position/size to viewport (useful on small screens or after rotations)\n  useEffect(() => {\n    const fitDimension = (value: number, min: number, max: number) =>\n      Math.max(Math.min(value, max), Math.min(min, max));\n\n    const clampToViewport = () => {\n      const viewportWidth = window.innerWidth;\n      const viewportHeight = window.innerHeight;\n\n      setSize((prev) => {\n        const maxWidth = Math.max(0, viewportWidth - viewportMargin * 2);\n        const maxHeight = Math.max(0, viewportHeight - viewportMargin * 2);\n        const nextSize = {\n          width: fitDimension(prev.width, minWidth, maxWidth),\n          height: fitDimension(prev.height, minHeight, maxHeight),\n        };\n        // Clamp position against the freshly clamped size so resize feels natural near edges\n        setPosition((prevPos) => ({\n          x: Math.min(\n            Math.max(prevPos.x, viewportMargin),\n            Math.max(viewportMargin, viewportWidth - viewportMargin - nextSize.width),\n          ),\n          y: Math.min(\n            Math.max(prevPos.y, viewportMargin),\n            Math.max(viewportMargin, viewportHeight - viewportMargin - nextSize.height),\n          ),\n        }));\n        return nextSize;\n      });\n    };\n\n    clampToViewport();\n    window.addEventListener(\"resize\", clampToViewport);\n    return () => window.removeEventListener(\"resize\", clampToViewport);\n  }, [size.width, size.height, minWidth, minHeight]);\n  const handleSize = isTouchDevice ? 12 : 6;\n  const edgeThickness = isTouchDevice ? 8 : 4;\n\n  const resizeHandles: Array<{ handle: ResizeHandle; style: CSSProperties; cursor: string }> = [\n    {\n      handle: \"n\",\n      style: { top: 0, left: 0, right: 0, height: edgeThickness },\n      cursor: \"ns-resize\",\n    },\n    {\n      handle: \"s\",\n      style: { bottom: 0, left: 0, right: 0, height: edgeThickness },\n      cursor: \"ns-resize\",\n    },\n    {\n      handle: \"e\",\n      style: { right: 0, top: 0, bottom: 0, width: edgeThickness },\n      cursor: \"ew-resize\",\n    },\n    {\n      handle: \"w\",\n      style: { left: 0, top: 0, bottom: 0, width: edgeThickness },\n      cursor: \"ew-resize\",\n    },\n    {\n      handle: \"ne\",\n      style: { top: 0, right: 0, width: handleSize, height: handleSize },\n      cursor: \"nesw-resize\",\n    },\n    {\n      handle: \"nw\",\n      style: { top: 0, left: 0, width: handleSize, height: handleSize },\n      cursor: \"nwse-resize\",\n    },\n    {\n      handle: \"se\",\n      style: { bottom: 0, right: 0, width: handleSize, height: handleSize },\n      cursor: \"nwse-resize\",\n    },\n    {\n      handle: \"sw\",\n      style: { bottom: 0, left: 0, width: handleSize, height: handleSize },\n      cursor: \"nesw-resize\",\n    },\n  ];\n\n  const containerStyle: CSSProperties = {\n    position: \"fixed\",\n    background: \"#ffffff\",\n    boxShadow: \"0 20px 55px rgba(0,0,0,0.25)\",\n    borderRadius: 0,\n    overflow: \"hidden\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    left: `${position.x}px`,\n    top: `${position.y}px`,\n    width: `${size.width}px`,\n    height: `${size.height}px`,\n    touchAction: \"none\",\n    userSelect: isDragging || isResizing ? \"none\" : \"auto\",\n    zIndex: 1000,\n  };\n\n  const headerStyle: CSSProperties = {\n    background: \"linear-gradient(90deg, #2563eb, #7c3aed)\",\n    color: \"#ffffff\",\n    padding: \"12px 16px\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\",\n    cursor: \"move\",\n    userSelect: \"none\",\n  };\n\n  const titleStyle: CSSProperties = {\n    fontSize: 14,\n    fontWeight: 600,\n    margin: 0,\n    padding: 0,\n    overflow: \"hidden\",\n    textOverflow: \"ellipsis\",\n    whiteSpace: \"nowrap\",\n  };\n\n  const closeButtonStyle: CSSProperties = {\n    marginLeft: 8,\n    width: 28,\n    height: 28,\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    borderRadius: 0,\n    border: \"none\",\n    background: \"rgba(255,255,255,0.12)\",\n    color: \"#ffffff\",\n    cursor: \"pointer\",\n    transition: \"background 120ms ease\",\n  };\n\n  const contentStyle: CSSProperties = {\n    flex: 1,\n    overflow: \"auto\",\n    padding: 16,\n    background: \"#ffffff\",\n  };\n\n  const handleBaseStyle: CSSProperties = {\n    position: \"absolute\",\n    background: isTouchDevice ? \"rgba(59,130,246,0.2)\" : \"transparent\",\n    transition: \"background 120ms ease\",\n  };\n\n  return (\n    <div style={containerStyle}>\n      <div style={headerStyle} onPointerDown={handleDragStart}>\n        <h3 style={titleStyle} title={title}>\n          {title}\n        </h3>\n        {onClose && (\n          <button\n            type=\"button\"\n            onClick={onClose}\n            aria-label=\"Close\"\n            style={closeButtonStyle}\n            onPointerDown={(e) => e.stopPropagation()}\n            onMouseEnter={(e) => (e.currentTarget.style.background = \"rgba(255,255,255,0.24)\")}\n            onMouseLeave={(e) => (e.currentTarget.style.background = \"rgba(255,255,255,0.12)\")}\n          >\n            <svg width={16} height={16} viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M6 18L18 6M6 6l12 12\"\n              />\n            </svg>\n          </button>\n        )}\n      </div>\n\n      <div style={contentStyle}>{children}</div>\n\n      {resizeHandles.map(({ handle, style, cursor }) => (\n        <div\n          key={handle}\n          className=\"resize-handle\"\n          style={{\n            ...handleBaseStyle,\n            ...style,\n            cursor,\n            touchAction: \"none\",\n          }}\n          onPointerDown={(e) => handleResizeStart(e, handle)}\n          onMouseEnter={(e) => (e.currentTarget.style.background = \"rgba(59,130,246,0.35)\")}\n          onMouseLeave={(e) =>\n            (e.currentTarget.style.background = handleBaseStyle.background as string)\n          }\n        />\n      ))}\n    </div>\n  );\n}\n","path":null,"size_bytes":12256,"size_tokens":null},"shared/component/drawer_drawer-top-3.tsx":{"content":"\"use client\";\n\nimport { AlertCircle, X } from \"lucide-react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Drawer,\n  DrawerClose,\n  DrawerContent,\n  DrawerTrigger,\n} from \"@/components/ui/drawer\";\n\nexport const title = \"Top Drawer Notification Banner\";\n\nconst Example = () => (\n  <Drawer direction=\"top\">\n    <DrawerTrigger asChild>\n      <Button variant=\"outline\">Show Notification</Button>\n    </DrawerTrigger>\n    <DrawerContent>\n      <div className=\"border-blue-200 border-b bg-blue-50 dark:border-blue-900 dark:bg-blue-950\">\n        <div className=\"flex items-center justify-between p-4\">\n          <div className=\"flex items-center gap-3\">\n            <AlertCircle className=\"h-5 w-5 text-blue-600 dark:text-blue-400\" />\n            <div>\n              <h4 className=\"font-medium text-blue-900 dark:text-blue-100\">\n                System Update Available\n              </h4>\n              <p className=\"text-blue-700 text-sm dark:text-blue-300\">\n                A new version is available. Update now to get the latest\n                features.\n              </p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Button size=\"sm\" variant=\"outline\">\n              Update Now\n            </Button>\n            <DrawerClose asChild>\n              <Button className=\"h-8 w-8\" size=\"icon\" variant=\"ghost\">\n                <X className=\"h-4 w-4\" />\n              </Button>\n            </DrawerClose>\n          </div>\n        </div>\n      </div>\n    </DrawerContent>\n  </Drawer>\n);\n\nexport default Example;\n","path":null,"size_bytes":1575,"size_tokens":null},"yuzha/vite.config.ts":{"content":"/* eslint-env node */\nimport { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"node:path\";\nimport process from \"node:process\";\nimport { fileURLToPath } from \"node:url\";\nimport viteCompression from \"vite-plugin-compression\";\n\nconst resolveFromConfig = (relativePath: string) =>\n  path.resolve(path.dirname(fileURLToPath(import.meta.url)), relativePath);\n\n// Environment auto-detection\nconst isEmergent = !!process.env.KUBERNETES_SERVICE_HOST || !!process.env.EMERGENT_ENV;\nconst isReplit = !!process.env.REPL_ID || !!process.env.REPL_SLUG || !!process.env.REPLIT_DB_URL;\n\n// Port priority: PORT env > Platform default (Emergent: 3000, Replit: 5000) > General default: 3000\nconst DEFAULT_PORT = isReplit ? 5000 : isEmergent ? 3000 : 3000;\nconst PORT = Number(process.env.PORT) || DEFAULT_PORT;\n\nconst isProd = process.env.NODE_ENV === \"production\";\n\nexport default defineConfig({\n  root: resolveFromConfig(\".\"),\n  plugins: [\n    react({\n      // Optimize JSX runtime\n      jsxRuntime: \"automatic\",\n      babel: {\n        plugins: isProd ? [] : [],\n        compact: isProd,\n      },\n    }),\n    // Add compression plugin for production builds\n    isProd &&\n      viteCompression({\n        verbose: false,\n        disable: false,\n        threshold: 10240, // Only compress files > 10KB\n        algorithm: \"gzip\",\n        ext: \".gz\",\n        deleteOriginFile: false,\n      }),\n    // Add Brotli compression for better compression ratio\n    isProd &&\n      viteCompression({\n        verbose: false,\n        disable: false,\n        threshold: 10240,\n        algorithm: \"brotliCompress\",\n        ext: \".br\",\n        deleteOriginFile: false,\n      }),\n  ].filter(Boolean),\n  resolve: {\n    alias: {\n      \"@\": resolveFromConfig(\"./src\"),\n      \"@shared\": resolveFromConfig(\"../shared\"),\n    },\n    // Prevent multiple instances of three.js when using HMR or monorepo linking\n    dedupe: [\"react\", \"react-dom\", \"three\"],\n  },\n  define: {\n    __SHARED_ASSETS_PATH__: JSON.stringify(resolveFromConfig(\"../shared/asset\")),\n  },\n  publicDir: false,\n  server: {\n    host: \"0.0.0.0\",\n    port: PORT,\n    strictPort: true,\n    allowedHosts: true,\n    fs: {\n      allow: [resolveFromConfig(\".\"), resolveFromConfig(\"../shared\")],\n    },\n    // Enable HMR optimizations\n    hmr: {\n      overlay: true,\n    },\n    // Configure file watching for monorepo\n    watch: {\n      usePolling: false,\n      ignored: [\"**/node_modules/**\", \"**/.git/**\", \"**/dist/**\"],\n    },\n  },\n  preview: {\n    host: \"0.0.0.0\",\n    port: PORT,\n  },\n  build: {\n    target: \"es2020\",\n    sourcemap: isProd ? false : \"inline\",\n    // Enable minification with esbuild (faster than terser)\n    minify: \"esbuild\",\n    // CSS minification\n    cssMinify: true,\n    // Optimize chunk size\n    chunkSizeWarningLimit: 1000,\n    // Rollup options for optimized builds\n    rollupOptions: {\n      output: {\n        // Improved manual chunking strategy\n        manualChunks: (id) => {\n          // Vendor chunks\n          if (id.includes(\"node_modules\")) {\n            // React in separate chunk\n            if (id.includes(\"react\") || id.includes(\"react-dom\")) {\n              return \"react-vendor\";\n            }\n            // Three.js in separate chunk (large library)\n            if (id.includes(\"three\")) {\n              return \"three-vendor\";\n            }\n            // Other vendor libraries\n            return \"vendor\";\n          }\n          // Shared code in separate chunk\n          if (id.includes(\"../shared\")) {\n            return \"shared\";\n          }\n        },\n        // Optimize chunk file names\n        chunkFileNames: \"assets/[name]-[hash].js\",\n        entryFileNames: \"assets/[name]-[hash].js\",\n        assetFileNames: \"assets/[name]-[hash].[ext]\",\n      },\n    },\n    // Enable CSS code splitting\n    cssCodeSplit: true,\n    // Report compressed size\n    reportCompressedSize: true,\n    // Optimize dependencies\n    commonjsOptions: {\n      include: [/node_modules/],\n      transformMixedEsModules: true,\n    },\n  },\n  // Optimize dependencies pre-bundling\n  optimizeDeps: {\n    include: [\"react\", \"react-dom\", \"three\"],\n    esbuildOptions: {\n      target: \"es2020\",\n      // Enable optimizations\n      minify: false, // Don't minify in dev\n      treeShaking: true,\n      // Optimize loader\n      loader: {\n        \".js\": \"jsx\",\n      },\n    },\n  },\n  // Enable esbuild for faster transpilation\n  esbuild: {\n    logOverride: { \"this-is-undefined-in-esm\": \"silent\" },\n    treeShaking: true,\n    minifyIdentifiers: isProd,\n    minifySyntax: isProd,\n    minifyWhitespace: isProd,\n    target: \"es2020\",\n  },\n  assetsInclude: [\"**/*.png\", \"**/*.jpg\", \"**/*.jpeg\", \"**/*.gif\", \"**/*.svg\"],\n  // Enable caching\n  cacheDir: \"node_modules/.vite\",\n});\n","path":null,"size_bytes":4748,"size_tokens":null},"shared/component/input_input-types-2.tsx":{"content":"\"use client\";\n\nimport { Eye, EyeOff } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Password with Toggle\";\n\nconst Example = () => {\n  const [showPassword, setShowPassword] = useState(false);\n\n  return (\n    <div className=\"w-full max-w-sm space-y-2\">\n      <Label htmlFor=\"password-toggle\">Password</Label>\n      <div className=\"relative\">\n        <Input\n          className=\"bg-background\"\n          id=\"password-toggle\"\n          placeholder=\"Enter your password\"\n          type={showPassword ? \"text\" : \"password\"}\n        />\n        <Button\n          className=\"absolute top-0 right-0 h-full px-3 hover:bg-transparent\"\n          onClick={() => setShowPassword(!showPassword)}\n          size=\"icon\"\n          type=\"button\"\n          variant=\"ghost\"\n        >\n          {showPassword ? (\n            <EyeOff className=\"h-4 w-4 text-muted-foreground\" />\n          ) : (\n            <Eye className=\"h-4 w-4 text-muted-foreground\" />\n          )}\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":1197,"size_tokens":null},"shared/component/calendar_calendar-dialog-5.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\n\nexport const title = \"Calendar with Natural Language in Dialog\";\n\nconst Example = () => {\n  const [date, setDate] = useState<Date | undefined>(new Date());\n\n  const shortcuts = [\n    { label: \"Today\", date: new Date() },\n    {\n      label: \"Tomorrow\",\n      date: new Date(new Date().setDate(new Date().getDate() + 1)),\n    },\n    {\n      label: \"In 3 days\",\n      date: new Date(new Date().setDate(new Date().getDate() + 3)),\n    },\n    {\n      label: \"In a week\",\n      date: new Date(new Date().setDate(new Date().getDate() + 7)),\n    },\n    {\n      label: \"In 2 weeks\",\n      date: new Date(new Date().setDate(new Date().getDate() + 14)),\n    },\n    {\n      label: \"In a month\",\n      date: new Date(new Date().setMonth(new Date().getMonth() + 1)),\n    },\n  ];\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>\n        <Button variant=\"outline\">Select Date</Button>\n      </DialogTrigger>\n      <DialogContent className=\"sm:max-w-[550px]\">\n        <DialogHeader>\n          <DialogTitle>Select Date</DialogTitle>\n        </DialogHeader>\n        <div className=\"flex divide-x overflow-hidden rounded-md border bg-background\">\n          <Calendar mode=\"single\" onSelect={setDate} selected={date} />\n          <div className=\"relative w-[249px] overflow-hidden\">\n            <div className=\"absolute inset-0 grid gap-4\">\n              <div className=\"space-y-2 px-4 pt-4\">\n                <p className=\"text-center font-medium text-sm\">Quick Select</p>\n              </div>\n              <ScrollArea className=\"h-full overflow-y-auto\">\n                <div className=\"grid grid-cols-1 gap-2 px-4 pb-4\">\n                  {shortcuts.map((shortcut) => (\n                    <Button\n                      key={shortcut.label}\n                      onClick={() => setDate(new Date(shortcut.date))}\n                      size=\"sm\"\n                      variant=\"outline\"\n                    >\n                      {shortcut.label}\n                    </Button>\n                  ))}\n                </div>\n              </ScrollArea>\n            </div>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":2484,"size_tokens":null},"shared/component/card_card-standard-2.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Login Card\";\n\nconst Example = () => {\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n\n  return (\n    <Card className=\"w-full max-w-md\">\n      <CardHeader>\n        <CardTitle>Login to your account</CardTitle>\n        <CardDescription>\n          Enter your email below to login to your account\n        </CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"email\">Email</Label>\n          <Input\n            id=\"email\"\n            onChange={(e) => setEmail(e.target.value)}\n            placeholder=\"m@example.com\"\n            type=\"email\"\n            value={email}\n          />\n        </div>\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center justify-between\">\n            <Label htmlFor=\"password\">Password</Label>\n            <a className=\"text-sm hover:underline\" href=\"#\">\n              Forgot your password?\n            </a>\n          </div>\n          <Input\n            id=\"password\"\n            onChange={(e) => setPassword(e.target.value)}\n            type=\"password\"\n            value={password}\n          />\n        </div>\n        <Button className=\"w-full\">Login</Button>\n        <Button className=\"w-full\" variant=\"outline\">\n          Login with Google\n        </Button>\n      </CardContent>\n      <CardFooter className=\"flex justify-center\">\n        <p className=\"text-muted-foreground text-sm\">\n          Don't have an account?{\" \"}\n          <a className=\"underline\" href=\"#\">\n            Sign up\n          </a>\n        </p>\n      </CardFooter>\n    </Card>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":2002,"size_tokens":null},"meng/src/main.tsx":{"content":"/**\n * Main Entry Point for Plantation Cafe Resto React Application\n *\n * Purpose: Initialize and mount the React application to the DOM\n *\n * Flow:\n * 1. Import React and ReactDOM\n * 2. Import root App component\n * 3. Import global styles (includes Tailwind CSS)\n * 4. Mount App to #root div in index.html\n *\n * For Future AI Agents:\n * - This file uses React 18's createRoot API for concurrent rendering\n * - StrictMode enabled for development warnings\n * - All Tailwind CSS loaded via index.css\n * - Do NOT modify unless changing React version or adding global providers\n */\n\nimport React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport App from './App'\nimport './index.css'\n\n// Create root and render app\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n)\n","path":null,"size_bytes":840,"size_tokens":null},"shared/component/input-group_input-group-tooltip-1.tsx":{"content":"import { InfoIcon } from \"lucide-react\";\n\nimport {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupInput,\n} from \"@/components/ui/input-group\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\n\nexport const title = \"Password Requirements\";\n\nconst Example = () => (\n  <TooltipProvider>\n    <div className=\"flex w-full max-w-sm flex-col gap-4\">\n      <InputGroup className=\"bg-background\">\n        <InputGroupInput placeholder=\"Enter password\" type=\"password\" />\n        <InputGroupAddon align=\"inline-end\">\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <InputGroupButton size=\"icon-xs\" variant=\"ghost\">\n                <InfoIcon />\n              </InputGroupButton>\n            </TooltipTrigger>\n            <TooltipContent>\n              <p>Password must be at least 8 characters</p>\n            </TooltipContent>\n          </Tooltip>\n        </InputGroupAddon>\n      </InputGroup>\n      <InputGroup className=\"bg-background\">\n        <InputGroupInput placeholder=\"Confirm password\" type=\"password\" />\n        <InputGroupAddon align=\"inline-end\">\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <InputGroupButton size=\"icon-xs\" variant=\"ghost\">\n                <InfoIcon />\n              </InputGroupButton>\n            </TooltipTrigger>\n            <TooltipContent>\n              <p>Enter the same password as above</p>\n            </TooltipContent>\n          </Tooltip>\n        </InputGroupAddon>\n      </InputGroup>\n    </div>\n  </TooltipProvider>\n);\n\nexport default Example;\n","path":null,"size_bytes":1604,"size_tokens":null},"shared/component/drawer_drawer-left-2.tsx":{"content":"\"use client\";\n\nimport {\n  FileText,\n  HelpCircle,\n  Home,\n  Menu,\n  Settings,\n  Users,\n} from \"lucide-react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Drawer, DrawerContent, DrawerTrigger } from \"@/components/ui/drawer\";\n\nexport const title = \"Left Drawer Navigation Menu\";\n\nconst Example = () => (\n  <Drawer direction=\"left\">\n    <DrawerTrigger asChild>\n      <Button size=\"icon\" variant=\"outline\">\n        <Menu className=\"h-4 w-4\" />\n      </Button>\n    </DrawerTrigger>\n    <DrawerContent>\n      <div className=\"p-4\">\n        <h2 className=\"mb-4 font-semibold text-lg\">Navigation</h2>\n        <nav className=\"space-y-1\">\n          <Button className=\"w-full justify-start\" variant=\"ghost\">\n            <Home className=\"mr-3 h-4 w-4\" />\n            Home\n          </Button>\n          <Button className=\"w-full justify-start\" variant=\"ghost\">\n            <Users className=\"mr-3 h-4 w-4\" />\n            Team\n          </Button>\n          <Button className=\"w-full justify-start\" variant=\"ghost\">\n            <FileText className=\"mr-3 h-4 w-4\" />\n            Projects\n          </Button>\n          <Button className=\"w-full justify-start\" variant=\"ghost\">\n            <Settings className=\"mr-3 h-4 w-4\" />\n            Settings\n          </Button>\n          <Button className=\"w-full justify-start\" variant=\"ghost\">\n            <HelpCircle className=\"mr-3 h-4 w-4\" />\n            Help\n          </Button>\n        </nav>\n      </div>\n    </DrawerContent>\n  </Drawer>\n);\n\nexport default Example;\n","path":null,"size_bytes":1510,"size_tokens":null},"shared/layer/motion.ts":{"content":"/** LAYER MOTION - Motion builder utilities extracted from the engine. */\n\nimport type {\n  ClockMotionConfig,\n  LayerConfigEntry,\n  LayerMotionArtifacts,\n  LayerMotionMarker,\n  LayerProcessor,\n  Point2D,\n  PercentPoint,\n  RotationDirection,\n  UniversalLayerData,\n  ImageMapping,\n  ResolvedClockSpeed,\n  EnhancedLayerData,\n} from \"./model\";\nimport {\n  calculatePositionForPivot,\n  calculateRotationDegrees,\n  clampStage,\n  normalizeAngle,\n  normalizePercent,\n  resolveClockSpeed,\n} from \"./math\";\n\ntype LayerMotionConfig = {\n  stageSize: number;\n  blueStage: Point2D;\n  redStage?: Point2D;\n  circleRadius?: number;\n  initialAngleDeg?: number;\n  pivotPercent: PercentPoint;\n  circleVisible: boolean;\n  pivotVisible: boolean;\n  spinMotion: MotionResolution;\n  orbitMotion: MotionResolution;\n};\n\ntype MotionResolution = {\n  active: boolean;\n  motionConfig?: ClockMotionConfig;\n  resolved: ResolvedClockSpeed;\n};\n\ntype ProcessorState = {\n  startPerfTime?: number;\n  startWallClockMs?: number;\n  spinTimezoneCache: Map<number, Date>;\n  orbitTimezoneCache: Map<number, Date>;\n};\n\nconst processorStateCache = new Map<string, ProcessorState>();\n\nconst acquireProcessorState = (layerId: string): ProcessorState => {\n  let state = processorStateCache.get(layerId);\n  if (!state) {\n    state = {\n      spinTimezoneCache: new Map<number, Date>(),\n      orbitTimezoneCache: new Map<number, Date>(),\n    };\n    processorStateCache.set(layerId, state);\n  }\n  return state;\n};\n\nexport const clearProcessorStates = (layerId?: string): void => {\n  if (layerId) {\n    processorStateCache.delete(layerId);\n    return;\n  }\n  processorStateCache.clear();\n};\n\n/** Build layer motion processor and markers. */\nexport function buildLayerMotion(\n  entry: LayerConfigEntry,\n  layer: UniversalLayerData,\n  stageSize: number,\n): LayerMotionArtifacts {\n  const config = deriveLayerMotionConfig(entry, layer, stageSize);\n  if (!config) {\n    return {};\n  }\n\n  const markers = createMotionMarkers(entry.LayerID, config);\n  const processor = createLayerMotionProcessor(entry, config, layer.imageMapping);\n\n  return {\n    processor,\n    markers: markers.length > 0 ? markers : undefined,\n  };\n}\n\nfunction deriveLayerMotionConfig(\n  entry: LayerConfigEntry,\n  layer: UniversalLayerData,\n  stageSize: number,\n): LayerMotionConfig | null {\n  const stageCenterPoint = layer.calculation.stageCenter?.point ?? {\n    x: stageSize / 2,\n    y: stageSize / 2,\n  };\n\n  const computedSpinPercent = layer.spinStagePoint\n    ? layer.calculation.spinPoint.image.percent\n    : undefined;\n\n  const pivotPercent = layer.spinPercent ??\n    sanitizePercent(entry.spinImagePoint) ??\n    sanitizePercent(entry.BasicImagePoint) ??\n    computedSpinPercent ?? {\n      x: 50,\n      y: 50,\n    };\n\n  const blueStage =\n    layer.spinStagePoint ??\n    layer.orbitLinePoint ??\n    sanitizeStagePoint(entry.spinStagePoint, stageSize) ??\n    sanitizeStagePoint(entry.orbitLinePoint, stageSize) ??\n    sanitizeStagePoint(entry.BasicStagePoint, stageSize) ??\n    stageCenterPoint;\n\n  const redStage = layer.orbitStagePoint ?? sanitizeStagePoint(entry.orbitStagePoint, stageSize);\n\n  const circleRadius =\n    layer.orbitRadius ??\n    (redStage !== undefined ? distanceBetween(blueStage, redStage) : undefined);\n\n  const initialAngleDeg =\n    layer.orbitRadius && layer.orbitLinePoint && layer.orbitStagePoint\n      ? normalizeAngle(\n          (Math.atan2(\n            -(layer.orbitLinePoint.y - layer.orbitStagePoint.y),\n            layer.orbitLinePoint.x - layer.orbitStagePoint.x,\n          ) *\n            180) /\n            Math.PI,\n        )\n      : redStage !== undefined && circleRadius !== undefined && circleRadius > 0\n        ? normalizeAngle(\n            (Math.atan2(-(blueStage.y - redStage.y), blueStage.x - redStage.x) * 180) / Math.PI,\n          )\n        : undefined;\n\n  const spinMotion = resolveMotion(\n    {\n      speed: entry.spinSpeedAlias ?? entry.spinSpeed,\n      direction: entry.spinDirection,\n      format: entry.spinFormat,\n      timezone: entry.spinTimezone,\n    },\n    entry.spinSpeed ?? 0,\n  );\n\n  const orbitMotion = resolveMotion(\n    {\n      speed: entry.orbitSpeedAlias ?? entry.orbitSpeed,\n      direction: entry.orbitDirection,\n      format: entry.orbitFormat,\n      timezone: entry.orbitTimezone,\n    },\n    entry.orbitSpeed ?? 0,\n  );\n\n  const spinActive = spinMotion.active;\n  const orbitActive =\n    redStage !== undefined && circleRadius !== undefined && circleRadius > 0 && orbitMotion.active;\n\n  if (!spinActive && !orbitActive) {\n    return null;\n  }\n\n  return {\n    stageSize,\n    blueStage,\n    redStage,\n    circleRadius,\n    initialAngleDeg,\n    circleVisible: layer.orbitLineVisible ?? Boolean(entry.orbitLine),\n    pivotPercent,\n    pivotVisible: Boolean(entry.spinImagePoint),\n    spinMotion,\n    orbitMotion,\n  };\n}\n\nfunction createLayerMotionProcessor(\n  entry: LayerConfigEntry,\n  config: LayerMotionConfig,\n  imageMapping: ImageMapping,\n): LayerProcessor | undefined {\n  const state = acquireProcessorState(entry.LayerID);\n\n  const hasSpin = config.spinMotion.active;\n  const hasOrbit = config.orbitMotion.active && config.redStage && config.circleRadius;\n\n  if (!hasSpin && !hasOrbit) {\n    return undefined;\n  }\n\n  const pivotPercent = config.pivotPercent;\n\n  return (layer: UniversalLayerData, timestamp?: number): EnhancedLayerData => {\n    const perfNow = timestamp ?? performance.now();\n\n    if (state.startPerfTime === undefined) {\n      state.startPerfTime = perfNow;\n      state.startWallClockMs = Date.now();\n    }\n\n    const baseNowMs =\n      state.startWallClockMs !== undefined && state.startPerfTime !== undefined\n        ? state.startWallClockMs + (perfNow - state.startPerfTime)\n        : Date.now();\n\n    const baseDate = new Date(baseNowMs);\n\n    let rotationDeg = layer.rotation ?? 0;\n    if (hasSpin) {\n      rotationDeg = normalizeAngle(\n        calculateRotationDegrees(\n          config.spinMotion.resolved,\n          baseDate,\n          state.spinTimezoneCache,\n          state.startWallClockMs,\n        ),\n      );\n    }\n\n    let orbitPoint = config.blueStage;\n    let currentOrbitAngle = config.initialAngleDeg ?? 0;\n\n    if (hasOrbit && config.redStage && config.circleRadius !== undefined) {\n      const orbitAngleDelta = calculateRotationDegrees(\n        config.orbitMotion.resolved,\n        baseDate,\n        state.orbitTimezoneCache,\n        state.startWallClockMs,\n      );\n\n      currentOrbitAngle = normalizeAngle((config.initialAngleDeg ?? 0) + orbitAngleDelta);\n      const angleRad = (currentOrbitAngle * Math.PI) / 180;\n\n      orbitPoint = {\n        x: config.redStage.x + config.circleRadius * Math.cos(angleRad),\n        y: config.redStage.y - config.circleRadius * Math.sin(angleRad),\n      };\n    }\n\n    const newPosition = calculatePositionForPivot(\n      orbitPoint,\n      pivotPercent,\n      imageMapping,\n      layer.scale,\n      rotationDeg,\n    );\n\n    const motionAugments: Record<string, unknown> = {\n      position: newPosition,\n      currentRotation: rotationDeg,\n      hasSpinAnimation: hasSpin,\n      spinDirection: entry.spinDirection ?? \"cw\",\n      spinSpeed:\n        entry.spinSpeed ??\n        (config.spinMotion.resolved.kind === \"numeric\"\n          ? config.spinMotion.resolved.rotationsPerHour\n          : 0),\n      spinSpeedAlias:\n        entry.spinSpeedAlias ??\n        (config.spinMotion.resolved.kind === \"alias\"\n          ? config.spinMotion.resolved.alias\n          : undefined),\n      spinFormat: entry.spinFormat,\n      spinTimezone: entry.spinTimezone,\n      spinStagePoint: orbitPoint,\n      spinPercent: pivotPercent,\n      hasOrbitalAnimation: hasOrbit,\n      orbitPoint,\n      orbitStagePoint: config.redStage,\n      orbitLinePoint: config.blueStage,\n      orbitLineVisible: config.circleVisible,\n      orbitRadius: config.circleRadius,\n      orbitSpeed:\n        entry.orbitSpeed ??\n        (config.orbitMotion.resolved.kind === \"numeric\"\n          ? config.orbitMotion.resolved.rotationsPerHour\n          : 0),\n      orbitSpeedAlias:\n        entry.orbitSpeedAlias ??\n        (config.orbitMotion.resolved.kind === \"alias\"\n          ? config.orbitMotion.resolved.alias\n          : undefined),\n      orbitFormat: entry.orbitFormat,\n      orbitTimezone: entry.orbitTimezone,\n      orbitDirection: entry.orbitDirection ?? \"cw\",\n      orbitLineStyle:\n        config.circleVisible && config.circleRadius\n          ? { radius: config.circleRadius, visible: true }\n          : undefined,\n      currentOrbitAngle: currentOrbitAngle,\n    };\n\n    return {\n      ...layer,\n      ...motionAugments,\n    } as EnhancedLayerData;\n  };\n}\n\nfunction createMotionMarkers(layerId: string, config: LayerMotionConfig): LayerMotionMarker[] {\n  const markers: LayerMotionMarker[] = [];\n\n  if (config.redStage) {\n    markers.push({\n      id: `${layerId}-StageRed`,\n      x: config.redStage.x,\n      y: config.redStage.y,\n      color: \"#ef4444\",\n      radius: 6,\n      kind: \"point\",\n    });\n  }\n\n  if (config.blueStage) {\n    const motion =\n      config.orbitMotion.active &&\n      config.redStage &&\n      config.circleRadius &&\n      config.initialAngleDeg !== undefined\n        ? {\n            type: \"orbit\" as const,\n            centerX: config.redStage.x,\n            centerY: config.redStage.y,\n            radius: config.circleRadius,\n            rotationsPerHour: resolveRotationsPerHour(config.orbitMotion.resolved),\n            direction: (config.orbitMotion.motionConfig?.direction ?? \"cw\") as RotationDirection,\n            initialAngleDeg: config.initialAngleDeg,\n          }\n        : undefined;\n\n    markers.push({\n      id: `${layerId}-StageBlue`,\n      x: config.blueStage.x,\n      y: config.blueStage.y,\n      color: \"#3b82f6\",\n      radius: 6,\n      kind: \"point\",\n      motion,\n    });\n  }\n\n  if (config.circleVisible && config.redStage && config.circleRadius) {\n    markers.push({\n      id: `${layerId}-StageCircle`,\n      x: config.redStage.x,\n      y: config.redStage.y,\n      color: \"rgba(255, 255, 255, 0.9)\",\n      radius: config.circleRadius,\n      kind: \"circle\",\n      lineWidth: 1,\n    });\n  }\n\n  if (config.pivotVisible) {\n    markers.push({\n      id: `${layerId}-ImagePivot`,\n      x: config.blueStage.x,\n      y: config.blueStage.y,\n      color: \"#facc15\",\n      radius: 3,\n      kind: \"point\",\n    });\n  }\n\n  return markers;\n}\n\nfunction resolveMotion(motion: ClockMotionConfig, fallbackNumeric: number): MotionResolution {\n  const hasConfig =\n    motion.speed !== undefined || motion.format !== undefined || motion.timezone !== undefined;\n\n  const resolved = resolveClockSpeed(hasConfig ? motion : undefined, 0, fallbackNumeric);\n\n  const active =\n    resolved.kind === \"alias\" || (resolved.kind === \"numeric\" && resolved.rotationsPerHour !== 0);\n\n  return {\n    active,\n    motionConfig: hasConfig ? motion : undefined,\n    resolved,\n  };\n}\n\nfunction sanitizePercent(value?: number[] | PercentPoint | null): PercentPoint | undefined {\n  if (!value) return undefined;\n  if (Array.isArray(value)) {\n    if (value.length < 2) return undefined;\n    const [x, y] = value;\n    if (x === undefined || y === undefined) return undefined;\n    if (!Number.isFinite(x) || !Number.isFinite(y)) return undefined;\n    return {\n      x: normalizePercent(x),\n      y: normalizePercent(y),\n    };\n  }\n  if (typeof value.x === \"number\" && typeof value.y === \"number\") {\n    return {\n      x: normalizePercent(value.x),\n      y: normalizePercent(value.y),\n    };\n  }\n  return undefined;\n}\n\nfunction sanitizeStagePoint(value: number[] | undefined, stageSize: number): Point2D | undefined {\n  if (!value || value.length < 2) return undefined;\n  const [x, y] = value;\n  if (x === undefined || y === undefined) return undefined;\n  if (!Number.isFinite(x) || !Number.isFinite(y)) return undefined;\n  return {\n    x: clampStage(x, stageSize),\n    y: clampStage(y, stageSize),\n  };\n}\n\nfunction distanceBetween(a: Point2D, b: Point2D): number {\n  const dx = a.x - b.x;\n  const dy = a.y - b.y;\n  return Math.hypot(dx, dy);\n}\n\nfunction resolveRotationsPerHour(resolved: ResolvedClockSpeed): number {\n  if (resolved.kind === \"numeric\") {\n    return resolved.rotationsPerHour;\n  }\n  if (resolved.kind === \"alias\") {\n    switch (resolved.alias) {\n      case \"second\":\n        return 60;\n      case \"minute\":\n        return 1;\n      case \"hour\":\n        return 1 / 12;\n      default:\n        return 0;\n    }\n  }\n  return 0;\n}\n","path":null,"size_bytes":12359,"size_tokens":null},"yuzha/src/alphaRemove/alphaRemoveScreen.tsx":{"content":"import React, { useEffect, useMemo, useRef, useState } from \"react\";\n\ntype ImageDataResult = {\n  url: string;\n  width: number;\n  height: number;\n};\n\nfunction processImage(\n  img: HTMLImageElement,\n  threshold: number,\n  curve: number,\n): ImageDataResult {\n  const canvas = document.createElement(\"canvas\");\n  canvas.width = img.naturalWidth;\n  canvas.height = img.naturalHeight;\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) {\n    throw new Error(\"Canvas 2D not supported\");\n  }\n  ctx.drawImage(img, 0, 0);\n  const data = ctx.getImageData(0, 0, canvas.width, canvas.height);\n  const t = Math.min(255, Math.max(0, threshold));\n  const tNorm = t / 255;\n  const buf = data.data;\n\n  for (let i = 0; i < buf.length; i += 4) {\n    const r = (buf[i] ?? 0) / 255;\n    const g = (buf[i + 1] ?? 0) / 255;\n    const b = (buf[i + 2] ?? 0) / 255;\n    const lum = Math.max(r, g, b);\n    let a = lum <= tNorm ? 0 : (lum - tNorm) / (1 - tNorm);\n    a = Math.pow(Math.min(1, Math.max(0, a)), curve);\n    buf[i + 3] = Math.round(a * 255);\n  }\n\n  ctx.putImageData(data, 0, 0);\n  const url = canvas.toDataURL(\"image/png\");\n  return { url, width: canvas.width, height: canvas.height };\n}\n\nexport default function AlphaRemoveScreen({ onBack }: { onBack?: () => void }) {\n  const [file, setFile] = useState<File | null>(null);\n  const [threshold, setThreshold] = useState(32);\n  const [curve, setCurve] = useState(1.4);\n  const [preview, setPreview] = useState<ImageDataResult | null>(null);\n  const [splitView, setSplitView] = useState(false);\n  const [splitPercent, setSplitPercent] = useState(50);\n  const imgRef = useRef<HTMLImageElement | null>(null);\n\n  // Load the image when a file is selected\n  useEffect(() => {\n    if (!file) {\n      setPreview(null);\n      imgRef.current = null;\n      return;\n    }\n    const reader = new FileReader();\n    reader.onload = () => {\n      if (typeof reader.result !== \"string\") return;\n      const img = new Image();\n      img.onload = () => {\n        imgRef.current = img;\n        const result = processImage(img, threshold, curve);\n        setPreview(result);\n      };\n      img.src = reader.result;\n    };\n    reader.readAsDataURL(file);\n  }, [file]);\n\n  // Reprocess when sliders change and an image is already loaded\n  useEffect(() => {\n    const img = imgRef.current;\n    if (!img) return;\n    const result = processImage(img, threshold, curve);\n    setPreview(result);\n  }, [threshold, curve]);\n\n  const downloadName = useMemo(() => {\n    if (!file) return \"output.png\";\n    const base = file.name.replace(/\\.png$/i, \"\");\n    return `${base}_alpha.png`;\n  }, [file]);\n\n  const handleReprocess = () => {\n    if (!imgRef.current) return;\n    const result = processImage(imgRef.current, threshold, curve);\n    setPreview(result);\n  };\n\n  const checkerboardStyle: React.CSSProperties = {\n    backgroundImage:\n      \"linear-gradient(45deg, #555 25%, transparent 25%), linear-gradient(-45deg, #555 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #555 75%), linear-gradient(-45deg, transparent 75%, #555 75%)\",\n    backgroundSize: \"16px 16px\",\n    backgroundPosition: \"0 0, 0 8px, 8px -8px, -8px 0px\",\n  };\n\n  return (\n    <div className=\"flex h-screen w-screen flex-col bg-slate-900 text-white\">\n      <div className=\"flex items-center justify-between px-4 py-3 border-b border-white/10 bg-slate-800/70 backdrop-blur\">\n        <div>\n          <div className=\"text-lg font-semibold\">Alpha Remover</div>\n          <div className=\"text-xs text-slate-300\">Convert black matte to transparent (offline)</div>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          {onBack && (\n            <button\n              type=\"button\"\n              onClick={onBack}\n              className=\"rounded bg-slate-700 px-3 py-1 text-sm hover:bg-slate-600\"\n            >\n              Back\n            </button>\n          )}\n        </div>\n      </div>\n\n      <div className=\"grid flex-1 grid-cols-1 gap-4 p-4 lg:grid-cols-[340px,1fr]\">\n        <div className=\"space-y-3 rounded-lg border border-white/10 bg-slate-800/60 p-4 backdrop-blur\">\n          <div className=\"space-y-1\">\n            <label className=\"text-sm font-medium\">PNG file</label>\n            <input\n              type=\"file\"\n              accept=\"image/png\"\n              onChange={(e) => setFile(e.target.files?.[0] ?? null)}\n              className=\"block w-full text-sm text-white\"\n            />\n          </div>\n\n          <div className=\"space-y-1\">\n            <label className=\"text-sm font-medium\">\n              Threshold (remove darker areas) — {threshold}\n            </label>\n            <input\n              type=\"range\"\n              min={0}\n              max={255}\n              value={threshold}\n              onChange={(e) => setThreshold(Number(e.target.value))}\n              className=\"w-full\"\n            />\n          </div>\n\n            <div className=\"space-y-1\">\n              <label className=\"text-sm font-medium\">Curve (edge hardness) — {curve.toFixed(2)}</label>\n              <input\n                type=\"range\"\n                min={1}\n              max={3}\n              step={0.05}\n              value={curve}\n              onChange={(e) => setCurve(Number(e.target.value))}\n              className=\"w-full\"\n            />\n          </div>\n\n          <div className=\"flex items-center justify-between\">\n            <label className=\"text-sm font-medium\">Split preview</label>\n            <input\n              type=\"checkbox\"\n              checked={splitView}\n              onChange={(e) => setSplitView(e.target.checked)}\n              className=\"h-4 w-4\"\n            />\n          </div>\n          {splitView && (\n            <div className=\"space-y-1\">\n              <label className=\"text-sm font-medium\">Split position — {splitPercent}%</label>\n              <input\n                type=\"range\"\n                min={0}\n                max={100}\n                value={splitPercent}\n                onChange={(e) => setSplitPercent(Number(e.target.value))}\n                className=\"w-full\"\n              />\n            </div>\n          )}\n\n          <button\n            type=\"button\"\n            onClick={handleReprocess}\n            disabled={!file}\n            className=\"w-full rounded bg-emerald-600 px-3 py-2 text-sm font-semibold hover:bg-emerald-500 disabled:cursor-not-allowed disabled:bg-slate-600\"\n          >\n            Reprocess\n          </button>\n\n          {preview && (\n            <a\n              download={downloadName}\n              href={preview.url}\n              className=\"block w-full rounded bg-sky-600 px-3 py-2 text-center text-sm font-semibold hover:bg-sky-500\"\n            >\n              Download cleaned PNG\n            </a>\n          )}\n\n          <p className=\"text-xs text-slate-300\">\n            Tip: Increase threshold to remove more fringe; increase curve to sharpen the edge. This runs entirely\n            in the browser—no upload.\n          </p>\n        </div>\n\n        <div className=\"rounded-lg border border-white/10 bg-slate-800/40 p-4 backdrop-blur\">\n          {preview ? (\n            <div className=\"space-y-3\">\n              <div className=\"text-sm text-slate-200\">\n                Preview ({preview.width}x{preview.height})\n              </div>\n              {!splitView && (\n                <div className=\"grid gap-3 md:grid-cols-2\">\n                  <div\n                    className=\"overflow-hidden rounded border border-white/10 p-2\"\n                    style={checkerboardStyle}\n                  >\n                    <div className=\"text-xs text-slate-300 mb-1\">Original (alpha as-is)</div>\n                    <img\n                      src={imgRef.current?.src}\n                      alt=\"original\"\n                      className=\"w-full\"\n                      draggable={false}\n                    />\n                  </div>\n                  <div\n                    className=\"overflow-hidden rounded border border-white/10 p-2\"\n                    style={checkerboardStyle}\n                  >\n                    <div className=\"text-xs text-slate-300 mb-1\">\n                      Processed (checkerboard shows transparency)\n                    </div>\n                    <img src={preview.url} alt=\"processed\" className=\"w-full\" draggable={false} />\n                  </div>\n                </div>\n              )}\n              {splitView && (\n                <div\n                  className=\"relative overflow-hidden rounded border border-white/10 p-2\"\n                  style={checkerboardStyle}\n                >\n                  <div className=\"text-xs text-slate-300 mb-1\">Split view</div>\n                  <div className=\"relative w-full\">\n                    <img\n                      src={imgRef.current?.src}\n                      alt=\"original\"\n                      className=\"w-full\"\n                      draggable={false}\n                      style={{ clipPath: `inset(0 ${100 - splitPercent}% 0 0)` }}\n                    />\n                    <img\n                      src={preview.url}\n                      alt=\"processed\"\n                      className=\"absolute inset-0 h-full w-full\"\n                      style={{ clipPath: `inset(0 0 0 ${splitPercent}%)` }}\n                      draggable={false}\n                    />\n                    <div\n                      className=\"absolute top-0 bottom-0 w-[2px] bg-emerald-400\"\n                      style={{ left: `${splitPercent}%`, transform: \"translateX(-1px)\" }}\n                    />\n                  </div>\n                </div>\n              )}\n            </div>\n          ) : (\n            <div className=\"flex h-full items-center justify-center text-sm text-slate-300\">\n              Select a PNG to preview and download cleaned output.\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9832,"size_tokens":null},"netlify.toml":{"content":"# Root Netlify config (berlaku untuk semua site yang mengambil repo ini).\n# SPA redirect universal agar client routing tidak 404.\n\n[build]\n  base = \".\"\n  command = \"npm run build --workspace yuzha\"\n  publish = \"yuzha/dist\"\n\n[[redirects]]\n  from = \"/*\"\n  to = \"/index.html\"\n  status = 200\n\n# (Opsional) Security headers ringan; aman untuk semua app.\n[[headers]]\n  for = \"/*\"\n  [headers.values]\n    Cache-Control = \"no-store\"\n    X-Content-Type-Options = \"nosniff\"\n    Referrer-Policy = \"strict-origin-when-cross-origin\"\n    X-Frame-Options = \"DENY\"\n    X-XSS-Protection = \"0\"\n    Permissions-Policy = \"camera=(), microphone=(), geolocation=()\"\n    # Content Security Policy (adjust domains as needed for APIs/CDNs)\n    Content-Security-Policy = \"default-src 'self'; base-uri 'self'; object-src 'none'; frame-ancestors 'none'; upgrade-insecure-requests; script-src 'self' 'wasm-unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https://cdn-hk.icons8.com; font-src 'self' data:; connect-src 'self' data: https://cdn-hk.icons8.com; media-src 'self' blob:; worker-src 'self' blob:\"\n\n[[headers]]\n  # Fingerprinted build assets from Vite\n  for = \"/assets/*\"\n  [headers.values]\n    Cache-Control = \"public, max-age=31536000, immutable\"\n","path":null,"size_bytes":1247,"size_tokens":null},"shared/component/input_input-types-5.tsx":{"content":"\"use client\";\n\nimport { Calendar } from \"lucide-react\";\n\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Date Input\";\n\nconst Example = () => (\n  <div className=\"w-full max-w-sm space-y-2\">\n    <Label htmlFor=\"date-input\">Date of Birth</Label>\n    <div className=\"relative\">\n      <Calendar className=\"-translate-y-1/2 absolute top-1/2 left-3 h-4 w-4 text-muted-foreground\" />\n      <Input className=\"bg-background pl-9\" id=\"date-input\" type=\"date\" />\n    </div>\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":568,"size_tokens":null},"shared/component/popover_popover-standard-12.tsx":{"content":"import { Bell } from \"lucide-react\";\n\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { Separator } from \"@/components/ui/separator\";\n\nexport const title = \"Notifications Popover\";\n\nconst Example = () => (\n  <Popover>\n    <PopoverTrigger asChild>\n      <Button className=\"relative\" size=\"icon\" variant=\"ghost\">\n        <Bell className=\"h-5 w-5\" />\n        <Badge className=\"-right-1 -top-1 absolute h-5 w-5 items-center justify-center rounded-full p-0 text-xs\">\n          3\n        </Badge>\n      </Button>\n    </PopoverTrigger>\n    <PopoverContent className=\"w-80\">\n      <div className=\"space-y-3\">\n        <div className=\"flex items-center justify-between\">\n          <h4 className=\"font-semibold\">Notifications</h4>\n          <Button size=\"sm\" variant=\"ghost\">\n            Mark all as read\n          </Button>\n        </div>\n        <Separator />\n        <div className=\"space-y-2\">\n          <div className=\"text-sm\">\n            <p className=\"font-medium\">New comment</p>\n            <p className=\"text-muted-foreground text-xs\">2 minutes ago</p>\n          </div>\n          <div className=\"text-sm\">\n            <p className=\"font-medium\">New follower</p>\n            <p className=\"text-muted-foreground text-xs\">1 hour ago</p>\n          </div>\n          <div className=\"text-sm\">\n            <p className=\"font-medium\">Update available</p>\n            <p className=\"text-muted-foreground text-xs\">3 hours ago</p>\n          </div>\n        </div>\n      </div>\n    </PopoverContent>\n  </Popover>\n);\n\nexport default Example;\n","path":null,"size_bytes":1673,"size_tokens":null},"shared/component/collapsible_collapsible-sidebar-2.tsx":{"content":"import { Bell, ChevronDown, Lock, Settings, User } from \"lucide-react\";\n\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from \"@/components/ui/collapsible\";\n\nexport const title = \"Settings Menu\";\n\nconst Example = () => (\n  <div className=\"w-full max-w-lg rounded-lg border bg-card\">\n    <Collapsible>\n      <CollapsibleTrigger className=\"flex w-full items-center justify-between p-3 font-medium text-sm hover:bg-muted\">\n        <div className=\"flex items-center gap-2\">\n          <Settings className=\"h-4 w-4\" />\n          <span>Preferences</span>\n        </div>\n        <ChevronDown className=\"h-4 w-4\" />\n      </CollapsibleTrigger>\n      <CollapsibleContent className=\"border-t bg-muted/50\">\n        <div className=\"space-y-1 p-2\">\n          <div className=\"flex items-center gap-2 rounded-md px-2 py-2 text-sm hover:bg-background\">\n            <User className=\"h-4 w-4\" />\n            <span>Profile</span>\n          </div>\n          <div className=\"flex items-center gap-2 rounded-md px-2 py-2 text-sm hover:bg-background\">\n            <Bell className=\"h-4 w-4\" />\n            <span>Notifications</span>\n          </div>\n          <div className=\"flex items-center gap-2 rounded-md px-2 py-2 text-sm hover:bg-background\">\n            <Lock className=\"h-4 w-4\" />\n            <span>Privacy</span>\n          </div>\n        </div>\n      </CollapsibleContent>\n    </Collapsible>\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":1438,"size_tokens":null},"shared/component/input_input-special-3.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\n\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Range Slider with Value\";\n\nconst Example = () => {\n  const [value, setValue] = useState(50);\n\n  return (\n    <div className=\"w-full max-w-sm space-y-2\">\n      <div className=\"flex items-center justify-between\">\n        <Label htmlFor=\"range-slider\">Volume</Label>\n        <span className=\"font-medium text-sm\">{value}%</span>\n      </div>\n      <Input\n        className=\"cursor-pointer bg-background\"\n        id=\"range-slider\"\n        max=\"100\"\n        min=\"0\"\n        onChange={(e) => setValue(Number(e.target.value))}\n        type=\"range\"\n        value={value}\n      />\n      <div className=\"flex justify-between text-muted-foreground text-xs\">\n        <span>0%</span>\n        <span>100%</span>\n      </div>\n    </div>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":921,"size_tokens":null},"shared/component/button-group_button-group-media-2.tsx":{"content":"\"use client\";\n\nimport { Volume2Icon, VolumeIcon, VolumeXIcon } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { ButtonGroup } from \"@/components/ui/button-group\";\n\nexport const title = \"Volume Controls\";\n\nconst Example = () => {\n  const [isMuted, setIsMuted] = useState(false);\n  const [volume, setVolume] = useState(50);\n\n  const decreaseVolume = () => {\n    const newVolume = Math.max(0, volume - 10);\n    setVolume(newVolume);\n    if (newVolume === 0) {\n      setIsMuted(true);\n    }\n  };\n\n  const increaseVolume = () => {\n    const newVolume = Math.min(100, volume + 10);\n    setVolume(newVolume);\n    if (isMuted) {\n      setIsMuted(false);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col gap-4\">\n      <ButtonGroup>\n        <Button\n          onClick={() => setIsMuted(!isMuted)}\n          size=\"sm\"\n          variant=\"outline\"\n        >\n          {isMuted ? <VolumeXIcon /> : <Volume2Icon />}\n        </Button>\n        <Button onClick={decreaseVolume} size=\"sm\" variant=\"outline\">\n          <VolumeIcon />\n        </Button>\n        <Button onClick={increaseVolume} size=\"sm\" variant=\"outline\">\n          <Volume2Icon />\n        </Button>\n      </ButtonGroup>\n      <ButtonGroup>\n        <Button onClick={decreaseVolume} size=\"sm\" variant=\"outline\">\n          -\n        </Button>\n        <Button size=\"sm\" variant=\"outline\">\n          {isMuted ? \"Muted\" : `${volume}%`}\n        </Button>\n        <Button onClick={increaseVolume} size=\"sm\" variant=\"outline\">\n          +\n        </Button>\n      </ButtonGroup>\n    </div>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":1632,"size_tokens":null},"shared/plan/plan.md":{"content":"# Per-layer alpha cutoff plan\n\nGoal: expose a JSON-configurable alpha cutoff (alphaTest) per layer so black backgrounds in additive glows can be trimmed without code edits.\n\nSteps for a future agent:\n1) Model/typing: In `shared/layer/model.ts`, add `AlphaCutoff?: number` to `LayerConfigEntry`, and add `alphaCutoff?: number` to `UniversalLayerData`/`EnhancedLayerData`.\n2) Prepare layer: In `prepareBasicState` (in `shared/layer/engine.ts`), read `entry.AlphaCutoff`, clamp to [0,1], default to current hardcoded value (0.01), and store as `alphaCutoff` on `baseData`.\n3) Three renderers: In `shared/layer/StageThree.tsx` and `yuzha/src/counter/counterScreen.tsx`, set `alphaTest` to `data.alphaCutoff ?? 0.01` when creating `MeshBasicMaterial`. Keep `alphaMap: texture` so luminance drives alpha for assets without an alpha channel.\n4) Config usage: Then JSON entries can set \"AlphaCutoff\": 0.08 (example) per layer. Higher values remove more dark tones; too high will clip faint lines. Works with BlendMode: \"additive\".\n5) Optional: add validation (warn if out of range) and, if desired, allow a global default via env/config.\n\nCurrent context: The repo already uses BlendMode (additive/normal) and sets `alphaMap: texture` + `alphaTest: 0.01` globally. This plan makes alphaTest adjustable per layer.\n","path":null,"size_bytes":1305,"size_tokens":null},"shared/component/input_input-special-1.tsx":{"content":"\"use client\";\n\nimport { FileText, X } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"File Upload with List\";\n\nconst Example = () => {\n  const [files, setFiles] = useState<File[]>([]);\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files) {\n      setFiles(Array.from(e.target.files));\n    }\n  };\n\n  const removeFile = (index: number) => {\n    setFiles(files.filter((_, i) => i !== index));\n  };\n\n  return (\n    <div className=\"w-full max-w-sm space-y-2\">\n      <Label htmlFor=\"file-upload\">Upload Files</Label>\n      <Input\n        className=\"bg-background\"\n        id=\"file-upload\"\n        multiple\n        onChange={handleFileChange}\n        type=\"file\"\n      />\n      {files.length > 0 && (\n        <div className=\"space-y-2\">\n          {files.map((file, index) => (\n            <div\n              className=\"flex items-center justify-between rounded-md border p-2\"\n              key={index}\n            >\n              <div className=\"flex items-center gap-2\">\n                <FileText className=\"h-4 w-4 text-muted-foreground\" />\n                <span className=\"text-sm\">{file.name}</span>\n                <span className=\"text-muted-foreground text-xs\">\n                  ({(file.size / 1024).toFixed(1)} KB)\n                </span>\n              </div>\n              <Button\n                className=\"h-6 w-6\"\n                onClick={() => removeFile(index)}\n                size=\"icon\"\n                type=\"button\"\n                variant=\"ghost\"\n              >\n                <X className=\"h-3 w-3\" />\n              </Button>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":1861,"size_tokens":null},"shared/component/dialog_dialog-standard-14.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Checkout\";\n\nconst Example = () => {\n  const [billingCycle, setBillingCycle] = useState<\"monthly\" | \"yearly\">(\n    \"monthly\"\n  );\n\n  return (\n    <Dialog>\n      <DialogTrigger asChild>\n        <Button variant=\"outline\">Checkout</Button>\n      </DialogTrigger>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <DialogTitle>Complete your purchase</DialogTitle>\n          <DialogDescription>\n            Choose your billing cycle and enter payment details.\n          </DialogDescription>\n        </DialogHeader>\n        <div className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label>Billing cycle</Label>\n            <div className=\"grid grid-cols-2 gap-2\">\n              <button\n                className={cn(\n                  \"flex flex-col items-center justify-center rounded-lg border-2 p-4 transition-colors\",\n                  billingCycle === \"monthly\"\n                    ? \"border-primary bg-primary/5\"\n                    : \"border-input hover:border-primary/50\"\n                )}\n                onClick={() => setBillingCycle(\"monthly\")}\n                type=\"button\"\n              >\n                <span className=\"font-semibold\">Monthly</span>\n                <span className=\"text-muted-foreground text-sm\">$29/mo</span>\n              </button>\n              <button\n                className={cn(\n                  \"flex flex-col items-center justify-center rounded-lg border-2 p-4 transition-colors\",\n                  billingCycle === \"yearly\"\n                    ? \"border-primary bg-primary/5\"\n                    : \"border-input hover:border-primary/50\"\n                )}\n                onClick={() => setBillingCycle(\"yearly\")}\n                type=\"button\"\n              >\n                <span className=\"font-semibold\">Yearly</span>\n                <span className=\"text-muted-foreground text-sm\">$290/yr</span>\n                <span className=\"text-green-600 text-xs\">Save 17%</span>\n              </button>\n            </div>\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"cardName\">Cardholder name</Label>\n            <Input id=\"cardName\" placeholder=\"John Doe\" />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"cardNumber\">Card number</Label>\n            <Input id=\"cardNumber\" placeholder=\"1234 5678 9012 3456\" />\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"expiry\">Expiry date</Label>\n              <Input id=\"expiry\" placeholder=\"MM/YY\" />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"cvc\">CVC</Label>\n              <Input id=\"cvc\" placeholder=\"123\" />\n            </div>\n          </div>\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox id=\"default\" />\n            <Label className=\"font-normal text-sm\" htmlFor=\"default\">\n              Set as default payment method\n            </Label>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button type=\"button\" variant=\"outline\">\n            Cancel\n          </Button>\n          <Button type=\"button\">\n            Complete Purchase - ${billingCycle === \"monthly\" ? \"29\" : \"290\"}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":3840,"size_tokens":null},"meng/src/components/Hero.tsx":{"content":"/**\n * Hero Component\n *\n * Purpose: Main banner/hero section with full-width image and call-to-action\n *\n * Features:\n * - Full-screen hero image with overlay\n * - Centered text content\n * - Call-to-action button\n * - Responsive design\n *\n * For Future AI Agents:\n * - Hero image sourced from vision_expert_agent\n * - Gradient overlay for text readability\n * - Adjust min-height for different screen sizes\n * - CTA button scrolls to menu section\n */\n\nconst Hero = () => {\n  const heroImage = 'https://images.unsplash.com/photo-1643856557143-09189e523fd6'\n\n  return (\n    <section id=\"home\" className=\"relative min-h-screen flex items-center justify-center\">\n      {/* Background Image */}\n      <div\n        className=\"absolute inset-0 z-0\"\n        style={{\n          backgroundImage: `url(${heroImage})`,\n          backgroundSize: 'cover',\n          backgroundPosition: 'center',\n          backgroundRepeat: 'no-repeat',\n        }}\n      >\n        {/* Overlay for better text readability */}\n        <div className=\"absolute inset-0 bg-black/40\" />\n      </div>\n\n      {/* Content */}\n      <div className=\"relative z-10 text-center px-4 sm:px-6 lg:px-8 max-w-4xl mx-auto\">\n        <h1 className=\"text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-display font-bold text-white mb-6 animate-fade-in\">\n          The Plantation Cafe & Resto\n        </h1>\n        <p className=\"text-xl sm:text-2xl md:text-3xl text-white/90 mb-8 font-light animate-slide-up\">\n          Garden Concept Restaurant with Mountain Views\n        </p>\n        <p className=\"text-lg sm:text-xl text-white/80 mb-10 max-w-2xl mx-auto\">\n          Experience fresh mountain air while enjoying delicious cuisine in our serene garden\n          setting\n        </p>\n        <a\n          href=\"#menu\"\n          className=\"inline-block bg-primary-600 hover:bg-primary-700 text-white font-semibold px-8 py-4 rounded-full text-lg transition-all duration-300 transform hover:scale-105 shadow-lg\"\n        >\n          View Menu\n        </a>\n      </div>\n    </section>\n  )\n}\n\nexport default Hero\n","path":null,"size_bytes":2054,"size_tokens":null},"shared/component/input_input-types-3.tsx":{"content":"\"use client\";\n\nimport { Minus, Plus } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Number Input with Controls\";\n\nconst Example = () => {\n  const [value, setValue] = useState(1);\n\n  return (\n    <div className=\"w-full max-w-sm space-y-2\">\n      <Label htmlFor=\"quantity\">Quantity</Label>\n      <div className=\"flex gap-2\">\n        <Button\n          onClick={() => setValue(Math.max(1, value - 1))}\n          size=\"icon\"\n          type=\"button\"\n          variant=\"outline\"\n        >\n          <Minus className=\"h-4 w-4\" />\n        </Button>\n        <Input\n          className=\"bg-background text-center\"\n          id=\"quantity\"\n          min=\"1\"\n          onChange={(e) => setValue(Number(e.target.value))}\n          type=\"number\"\n          value={value}\n        />\n        <Button\n          onClick={() => setValue(value + 1)}\n          size=\"icon\"\n          type=\"button\"\n          variant=\"outline\"\n        >\n          <Plus className=\"h-4 w-4\" />\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":1201,"size_tokens":null},"meng/src/components/About.tsx":{"content":"/**\n * About Component\n *\n * Purpose: About Us section (Tentang Kami) describing the restaurant\n *\n * Features:\n * - Two-column layout (image + text)\n * - Responsive design\n * - Key features list\n * - Learn more button\n *\n * For Future AI Agents:\n * - Text content matches original website (Indonesian)\n * - Image from vision_expert_agent (mountain view restaurant)\n * - Grid layout: image left, text right on desktop\n * - Stacks vertically on mobile\n */\n\nimport { IconMapPin, IconMountain, IconWaves } from '../icons'\n\nconst About = () => {\n  const aboutImage = 'https://images.unsplash.com/photo-1653192916062-9b29d31896b4'\n\n  return (\n    <section id=\"about\" className=\"py-20 bg-white\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center\">\n          {/* Image */}\n          <div className=\"order-2 lg:order-1\">\n            <img\n              src={aboutImage}\n              alt=\"Plantation Cafe mountain view\"\n              className=\"rounded-2xl shadow-2xl w-full h-[400px] lg:h-[500px] object-cover\"\n            />\n          </div>\n\n          {/* Text Content */}\n          <div className=\"order-1 lg:order-2\">\n            <h2 className=\"text-4xl md:text-5xl font-display font-bold text-gray-900 mb-6\">\n              Tentang Kami\n            </h2>\n            <p className=\"text-lg text-gray-700 mb-6 leading-relaxed\">\n              The Plantation Cafe & Resto adalah Tempat Makan dan Hang Out yang berkonsep Garden\n              yang berada di dataran tinggi dengan pemandangan alam pegunungan dan View Kota\n              Bandung.\n            </p>\n            <p className=\"text-lg text-gray-700 mb-8 leading-relaxed\">\n              Tempat yang Sejuk dan nyaman untuk para Tamu yang ingin mencari udara segar sambil\n              menikmati hidangan yang lezat dari kami.\n            </p>\n            <p className=\"text-lg text-gray-700 mb-8 leading-relaxed\">\n              Kini The Plantation Cafe hadir dengan suasana baru yaitu adanya Swimming Pool dengan\n              View Kota Bandung dan Cimahi.\n            </p>\n\n            {/* Features */}\n            <div className=\"space-y-4 mb-8\">\n              <div className=\"flex items-start space-x-3\">\n                <IconMountain className=\"w-6 h-6 text-primary-600 flex-shrink-0 mt-1\" />\n                <div>\n                  <h3 className=\"font-semibold text-gray-900\">Mountain View</h3>\n                  <p className=\"text-gray-600\">Breathtaking views of Bandung mountains</p>\n                </div>\n              </div>\n              <div className=\"flex items-start space-x-3\">\n                <IconWaves className=\"w-6 h-6 text-primary-600 flex-shrink-0 mt-1\" />\n                <div>\n                  <h3 className=\"font-semibold text-gray-900\">Swimming Pool</h3>\n                  <p className=\"text-gray-600\">Relax by the pool with city views</p>\n                </div>\n              </div>\n              <div className=\"flex items-start space-x-3\">\n                <IconMapPin className=\"w-6 h-6 text-primary-600 flex-shrink-0 mt-1\" />\n                <div>\n                  <h3 className=\"font-semibold text-gray-900\">Garden Concept</h3>\n                  <p className=\"text-gray-600\">Natural garden setting with fresh air</p>\n                </div>\n              </div>\n            </div>\n\n            <a\n              href=\"#contact\"\n              className=\"inline-block bg-primary-600 hover:bg-primary-700 text-white font-semibold px-6 py-3 rounded-lg transition-colors duration-200\"\n            >\n              Learn More\n            </a>\n          </div>\n        </div>\n      </div>\n    </section>\n  )\n}\n\nexport default About\n","path":null,"size_bytes":3694,"size_tokens":null},"shared/component/dropdown-menu_dropdown-menu-standard-6.tsx":{"content":"\"use client\";\n\nimport { FileText, Folder, ImageIcon, Music, Plus, Video } from \"lucide-react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nexport const title = \"Nested Dropdown\";\n\nconst Example = () => (\n  <DropdownMenu>\n    <DropdownMenuTrigger asChild>\n      <Button variant=\"outline\">\n        <Plus className=\"h-4 w-4\" />\n        New\n      </Button>\n    </DropdownMenuTrigger>\n    <DropdownMenuContent className=\"w-56\">\n      <DropdownMenuItem>\n        <FileText />\n        Document\n      </DropdownMenuItem>\n      <DropdownMenuItem>\n        <Folder />\n        Folder\n      </DropdownMenuItem>\n      <DropdownMenuSeparator />\n      <DropdownMenuSub>\n        <DropdownMenuSubTrigger className=\"px-2 py-1.5\">\n          <ImageIcon className=\"text-muted-foreground mr-2 size-4\" />\n          Media\n        </DropdownMenuSubTrigger>\n        <DropdownMenuSubContent>\n          <DropdownMenuItem>\n            <ImageIcon />\n            Image\n          </DropdownMenuItem>\n          <DropdownMenuItem>\n            <Video />\n            Video\n          </DropdownMenuItem>\n          <DropdownMenuItem>\n            <Music />\n            Audio\n          </DropdownMenuItem>\n        </DropdownMenuSubContent>\n      </DropdownMenuSub>\n      <DropdownMenuSub>\n        <DropdownMenuSubTrigger className=\"px-2 py-1.5\">\n          <FileText className=\"text-muted-foreground mr-2 size-4\" />\n          Document Type\n        </DropdownMenuSubTrigger>\n        <DropdownMenuSubContent>\n          <DropdownMenuItem>Text Document</DropdownMenuItem>\n          <DropdownMenuItem>Spreadsheet</DropdownMenuItem>\n          <DropdownMenuItem>Presentation</DropdownMenuItem>\n          <DropdownMenuItem>Form</DropdownMenuItem>\n        </DropdownMenuSubContent>\n      </DropdownMenuSub>\n    </DropdownMenuContent>\n  </DropdownMenu>\n);\n\nexport default Example;\n","path":null,"size_bytes":2062,"size_tokens":null},"shared/component/alert-dialog_alert-dialog-destructive-2.tsx":{"content":"import { Trash2 } from \"lucide-react\";\n\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport { Button } from \"@/components/ui/button\";\n\nexport const title = \"Delete Confirmation with Icon\";\n\nconst Example = () => (\n  <AlertDialog>\n    <AlertDialogTrigger asChild>\n      <Button variant=\"destructive\">Delete</Button>\n    </AlertDialogTrigger>\n    <AlertDialogContent>\n      <AlertDialogHeader>\n        <div className=\"flex items-center gap-2\">\n          <Trash2 className=\"size-5 text-destructive\" />\n          <AlertDialogTitle>Delete Project</AlertDialogTitle>\n        </div>\n        <AlertDialogDescription>\n          This will permanently delete the project and all of its contents. This\n          action cannot be undone.\n        </AlertDialogDescription>\n      </AlertDialogHeader>\n      <AlertDialogFooter>\n        <AlertDialogCancel>Cancel</AlertDialogCancel>\n        <AlertDialogAction className=\"bg-destructive text-white hover:bg-destructive/90\">\n          Delete Project\n        </AlertDialogAction>\n      </AlertDialogFooter>\n    </AlertDialogContent>\n  </AlertDialog>\n);\n\nexport default Example;\n","path":null,"size_bytes":1300,"size_tokens":null},"vitest.config.ts":{"content":"﻿import { defineConfig } from \"vitest/config\";\nexport default defineConfig({\n  test: {\n    globals: true,\n    environment: \"jsdom\",\n    coverage: {\n      provider: \"v8\",\n      reporter: [\"text\", \"html\"],\n      reportsDirectory: \"./coverage\",\n    },\n    include: [\"**/*.test.{ts,tsx}\"],\n  },\n});\n","path":null,"size_bytes":297,"size_tokens":null},"shared/component/input_input-standard-7.tsx":{"content":"\"use client\";\n\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Inline Label\";\n\nconst Example = () => (\n  <div className=\"flex w-full max-w-sm items-center gap-4\">\n    <Label className=\"w-24 text-right\" htmlFor=\"age\">\n      Age\n    </Label>\n    <Input\n      className=\"flex-1 bg-background\"\n      id=\"age\"\n      placeholder=\"25\"\n      type=\"number\"\n    />\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":461,"size_tokens":null},"meng/src/components/Navbar.tsx":{"content":"/**\n * Navbar Component\n *\n * Purpose: Top navigation bar with logo and menu links\n *\n * Features:\n * - Sticky navigation that stays at top when scrolling\n * - Smooth scroll to sections\n * - Responsive mobile menu (hamburger icon)\n * - Transparent background with backdrop blur\n *\n * For Future AI Agents:\n * - Uses local inline SVG icons (no external dependency)\n * - Smooth scroll handled by CSS (scroll-behavior: smooth in index.css)\n * - State management: useState for mobile menu toggle\n * - Sections: Home, About, Menu, Gallery, Contact\n */\n\nimport { useState } from 'react'\nimport { IconMenu, IconX } from '../icons'\n\nconst Navbar = () => {\n  const [isMenuOpen, setIsMenuOpen] = useState(false)\n\n  const navLinks = [\n    { label: 'Home', href: '#home' },\n    { label: 'About', href: '#about' },\n    { label: 'Menu', href: '#menu' },\n    { label: 'Gallery', href: '#gallery' },\n    { label: 'Contact', href: '#contact' },\n  ]\n\n  return (\n    <nav className=\"fixed top-0 left-0 right-0 z-50 bg-white/90 backdrop-blur-md shadow-sm\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <div className=\"flex justify-between items-center h-20\">\n          {/* Logo */}\n          <div className=\"flex-shrink-0\">\n            <a href=\"#home\" className=\"text-2xl font-display font-bold text-primary-700\">\n              Plantation Cafe\n            </a>\n          </div>\n\n          {/* Desktop Navigation */}\n          <div className=\"hidden md:flex space-x-8\">\n            {navLinks.map((link) => (\n              <a\n                key={link.href}\n                href={link.href}\n                className=\"text-gray-700 hover:text-primary-600 px-3 py-2 text-sm font-medium transition-colors duration-200\"\n              >\n                {link.label}\n              </a>\n            ))}\n          </div>\n\n          {/* Mobile menu button */}\n          <div className=\"md:hidden\">\n            <button\n              onClick={() => setIsMenuOpen(!isMenuOpen)}\n              className=\"text-gray-700 hover:text-primary-600 p-2\"\n              aria-label=\"Toggle menu\"\n            >\n              {isMenuOpen ? <IconX className=\"w-6 h-6\" /> : <IconMenu className=\"w-6 h-6\" />}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Mobile Navigation */}\n      {isMenuOpen && (\n        <div className=\"md:hidden bg-white border-t\">\n          <div className=\"px-2 pt-2 pb-3 space-y-1\">\n            {navLinks.map((link) => (\n              <a\n                key={link.href}\n                href={link.href}\n                className=\"block px-3 py-2 text-base font-medium text-gray-700 hover:text-primary-600 hover:bg-gray-50 rounded-md\"\n                onClick={() => setIsMenuOpen(false)}\n              >\n                {link.label}\n              </a>\n            ))}\n          </div>\n        </div>\n      )}\n    </nav>\n  )\n}\n\nexport default Navbar\n","path":null,"size_bytes":2880,"size_tokens":null},"tailwind.config.ts":{"content":"// Tailwind configuration for shared components\n// Optimized content scanning for monorepo structure\n\nimport forms from \"@tailwindcss/forms\";\nimport typography from \"@tailwindcss/typography\";\nimport lineClamp from \"@tailwindcss/line-clamp\";\nimport aspectRatio from \"@tailwindcss/aspect-ratio\";\n\n/** @type {import('tailwindcss').Config} */\nexport default {\n  content: [\"./yuzha/**/*.{html,ts,tsx}\", \"./shared/**/*.{html,ts,tsx}\"],\n  darkMode: \"class\",\n  theme: {\n    extend: {\n      keyframes: {\n        slideDown: {\n          from: { height: \"0\", opacity: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\", opacity: \"1\" },\n        },\n        slideUp: {\n          from: { height: \"var(--radix-accordion-content-height)\", opacity: \"1\" },\n          to: { height: \"0\", opacity: \"0\" },\n        },\n      },\n      animation: {\n        slideDown: \"slideDown 300ms cubic-bezier(0.87, 0, 0.13, 1)\",\n        slideUp: \"slideUp 300ms cubic-bezier(0.87, 0, 0.13, 1)\",\n      },\n    },\n  },\n  plugins: [forms, typography, lineClamp, aspectRatio],\n};\n","path":null,"size_bytes":1055,"size_tokens":null},"shared/component/tabs_tabs-layout-1.tsx":{"content":"import { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\n\nexport const title = \"Vertical Tabs\";\n\nconst Example = () => (\n  <Tabs className=\"flex w-full max-w-2xl flex-row gap-6\" defaultValue=\"profile\">\n    <TabsList className=\"flex h-auto flex-col\">\n      <TabsTrigger className=\"w-full justify-start\" value=\"profile\">\n        Profile\n      </TabsTrigger>\n      <TabsTrigger className=\"w-full justify-start\" value=\"security\">\n        Security\n      </TabsTrigger>\n      <TabsTrigger className=\"w-full justify-start\" value=\"preferences\">\n        Preferences\n      </TabsTrigger>\n      <TabsTrigger className=\"w-full justify-start\" value=\"team\">\n        Team\n      </TabsTrigger>\n    </TabsList>\n    <div className=\"flex-1\">\n      <TabsContent value=\"profile\">\n        <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n          <h3 className=\"mb-2 font-semibold text-lg\">Profile Settings</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            Update your profile information including your name, email, and\n            profile picture. These details will be visible to other users.\n          </p>\n        </div>\n      </TabsContent>\n      <TabsContent value=\"security\">\n        <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n          <h3 className=\"mb-2 font-semibold text-lg\">Security Settings</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            Manage your password, two-factor authentication, and active sessions\n            to keep your account secure.\n          </p>\n        </div>\n      </TabsContent>\n      <TabsContent value=\"preferences\">\n        <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n          <h3 className=\"mb-2 font-semibold text-lg\">Preferences</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            Customize your experience with theme options, language settings, and\n            notification preferences.\n          </p>\n        </div>\n      </TabsContent>\n      <TabsContent value=\"team\">\n        <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n          <h3 className=\"mb-2 font-semibold text-lg\">Team Settings</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            Invite team members, manage permissions, and configure team-wide\n            settings and integrations.\n          </p>\n        </div>\n      </TabsContent>\n    </div>\n  </Tabs>\n);\n\nexport default Example;\n","path":null,"size_bytes":2519,"size_tokens":null},"shared/component/combobox_combobox-grouped-5.tsx":{"content":"\"use client\";\n\nimport { Check, ChevronDown, ChevronRight, ChevronsUpDown } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\n\nexport const title = \"Collapsible Groups\";\n\nconst departments = {\n  Engineering: [\n    { value: \"software\", label: \"Software\" },\n    { value: \"hardware\", label: \"Hardware\" },\n    { value: \"qa\", label: \"QA\" },\n  ],\n  Marketing: [\n    { value: \"content\", label: \"Content\" },\n    { value: \"social\", label: \"Social Media\" },\n    { value: \"seo\", label: \"SEO\" },\n  ],\n};\n\nconst Example = () => {\n  const [open, setOpen] = useState(false);\n  const [value, setValue] = useState(\"\");\n  const [collapsed, setCollapsed] = useState<Record<string, boolean>>({\n    Marketing: true,\n  });\n\n  return (\n    <Popover onOpenChange={setOpen} open={open}>\n      <PopoverTrigger asChild>\n        <Button\n          aria-expanded={open}\n          className=\"w-[250px] justify-between\"\n          role=\"combobox\"\n          variant=\"outline\"\n        >\n          {value\n            ? Object.values(departments)\n                .flat()\n                .find((item) => item.value === value)?.label\n            : \"Select department...\"}\n          <ChevronsUpDown className=\"ml-2 size-4 shrink-0 opacity-50\" />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-[250px] p-0\">\n        <Command>\n          <CommandInput placeholder=\"Search...\" />\n          <CommandList>\n            <CommandEmpty>No department found.</CommandEmpty>\n            {Object.entries(departments).map(([category, items]) => {\n              const isCollapsed = collapsed[category];\n              return (\n                <CommandGroup\n                  heading={\n                    <button\n                      className=\"flex w-full items-center gap-1\"\n                      onClick={() =>\n                        setCollapsed((prev) => ({\n                          ...prev,\n                          [category]: !prev[category],\n                        }))\n                      }\n                    >\n                      {isCollapsed ? (\n                        <ChevronRight className=\"size-3\" />\n                      ) : (\n                        <ChevronDown className=\"size-3\" />\n                      )}\n                      {category}\n                    </button>\n                  }\n                  key={category}\n                >\n                  {!isCollapsed &&\n                    items.map((item) => (\n                      <CommandItem\n                        key={item.value}\n                        onSelect={(currentValue) => {\n                          setValue(currentValue === value ? \"\" : currentValue);\n                          setOpen(false);\n                        }}\n                        value={item.value}\n                      >\n                        <Check\n                          className={cn(\n                            \"mr-2 size-4\",\n                            value === item.value ? \"opacity-100\" : \"opacity-0\"\n                          )}\n                        />\n                        {item.label}\n                      </CommandItem>\n                    ))}\n                </CommandGroup>\n              );\n            })}\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":3610,"size_tokens":null},"shared/component/tabs_tabs-content-1.tsx":{"content":"\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Textarea } from \"@/components/ui/textarea\";\n\nexport const title = \"Tabs with Forms\";\n\nconst Example = () => (\n  <Tabs className=\"w-full max-w-md\" defaultValue=\"login\">\n    <TabsList className=\"grid w-full grid-cols-2\">\n      <TabsTrigger value=\"login\">Login</TabsTrigger>\n      <TabsTrigger value=\"register\">Register</TabsTrigger>\n    </TabsList>\n    <TabsContent value=\"login\">\n      <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n        <div className=\"mb-4\">\n          <h3 className=\"font-semibold text-lg\">Login</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            Enter your credentials to access your account.\n          </p>\n        </div>\n        <form className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"login-email\">Email</Label>\n            <Input\n              id=\"login-email\"\n              placeholder=\"name@example.com\"\n              type=\"email\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"login-password\">Password</Label>\n            <Input id=\"login-password\" type=\"password\" />\n          </div>\n          <Button className=\"w-full\" type=\"submit\">\n            Sign In\n          </Button>\n        </form>\n      </div>\n    </TabsContent>\n    <TabsContent value=\"register\">\n      <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n        <div className=\"mb-4\">\n          <h3 className=\"font-semibold text-lg\">Create Account</h3>\n          <p className=\"text-muted-foreground text-sm\">\n            Fill in the details below to create your account.\n          </p>\n        </div>\n        <form className=\"space-y-4\">\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"register-name\">Full Name</Label>\n            <Input id=\"register-name\" placeholder=\"John Doe\" />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"register-email\">Email</Label>\n            <Input\n              id=\"register-email\"\n              placeholder=\"name@example.com\"\n              type=\"email\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"register-password\">Password</Label>\n            <Input id=\"register-password\" type=\"password\" />\n          </div>\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"register-bio\">Bio</Label>\n            <Textarea\n              id=\"register-bio\"\n              placeholder=\"Tell us about yourself...\"\n            />\n          </div>\n          <Button className=\"w-full\" type=\"submit\">\n            Create Account\n          </Button>\n        </form>\n      </div>\n    </TabsContent>\n  </Tabs>\n);\n\nexport default Example;\n","path":null,"size_bytes":2979,"size_tokens":null},"yuzha/env.d.ts":{"content":"/// <reference types=\"vite/client\" />\n\ninterface ImportMetaEnv {\n  readonly VITE_API_BASE_URL?: string;\n}\n\ninterface ImportMeta {\n  readonly env: ImportMetaEnv;\n}\n","path":null,"size_bytes":163,"size_tokens":null},"shared/component/alert-dialog_alert-dialog-success-2.tsx":{"content":"import { CheckCircle2 } from \"lucide-react\";\n\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport { Button } from \"@/components/ui/button\";\n\nexport const title = \"Success with Icon\";\n\nconst Example = () => (\n  <AlertDialog>\n    <AlertDialogTrigger asChild>\n      <Button>Complete Action</Button>\n    </AlertDialogTrigger>\n    <AlertDialogContent>\n      <AlertDialogHeader>\n        <div className=\"flex items-center gap-2\">\n          <CheckCircle2 className=\"size-5 text-green-500\" />\n          <AlertDialogTitle>Payment Successful</AlertDialogTitle>\n        </div>\n        <AlertDialogDescription>\n          Your payment of $99.00 has been processed successfully. A receipt has\n          been sent to your email.\n        </AlertDialogDescription>\n      </AlertDialogHeader>\n      <AlertDialogFooter>\n        <AlertDialogAction>Done</AlertDialogAction>\n      </AlertDialogFooter>\n    </AlertDialogContent>\n  </AlertDialog>\n);\n\nexport default Example;\n","path":null,"size_bytes":1121,"size_tokens":null},"shared/component/date-picker_date-picker-standard-5.tsx":{"content":"\"use client\";\n\nimport { format } from \"date-fns\";\nimport { CalendarIcon } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\n\nexport const title = \"Date Picker with Natural Language\";\n\nconst Example = () => {\n  const [date, setDate] = useState<Date | undefined>(new Date());\n\n  const shortcuts = [\n    { label: \"Today\", date: new Date() },\n    {\n      label: \"Tomorrow\",\n      date: new Date(new Date().setDate(new Date().getDate() + 1)),\n    },\n    {\n      label: \"In 3 days\",\n      date: new Date(new Date().setDate(new Date().getDate() + 3)),\n    },\n    {\n      label: \"In a week\",\n      date: new Date(new Date().setDate(new Date().getDate() + 7)),\n    },\n    {\n      label: \"In 2 weeks\",\n      date: new Date(new Date().setDate(new Date().getDate() + 14)),\n    },\n    {\n      label: \"In a month\",\n      date: new Date(new Date().setMonth(new Date().getMonth() + 1)),\n    },\n  ];\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button\n          className={cn(\n            \"w-[280px] justify-start text-left font-normal\",\n            !date && \"text-muted-foreground\"\n          )}\n          variant=\"outline\"\n        >\n          <CalendarIcon className=\"mr-2 h-4 w-4\" />\n          {date ? format(date, \"PPP\") : <span>Pick a date</span>}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent align=\"start\" className=\"w-auto p-0\">\n        <div className=\"flex divide-x overflow-hidden bg-background\">\n          <Calendar mode=\"single\" onSelect={setDate} selected={date} />\n          <div className=\"relative w-[249px] overflow-hidden\">\n            <div className=\"absolute inset-0 grid gap-4\">\n              <div className=\"space-y-2 px-4 pt-4\">\n                <p className=\"text-center font-medium text-sm\">Quick Select</p>\n              </div>\n              <ScrollArea className=\"h-full overflow-y-auto\">\n                <div className=\"grid grid-cols-1 gap-2 px-4 pb-4\">\n                  {shortcuts.map((shortcut) => (\n                    <Button\n                      key={shortcut.label}\n                      onClick={() => setDate(new Date(shortcut.date))}\n                      size=\"sm\"\n                      variant=\"outline\"\n                    >\n                      {shortcut.label}\n                    </Button>\n                  ))}\n                </div>\n              </ScrollArea>\n            </div>\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":2744,"size_tokens":null},"shared/layer/StageThree.tsx":{"content":"/**\n * ============================================================================\n * STAGE THREE.JS WEBGL RENDERER\n * ============================================================================\n *\n * This is a COMPLETE SELF-CONTAINED RENDERER that uses Three.js WebGL\n * to render the stage. It's one of two rendering engines:\n * - StageCanvas.tsx - Uses Canvas 2D API\n * - StageThree.tsx (this file) - Uses Three.js WebGL\n *\n * ARCHITECTURE FOR FUTURE AI AGENTS:\n * -----------------------------------\n * 1. React component mounts and calls createStagePipeline() from StageSystem\n * 2. Pipeline contains all prepared layers with positions, scales, processors\n * 3. mountThreeRenderer() sets up WebGL renderer, camera, scene, and transformer\n * 4. mountThreeLayers() creates Three.js meshes for each layer\n * 5. Animation loop runs processors and updates mesh transforms each frame\n *\n * WHY THREE.JS RENDERER:\n * - Best performance for many layers and complex scenes\n * - Hardware-accelerated WebGL rendering\n * - Advanced visual effects (shaders, post-processing, etc.)\n * - 3D capabilities (when needed in future)\n *\n * WHEN TO USE:\n * - Maximum performance needed\n * - Many animated layers (>100)\n * - Complex visual effects\n * - Modern browsers with WebGL support\n *\n * @module StageThree\n */\n\nimport React, { useEffect, useRef } from \"react\";\nimport * as THREE from \"three\";\nimport {\n  createStagePipeline,\n  toRendererInput,\n  createStageTransformer,\n  roundStagePoint,\n  type StagePipeline,\n  type LayerMetadata,\n  type EnhancedLayerData,\n  type LayerProcessor,\n  type LayerBounds,\n  computeLayerBounds,\n  isLayerWithinStageBounds,\n} from \"./StageSystem\";\nimport { runPipeline, createPipelineCache } from \"./engine\";\nimport { AnimationConstants } from \"./math\";\nimport { getDeviceCapability } from \"../utils/DeviceCapability\";\n\nconst IS_DEV = import.meta.env?.DEV ?? false;\n\n// ============================================================================\n// THREE.JS LAYER RENDERING ENGINE\n// ============================================================================\n// This section contains the actual Three.js WebGL rendering logic. It creates\n// meshes for each layer and renders them using the WebGL API.\n// ============================================================================\n\n/**\n * Pre-calculated transform values for efficient Three.js rendering.\n * These values are computed once per layer and reused every frame.\n *\n * FOR FUTURE AI AGENTS: imageCenter was removed from cache.\n * Use getImageCenter(imageMapping) to calculate on-demand.\n */\ntype ThreeTransformCache = {\n  /** Plane width after scaling */\n  scaledWidth: number;\n  /** Plane height after scaling */\n  scaledHeight: number;\n  /** Whether this layer has rotation */\n  hasRotation: boolean;\n};\n\n/**\n * Internal representation of a Three.js layer.\n * Contains the mesh, group, and data needed for rendering.\n */\ntype ThreeMeshEntry = {\n  /** Plane mesh displaying the layer texture */\n  mesh: THREE.Mesh;\n  /** Group containing the mesh (used for transforms) */\n  group: THREE.Group;\n  /** Optional orbit path visualization line */\n  orbitLine?: THREE.Line;\n  /** Base layer data (unchanging) */\n  baseData: EnhancedLayerData;\n  /** Processors that animate this layer */\n  processors: LayerProcessor[];\n  /** Pre-calculated transform values for performance */\n  transformCache: ThreeTransformCache;\n  /** Whether this layer has no animation */\n  isStatic: boolean;\n  /** Whether this layer has animation */\n  hasAnimation: boolean;\n  /** Precomputed bounds for the base layer */\n  baseBounds: LayerBounds;\n  /** Geometry cache key for pooling */\n  geometryKey: string;\n};\n\ntype PlaneGeometryEntry = {\n  geometry: THREE.PlaneGeometry;\n  refCount: number;\n};\n\nconst planeGeometryCache = new Map<string, PlaneGeometryEntry>();\nconst ORBIT_LINE_SEGMENTS = 64;\nconst orbitLineGeometryCache = new Map<number, THREE.BufferGeometry>();\n\nconst planeGeometryKey = (width: number, height: number): string =>\n  `${width.toFixed(3)}x${height.toFixed(3)}`;\n\nconst acquirePlaneGeometry = (\n  width: number,\n  height: number,\n): { geometry: THREE.PlaneGeometry; key: string } => {\n  const key = planeGeometryKey(width, height);\n  const cached = planeGeometryCache.get(key);\n  if (cached) {\n    cached.refCount += 1;\n    return { geometry: cached.geometry, key };\n  }\n  const geometry = new THREE.PlaneGeometry(width, height);\n  planeGeometryCache.set(key, { geometry, refCount: 1 });\n  return { geometry, key };\n};\n\nconst releasePlaneGeometry = (key: string): void => {\n  const cached = planeGeometryCache.get(key);\n  if (!cached) return;\n  cached.refCount -= 1;\n  if (cached.refCount <= 0) {\n    cached.geometry.dispose();\n    planeGeometryCache.delete(key);\n  }\n};\n\nconst getOrbitLineGeometry = (segments: number): THREE.BufferGeometry => {\n  const cached = orbitLineGeometryCache.get(segments);\n  if (cached) return cached;\n  const points: THREE.Vector3[] = [];\n  for (let i = 0; i <= segments; i += 1) {\n    const angle = (i / segments) * Math.PI * 2;\n    points.push(new THREE.Vector3(Math.cos(angle), Math.sin(angle), 0));\n  }\n  const geometry = new THREE.BufferGeometry().setFromPoints(points);\n  orbitLineGeometryCache.set(segments, geometry);\n  return geometry;\n};\n\n/**\n * Mounts Three.js layers and sets up rendering loop.\n *\n * RENDERING PROCESS:\n * 1. Load all textures in parallel\n * 2. Create plane geometry + material for each layer\n * 3. Create Three.js Group to hold mesh (for positioning/rotation)\n * 4. Convert stage coordinates (0-2048) to Three.js world space (centered at 0,0)\n * 5. Create orbit line visualization if needed\n * 6. Start requestAnimationFrame loop:\n *    - Run processors for each layer\n *    - Update group position/rotation\n *    - Update orbit line if present\n *    - Hook in optional diagnostics if reintroduced\n *    - Render scene to canvas\n *\n * COORDINATE SYSTEM CONVERSION:\n * - Stage: (0,0) = top-left, (2048,2048) = bottom-right\n * - Three.js: (0,0) = center, Y-axis flipped (positive = up)\n * - Conversion: x = stageX - 1024, y = 1024 - stageY\n *\n * PERFORMANCE OPTIMIZATIONS:\n * - Transform cache prevents repeated calculations\n * - Pipeline cache prevents re-running processors\n * - Sub-pixel precision preserved for smooth orbital animations\n * - Texture settings optimized for 2D rendering (no mipmaps, linear filtering)\n *\n * @param scene - Three.js scene to add meshes to\n * @param renderer - WebGL renderer instance\n * @param camera - Orthographic camera for 2D rendering\n * @param layersWithProcessors - Prepared layers from pipeline\n * @returns Cleanup function to stop animation and dispose resources\n */\nasync function mountThreeLayers(\n  scene: THREE.Scene,\n  renderer: THREE.WebGLRenderer,\n  camera: THREE.Camera,\n  layersWithProcessors: Array<{\n    data: EnhancedLayerData;\n    processors: LayerProcessor[];\n    metadata: LayerMetadata;\n  }>,\n  stageSize: number,\n): Promise<() => void> {\n  const meshData: ThreeMeshEntry[] = [];\n  const textureLoader = new THREE.TextureLoader();\n  const pipelineCache = createPipelineCache<EnhancedLayerData>();\n  const halfStage = stageSize / 2;\n  const computeRuntimeBounds = (data: EnhancedLayerData): LayerBounds =>\n    computeLayerBounds(data.position, data.scale, data.imageMapping);\n  const shouldRenderEntry = (entry: ThreeMeshEntry, enhanced: EnhancedLayerData): boolean => {\n    if (enhanced.visible === false) return false;\n    const padding = entry.hasAnimation ? 96 : 40;\n    return isLayerWithinStageBounds(computeRuntimeBounds(enhanced), stageSize, padding);\n  };\n\n  // Load all textures in parallel\n  const texturePromises = layersWithProcessors.map(async (item) => {\n    try {\n      const texture = await textureLoader.loadAsync(item.data.imageUrl);\n      // Configure texture for 2D rendering (no mipmaps, linear filtering)\n      texture.colorSpace = THREE.SRGBColorSpace;\n      texture.minFilter = THREE.LinearFilter;\n      texture.magFilter = THREE.LinearFilter;\n      texture.anisotropy = 1;\n      texture.generateMipmaps = false;\n      if (item.data.blendMode === \"additive\") {\n        texture.wrapS = THREE.ClampToEdgeWrapping;\n        texture.wrapT = THREE.ClampToEdgeWrapping;\n      }\n      return { item, texture };\n    } catch (error) {\n      if (IS_DEV) {\n        console.error(`[StageThree] Failed to load texture for \"${item.data.ImageID}\"`, error);\n      }\n      return null;\n    }\n  });\n\n  const results = await Promise.all(texturePromises);\n\n  // Create meshes for each loaded texture\n  for (const result of results) {\n    if (!result) continue;\n\n    const { item, texture } = result;\n    const { data, processors, metadata } = item;\n    const { isStatic, hasAnimation, baseBounds, visibleByDefault } = metadata;\n    const blendMode =\n      data.blendMode === \"additive\" ? THREE.AdditiveBlending : THREE.NormalBlending;\n    const opacity = data.opacity ?? 1;\n    const useLuminanceAlpha = data.blendMode === \"additive\";\n    const alphaTestValue = useLuminanceAlpha ? 0.1 : 0;\n\n    // Calculate scaled dimensions\n    const scaledWidth = texture.image.width * data.scale.x;\n    const scaledHeight = texture.image.height * data.scale.y;\n\n    const transformCache: ThreeTransformCache = {\n      scaledWidth,\n      scaledHeight,\n      hasRotation: (data.rotation ?? 0) !== 0,\n    };\n    const offscreenStatic =\n      isStatic && visibleByDefault && !isLayerWithinStageBounds(baseBounds, stageSize);\n    if (offscreenStatic) {\n      if (typeof texture.dispose === \"function\") {\n        texture.dispose();\n      }\n      continue;\n    }\n\n    // Create plane geometry and material\n    const { geometry: planeGeometry, key: geometryKey } = acquirePlaneGeometry(\n      scaledWidth,\n      scaledHeight,\n    );\n    const materialConfig: THREE.MeshBasicMaterialParameters = {\n      map: texture,\n      transparent: true,\n      side: THREE.DoubleSide,\n      depthWrite: false,\n      blending: blendMode,\n      opacity,\n    };\n    if (useLuminanceAlpha) {\n      materialConfig.alphaMap = texture;\n      materialConfig.alphaTest = alphaTestValue;\n    }\n    const planeMaterial = new THREE.MeshBasicMaterial(materialConfig);\n\n    const mesh = new THREE.Mesh(planeGeometry, planeMaterial);\n    const group = new THREE.Group();\n\n    // Convert stage coordinates to Three.js world space\n    const initialPosition = roundStagePoint(data.position);\n    group.position.set(initialPosition.x - halfStage, halfStage - initialPosition.y, 0);\n    group.add(mesh);\n    scene.add(group);\n\n    // Create orbit line visualization if needed\n    let orbitLine: THREE.Line | undefined;\n    const baseRadiusRounded = Math.max(0, Math.round(data.orbitRadius ?? 0));\n    if (data.orbitLineVisible && baseRadiusRounded > 0 && data.orbitStagePoint) {\n      const circleGeometry = getOrbitLineGeometry(ORBIT_LINE_SEGMENTS);\n      const circleMaterial = new THREE.LineBasicMaterial({\n        color: 0xffffff,\n        transparent: true,\n        opacity: 0.25,\n      });\n      orbitLine = new THREE.LineLoop(circleGeometry, circleMaterial);\n      orbitLine.userData = { baseRadius: Math.max(baseRadiusRounded, 1) };\n      const roundedStagePoint = roundStagePoint(data.orbitStagePoint);\n      orbitLine.position.set(roundedStagePoint.x - halfStage, halfStage - roundedStagePoint.y, 0);\n      orbitLine.scale.set(baseRadiusRounded, baseRadiusRounded, 1);\n      scene.add(orbitLine);\n    }\n\n    meshData.push({\n      mesh,\n      group,\n      orbitLine,\n      baseData: data,\n      processors,\n      transformCache,\n      isStatic,\n      hasAnimation,\n      baseBounds,\n      geometryKey,\n    });\n  }\n\n  /**\n   * Main animation loop.\n   * Runs processors, updates meshes, and renders the scene.\n   */\n  let animationFrameId: number | null = null;\n  const animate = (timestamp: number) => {\n    for (const entry of meshData) {\n      // Run processors to get updated layer data\n      const enhanced =\n        entry.hasAnimation && entry.processors.length > 0\n          ? pipelineCache.get(entry.baseData.LayerID, () =>\n              runPipeline(entry.baseData, entry.processors, timestamp),\n            )\n          : entry.baseData;\n      // Update material opacity if driven by processors (e.g., pulse)\n      const currentOpacity = enhanced.opacity ?? 1;\n      if (entry.mesh.material instanceof THREE.Material) {\n        entry.mesh.material.opacity = currentOpacity;\n      }\n\n      // Update visibility\n      const isVisible = shouldRenderEntry(entry, enhanced);\n      entry.group.visible = isVisible;\n      entry.mesh.visible = isVisible;\n      if (!isVisible) {\n        if (entry.orbitLine) {\n          entry.orbitLine.visible = false;\n        }\n        continue;\n      }\n\n      // Update position (convert stage coords to Three.js world space)\n      // Preserve sub-pixel precision for orbital animation to prevent jitter at low speeds\n      const position =\n        enhanced.hasOrbitalAnimation || enhanced.hasSpinAnimation\n          ? enhanced.position\n          : roundStagePoint(enhanced.position);\n      entry.group.position.set(position.x - halfStage, halfStage - position.y, 0);\n\n      // Update rotation (negative because Three.js Y-axis is flipped)\n      const rotation =\n        enhanced.currentRotation ?? enhanced.rotation ?? entry.baseData.rotation ?? 0;\n      entry.group.rotation.z = -(rotation * AnimationConstants.DEG_TO_RAD);\n\n      // Update orbit line if present\n      if (entry.orbitLine) {\n        const roundedStagePoint = enhanced.orbitStagePoint\n          ? roundStagePoint(enhanced.orbitStagePoint)\n          : undefined;\n        const roundedRadius = Math.max(0, Math.round(enhanced.orbitLineStyle?.radius ?? 0));\n        if (\n          enhanced.orbitLineStyle?.visible &&\n          roundedStagePoint &&\n          roundedRadius > 0 &&\n          enhanced.visible !== false\n        ) {\n          const baseRadius = entry.orbitLine.userData?.baseRadius ?? 1;\n          const scale = baseRadius > 0 ? roundedRadius / baseRadius : 1;\n          entry.orbitLine.visible = true;\n          entry.orbitLine.position.set(\n            roundedStagePoint.x - halfStage,\n            -(roundedStagePoint.y - halfStage),\n            0,\n          );\n          entry.orbitLine.scale.set(baseRadius * scale, baseRadius * scale, 1);\n        } else {\n          entry.orbitLine.visible = false;\n        }\n      }\n    }\n\n    // Render the scene\n    renderer.render(scene, camera);\n    pipelineCache.nextFrame();\n    animationFrameId = requestAnimationFrame(animate);\n  };\n\n  animationFrameId = requestAnimationFrame(animate);\n\n  // Cleanup function - disposes all Three.js resources\n  return () => {\n    if (animationFrameId !== null) cancelAnimationFrame(animationFrameId);\n\n    // Dispose layer meshes\n    meshData.forEach((entry) => {\n      scene.remove(entry.group);\n      releasePlaneGeometry(entry.geometryKey);\n      if (entry.mesh.material instanceof THREE.Material) {\n        entry.mesh.material.dispose();\n      }\n      if (entry.orbitLine) {\n        scene.remove(entry.orbitLine);\n        if (entry.orbitLine.material instanceof THREE.Material) {\n          entry.orbitLine.material.dispose();\n        }\n      }\n    });\n\n    pipelineCache.clear();\n    meshData.length = 0;\n    renderer.dispose();\n  };\n}\n\n// ============================================================================\n// THREE.JS RENDERER COMPONENT\n// ============================================================================\n// React component that orchestrates the Three.js rendering pipeline\n// ============================================================================\n\n/**\n * Mounts the complete Three.js renderer with auto-scaling transformer.\n *\n * WHAT IT DOES:\n * 1. Detects device capabilities (performance optimization)\n * 2. Creates WebGL renderer with optimized settings\n * 3. Sets up orthographic camera for 2D rendering\n * 4. Creates Three.js scene\n * 5. Sets up the stage transformer (handles viewport resize/scaling)\n * 6. Mounts the Three.js layers (creates meshes, starts rendering)\n * 7. Returns cleanup function\n *\n * DEVICE OPTIMIZATION:\n * - Low-end devices: low-power mode, no antialiasing, lower pixel ratio\n * - High-end devices: full quality, antialiasing, high pixel ratio\n *\n * @param container - Container element for the stage\n * @param canvas - Canvas element (will be 2048x2048, then scaled)\n * @param pipeline - Complete prepared pipeline from StageSystem\n * @returns Cleanup function\n */\nasync function mountThreeRenderer(\n  container: HTMLDivElement,\n  canvas: HTMLCanvasElement,\n  pipeline: StagePipeline,\n): Promise<() => void> {\n  const deviceCap = getDeviceCapability();\n\n  // Set canvas size\n  canvas.width = pipeline.stageSize;\n  canvas.height = pipeline.stageSize;\n\n  // Create WebGL renderer with device-optimized settings\n  const renderer = new THREE.WebGLRenderer({\n    canvas,\n    alpha: true,\n    antialias: deviceCap.enableAntialiasing,\n    powerPreference: deviceCap.isLowEndDevice ? \"low-power\" : \"default\",\n  });\n  renderer.setPixelRatio(deviceCap.pixelRatio);\n  renderer.setSize(pipeline.stageSize, pipeline.stageSize, false);\n  renderer.setClearColor(0x000000, 0);\n  renderer.outputColorSpace = THREE.SRGBColorSpace;\n\n  // Create orthographic camera for 2D rendering\n  const half = pipeline.stageSize / 2;\n  const camera = new THREE.OrthographicCamera(-half, half, half, -half, 0.1, 2000);\n  camera.position.z = 1000;\n\n  const scene = new THREE.Scene();\n\n  // Setup auto-scaling transformer (handles window resize)\n  const cleanupTransform = createStageTransformer(canvas, container, {\n    resizeDebounce: 100,\n  });\n\n  // Mount layers and start rendering\n  const cleanupLayers = await mountThreeLayers(\n    scene,\n    renderer,\n    camera,\n    toRendererInput(pipeline),\n    pipeline.stageSize,\n  );\n\n  return () => {\n    cleanupTransform?.();\n    cleanupLayers?.();\n    renderer.dispose();\n  };\n}\n\n/**\n * StageThree React Component\n *\n * LIFECYCLE:\n * 1. Component mounts\n * 2. useEffect creates pipeline from StageSystem\n * 3. mountThreeRenderer sets up WebGL rendering\n * 4. Component unmounts → cleanup is called\n *\n * USAGE: Just render <StageThree /> and it handles everything\n */\nfunction StageThree() {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const container = containerRef.current;\n    const canvas = canvasRef.current;\n    if (!container || !canvas) return;\n\n    let cleanup: (() => void) | undefined;\n    let active = true;\n\n    (async () => {\n      // Load and prepare all layers\n      const pipeline = await createStagePipeline();\n      if (!active) return;\n      // Mount renderer\n      cleanup = await mountThreeRenderer(container, canvas, pipeline);\n    })().catch((error) => {\n      console.error(\"[StageThree] Failed to initialize Three.js stage\", error);\n    });\n\n    return () => {\n      active = false;\n      cleanup?.();\n    };\n  }, []);\n\n  return (\n    <div ref={containerRef} className=\"absolute inset-0 z-0 pointer-events-none\">\n      <canvas ref={canvasRef} className=\"block\" />\n    </div>\n  );\n}\n\nexport default React.memo(StageThree);\n","path":null,"size_bytes":19061,"size_tokens":null},"shared/component/dialog_dialog-standard-11.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Signin Form\";\n\nconst Example = () => (\n  <Dialog>\n    <DialogTrigger asChild>\n      <Button variant=\"outline\">Sign In</Button>\n    </DialogTrigger>\n    <DialogContent className=\"sm:max-w-md\">\n      <DialogHeader>\n        <DialogTitle>Welcome back</DialogTitle>\n        <DialogDescription>\n          Enter your credentials to access your account.\n        </DialogDescription>\n      </DialogHeader>\n      <div className=\"space-y-4\">\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"email\">Email</Label>\n          <Input id=\"email\" placeholder=\"you@example.com\" type=\"email\" />\n        </div>\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"password\">Password</Label>\n          <Input id=\"password\" type=\"password\" />\n        </div>\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center space-x-2\">\n            <Checkbox id=\"remember\" />\n            <Label className=\"font-normal text-sm\" htmlFor=\"remember\">\n              Remember me\n            </Label>\n          </div>\n          <button className=\"font-medium text-sm underline\" type=\"button\">\n            Forgot password?\n          </button>\n        </div>\n      </div>\n      <DialogFooter>\n        <Button className=\"w-full\">Sign In</Button>\n      </DialogFooter>\n      <p className=\"text-center text-muted-foreground text-sm\">\n        Don't have an account?{\" \"}\n        <button className=\"font-medium underline\" type=\"button\">\n          Sign up\n        </button>\n      </p>\n    </DialogContent>\n  </Dialog>\n);\n\nexport default Example;\n","path":null,"size_bytes":1940,"size_tokens":null},"shared/layer/StageSystem.ts":{"content":"/**\n * ============================================================================\n * STAGE SYSTEM - Unified Stage Management for Yuzha Application\n * ============================================================================\n *\n * This module is the CORE of the stage rendering system. It combines two\n * essential functionalities:\n *\n * 1. COORDINATE SYSTEM - Managing the 2048x2048 fixed coordinate space\n * 2. DATA PIPELINE - Loading and preparing layers for rendering\n *\n * ARCHITECTURE FLOW (for future AI agents):\n * ------------------------------------------\n * ConfigYuzha.json (layer definitions)\n *   ↓\n * Config.ts (loads, transforms, validates)\n *   ↓\n * StageSystem.ts (THIS FILE - prepares coordinate system + layer pipeline)\n *   ↓\n * Renderers (StageCanvas/StageThree - render to screen)\n *   ↓\n * MainScreen.tsx (displays final result)\n *\n * HOW TO USE THIS MODULE:\n * -----------------------\n * For any new screen/module that needs stage rendering:\n *\n * import {\n *   STAGE_SIZE,              // The fixed 2048x2048 size\n *   createStageTransformer,  // Auto-scales stage to viewport\n *   createStagePipeline,     // Loads & prepares all layers\n *   toRendererInput,         // Formats pipeline for renderer\n * } from \"@shared/stage/StageSystem\";\n *\n * @module StageSystem\n */\n\nimport {\n  loadLayerConfig,\n  type LayerConfigEntry,\n  type LayerMotionMarker,\n  type ProcessorContext,\n  type EnhancedLayerData,\n  type LayerProcessor,\n  type Point2D,\n  type ImageMapping,\n} from \"./model\";\nimport { is2DLayer, prepareLayer, getProcessorsForEntry } from \"./engine\";\nimport { buildLayerMotion } from \"./motion\";\n\nconst IS_DEV = import.meta.env?.DEV ?? false;\n\n// ============================================================================\n// SECTION 1: COORDINATE SYSTEM\n// ============================================================================\n// This section manages the fixed 2048x2048 coordinate space and provides\n// utilities to transform it to any viewport size. Think of it like a virtual\n// canvas that scales to fit any screen while maintaining aspect ratio.\n//\n// KEY CONCEPT: All layers are positioned in 2048x2048 space, then this system\n// scales everything to fit the user's actual screen size (like CSS background-size: cover)\n// ============================================================================\n\n/**\n * The fixed stage size - all layers are positioned within this coordinate system.\n * This ensures consistent rendering across all devices regardless of screen size.\n */\nexport const STAGE_SIZE = 2048;\n\n/**\n * Transform result for positioning and scaling a stage.\n * Contains all the math needed to scale the 2048x2048 stage to fit a viewport.\n */\nexport interface StageTransform {\n  /** Scale factor to apply to the stage */\n  scale: number;\n  /** Horizontal offset in pixels for centering */\n  offsetX: number;\n  /** Vertical offset in pixels for centering */\n  offsetY: number;\n  /** Final width after scaling */\n  width: number;\n  /** Final height after scaling */\n  height: number;\n}\n\n/**\n * Computes the transform needed to display a 2048x2048 stage in a given viewport\n * using \"cover\" behavior (fills viewport, may overflow).\n *\n * ALGORITHM: Uses the larger of width/height scale to ensure full coverage,\n * similar to CSS background-size: cover.\n *\n * @param viewportWidth - Width of the viewport in pixels\n * @param viewportHeight - Height of the viewport in pixels\n * @returns Transform parameters for scaling and positioning\n *\n * @example\n * const transform = computeCoverTransform(1920, 1080);\n * // { scale: 0.9375, offsetX: 0, offsetY: -480, width: 1920, height: 1920 }\n */\nexport function computeCoverTransform(\n  viewportWidth: number,\n  viewportHeight: number,\n): StageTransform {\n  // Cover behavior: scale to fill viewport (use larger scale to cover)\n  const scaleX = viewportWidth / STAGE_SIZE;\n  const scaleY = viewportHeight / STAGE_SIZE;\n  const scale = Math.max(scaleX, scaleY); // Use larger scale for cover\n\n  const width = STAGE_SIZE * scale;\n  const height = STAGE_SIZE * scale;\n\n  return {\n    scale,\n    offsetX: (viewportWidth - width) / 2,\n    offsetY: (viewportHeight - height) / 2,\n    width,\n    height,\n  };\n}\n\n/**\n * Options for stage transformer\n */\nexport interface StageTransformerOptions {\n  /**\n   * Debounce delay for resize events in milliseconds (0 = no debounce)\n   * @default 0\n   */\n  resizeDebounce?: number;\n\n  /**\n   * Custom resize handler to use instead of window resize\n   */\n  onResize?: (callback: () => void) => () => void;\n}\n\n/**\n * Creates a stage transformer that automatically handles stage element and container sizing.\n * This is the AUTO-SCALING ENGINE - it watches window resize events and keeps the stage\n * properly scaled and centered.\n *\n * WHAT IT DOES:\n * - Sets stage element to 2048x2048px\n * - Applies CSS transform to scale and center it in viewport\n * - Listens for window resize and re-calculates transform\n * - Returns cleanup function to remove listeners\n *\n * Returns a cleanup function to remove event listeners.\n *\n * @param stageElement - The stage element to transform (canvas, div, etc)\n * @param container - The container element to transform\n * @param options - Optional configuration\n * @returns Cleanup function to remove event listeners\n *\n * @example\n * const cleanup = createStageTransformer(canvasEl, containerEl);\n * // Later when component unmounts: cleanup();\n */\nexport function createStageTransformer(\n  stageElement: HTMLElement,\n  container: HTMLElement,\n  options: StageTransformerOptions = {},\n): () => void {\n  const { resizeDebounce = 0, onResize } = options;\n\n  let timeoutId: number | undefined;\n\n  const applyTransform = () => {\n    const { innerWidth, innerHeight } = window;\n    const { scale, offsetX, offsetY } = computeCoverTransform(innerWidth, innerHeight);\n\n    // Set stage element size to fixed 2048x2048\n    stageElement.style.width = `${STAGE_SIZE}px`;\n    stageElement.style.height = `${STAGE_SIZE}px`;\n\n    // Set container size and apply scaling transform\n    container.style.width = `${STAGE_SIZE}px`;\n    container.style.height = `${STAGE_SIZE}px`;\n    container.style.position = \"absolute\";\n    container.style.left = \"0\";\n    container.style.top = \"0\";\n    container.style.transformOrigin = \"top left\";\n    container.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;\n  };\n\n  const handleResize = () => {\n    if (resizeDebounce > 0) {\n      if (timeoutId !== undefined) {\n        clearTimeout(timeoutId);\n      }\n      timeoutId = window.setTimeout(applyTransform, resizeDebounce);\n    } else {\n      applyTransform();\n    }\n  };\n\n  // Initial application\n  applyTransform();\n\n  // Setup resize handling\n  let cleanup: (() => void) | undefined;\n\n  if (onResize) {\n    cleanup = onResize(handleResize);\n  } else {\n    window.addEventListener(\"resize\", handleResize);\n    cleanup = () => {\n      window.removeEventListener(\"resize\", handleResize);\n      if (timeoutId !== undefined) {\n        clearTimeout(timeoutId);\n      }\n    };\n  }\n\n  return cleanup;\n}\n\n/**\n * Applies transform to any element using the stage2048 system.\n * Useful for positioning UI elements in stage coordinates.\n *\n * @param element - Element to transform\n * @param stageX - X position in stage coordinates (0-2048)\n * @param stageY - Y position in stage coordinates (0-2048)\n *\n * @example\n * applyStagePosition(buttonEl, 1024, 1024); // Center of stage\n */\nexport function applyStagePosition(element: HTMLElement, stageX: number, stageY: number): void {\n  element.style.position = \"absolute\";\n  element.style.left = `${stageX}px`;\n  element.style.top = `${stageY}px`;\n}\n\n/**\n * Converts viewport coordinates to stage coordinates.\n * Useful for handling mouse/touch input - converts screen pixels to stage position.\n *\n * @param viewportX - X position in viewport (screen pixels)\n * @param viewportY - Y position in viewport (screen pixels)\n * @param transform - Current stage transform (from computeCoverTransform)\n * @returns Stage coordinates (0-2048 range)\n *\n * @example\n * const stageCoords = viewportToStageCoords(100, 100, transform);\n */\nexport function viewportToStageCoords(\n  viewportX: number,\n  viewportY: number,\n  transform: StageTransform,\n): { x: number; y: number } {\n  return {\n    x: (viewportX - transform.offsetX) / transform.scale,\n    y: (viewportY - transform.offsetY) / transform.scale,\n  };\n}\n\n/**\n * Converts stage coordinates to viewport coordinates.\n * Inverse of viewportToStageCoords - converts stage position to screen pixels.\n *\n * @param stageX - X position in stage (0-2048)\n * @param stageY - Y position in stage (0-2048)\n * @param transform - Current stage transform\n * @returns Viewport coordinates (screen pixels)\n *\n * @example\n * const viewportCoords = stageToViewportCoords(1024, 1024, transform);\n */\nexport function stageToViewportCoords(\n  stageX: number,\n  stageY: number,\n  transform: StageTransform,\n): { x: number; y: number } {\n  return {\n    x: stageX * transform.scale + transform.offsetX,\n    y: stageY * transform.scale + transform.offsetY,\n  };\n}\n\n/**\n * Rounds stage coordinates to the nearest whole pixel.\n * Useful for preventing sub-pixel jitter when positioning render elements.\n *\n * NOTE: For smooth orbital animations, sub-pixel precision should be preserved,\n * so use this selectively.\n */\nexport function roundStagePoint<T extends { x: number; y: number }>(point: T): T {\n  return {\n    ...point,\n    x: Math.round(point.x),\n    y: Math.round(point.y),\n  };\n}\n\n// ============================================================================\n// SECTION 2: DATA PIPELINE\n// ============================================================================\n// This section handles loading layer configurations and preparing them for\n// rendering. It's the \"data processing\" part of the stage system.\n//\n// PIPELINE FLOW:\n// 1. loadLayerConfig() - loads from ConfigYuzha.json via Config.ts\n// 2. is2DLayer() - filters for 2D renderable layers\n// 3. prepareLayer() - processes each layer (positions, scales, etc.)\n// 4. getProcessorsForEntry() - attaches behaviors (spin, orbit, etc.)\n// 5. Returns StagePipeline - complete package ready for rendering\n//\n// FOR FUTURE AI AGENTS:\n// - To add new layer types, modify Config.ts and LayerCore.ts\n// - To add new behaviors, modify ProcessorRegistry.ts\n// - This file just orchestrates - actual logic is in those modules\n// ============================================================================\n\n/**\n * Options for creating a stage pipeline\n */\nexport type StagePipelineOptions = {\n  /** Override the default stage size (defaults to STAGE_SIZE = 2048) */\n  stageSize?: number;\n  /** Context for processor attachment (advanced usage) */\n  processorContext?: ProcessorContext;\n};\n\n/**\n * A prepared layer ready for rendering.\n * Contains the original config entry, processed layer data, and attached processors.\n */\nexport type PreparedLayer = {\n  /** Original configuration entry from ConfigYuzha.json */\n  entry: LayerConfigEntry;\n  /** Processed layer data with positions, scales, rotations calculated */\n  data: EnhancedLayerData;\n  /** Behavior processors (spin, orbit, debug visualizations, etc.) */\n  processors: LayerProcessor[];\n  /** Precomputed metadata used by renderers */\n  metadata: LayerMetadata;\n};\n\n/**\n * Optional stage marker primitive for overlay-style drawing within the renderer.\n */\nexport type StageMarker = {\n  /** Unique identifier for the marker */\n  id: string;\n  /** X coordinate in stage space (0-2048) */\n  x: number;\n  /** Y coordinate in stage space (0-2048) */\n  y: number;\n  /** Display color (CSS color string) */\n  color?: string;\n  /** Radius in stage pixels */\n  radius?: number;\n  /** Optional shape hint (default: point) */\n  kind?: \"point\" | \"circle\";\n  /** Stroke width (used for circle) */\n  lineWidth?: number;\n  /** Optional motion descriptor for animated markers */\n  motion?: {\n    type: \"orbit\";\n    centerX: number;\n    centerY: number;\n    radius: number;\n    rotationsPerHour: number;\n    direction: \"cw\" | \"ccw\";\n    initialAngleDeg: number;\n  };\n};\n\n/** Axis-aligned bounds helper used for culling decisions. */\nexport type LayerBounds = {\n  minX: number;\n  maxX: number;\n  minY: number;\n  maxY: number;\n};\n\nexport type LayerMetadata = {\n  baseBounds: LayerBounds;\n  isStatic: boolean;\n  hasAnimation: boolean;\n  visibleByDefault: boolean;\n};\n\nexport function computeLayerBounds(\n  position: Point2D,\n  scale: Point2D,\n  imageMapping: ImageMapping,\n): LayerBounds {\n  const width = imageMapping.imageDimensions.width * scale.x;\n  const height = imageMapping.imageDimensions.height * scale.y;\n  const halfWidth = width / 2;\n  const halfHeight = height / 2;\n  return {\n    minX: position.x - halfWidth,\n    maxX: position.x + halfWidth,\n    minY: position.y - halfHeight,\n    maxY: position.y + halfHeight,\n  };\n}\n\nexport function isLayerWithinStageBounds(\n  bounds: LayerBounds,\n  stageSize: number,\n  padding: number = 0,\n): boolean {\n  return !(\n    bounds.maxX < -padding ||\n    bounds.minX > stageSize + padding ||\n    bounds.maxY < -padding ||\n    bounds.minY > stageSize + padding\n  );\n}\n\nexport function isLayerWithinStage(\n  layer: { position: Point2D; scale: Point2D; imageMapping: ImageMapping },\n  stageSize: number,\n  padding: number = 0,\n): boolean {\n  return isLayerWithinStageBounds(\n    computeLayerBounds(layer.position, layer.scale, layer.imageMapping),\n    stageSize,\n    padding,\n  );\n}\n\n/**\n * Complete stage pipeline - all layers prepared and ready for rendering.\n * This is what gets passed to renderers (DOM, Canvas, Three.js).\n */\nexport type StagePipeline = {\n  /** The stage size used for this pipeline (usually 2048) */\n  stageSize: number;\n  /** All prepared layers in render order */\n  layers: PreparedLayer[];\n  /** Optional stage markers rendered alongside layers */\n  markers?: StageMarker[];\n};\n\n/**\n * Converts pipeline format to renderer input format.\n * Strips out the original config entry, leaving only data + processors.\n *\n * WHY: Renderers don't need the original config, just the processed data.\n *\n * @param pipeline - Complete stage pipeline\n * @returns Array of layer data + processors for renderer consumption\n */\nexport function toRendererInput(\n  pipeline: StagePipeline,\n): Array<{ data: EnhancedLayerData; processors: LayerProcessor[]; metadata: LayerMetadata }> {\n  return pipeline.layers.map(({ data, processors, metadata }) => ({\n    data,\n    processors,\n    metadata,\n  }));\n}\n\n/**\n * Creates a complete stage pipeline from configuration.\n *\n * THIS IS THE MAIN ENTRY POINT for setting up stage rendering.\n *\n * WHAT IT DOES:\n * 1. Loads layer configuration from ConfigYuzha.json (via Config.ts)\n * 2. Filters for 2D layers (3D not yet implemented)\n * 3. Prepares each layer (calculates positions, loads images, etc.)\n * 4. Attaches processors for animations/behaviors (spin, orbit, etc.)\n * 5. Returns complete pipeline ready for rendering\n *\n * USAGE IN RENDERERS:\n * const pipeline = await createStagePipeline();\n * const rendererData = toRendererInput(pipeline);\n * // Then pass rendererData to your rendering engine\n *\n * @param options - Optional configuration for pipeline creation\n * @returns Promise<StagePipeline> - Complete prepared pipeline\n *\n * @example\n * // In a renderer component:\n * const pipeline = await createStagePipeline();\n * const layers = toRendererInput(pipeline);\n * // Now render the layers...\n */\nexport async function createStagePipeline(\n  options: StagePipelineOptions = {},\n): Promise<StagePipeline> {\n  const stageSize = options.stageSize ?? STAGE_SIZE;\n  const processorContext = options.processorContext;\n\n  // Load configuration from ConfigYuzha.json (via Config.ts)\n  const config = loadLayerConfig();\n  const twoDLayers = config.filter(is2DLayer);\n\n  // Prepare all layers in parallel\n  const motionMarkers: StageMarker[] = [];\n  const prepared = (\n    await Promise.all(\n      twoDLayers.map(async (entry) => {\n        try {\n          const layer = await prepareLayer(entry, stageSize);\n          if (!layer) {\n            console.warn(\n              `[StageSystem] Skipping layer \"${entry.LayerID}\" - prepareLayer returned null`,\n            );\n            return null;\n          }\n\n          // Attach processors (spin, orbit, debug, etc.)\n          const processors = getProcessorsForEntry(entry, processorContext);\n          const enhancedLayer = layer as EnhancedLayerData;\n          const baseBounds = computeLayerBounds(\n            enhancedLayer.position,\n            enhancedLayer.scale,\n            enhancedLayer.imageMapping,\n          );\n          const baseHasAnimation =\n            processors.length > 0 ||\n            Boolean(enhancedLayer.hasSpinAnimation || enhancedLayer.hasOrbitalAnimation);\n\n          const motionArtifacts = buildLayerMotion(entry, enhancedLayer, stageSize);\n          if (motionArtifacts.processor) {\n            processors.push(motionArtifacts.processor as LayerProcessor);\n          }\n          if (motionArtifacts.markers) {\n            appendMotionMarkers(motionMarkers, motionArtifacts.markers);\n          }\n\n          const finalHasAnimation = baseHasAnimation || Boolean(motionArtifacts.processor);\n\n          const metadata: LayerMetadata = {\n            baseBounds,\n            isStatic: !finalHasAnimation,\n            hasAnimation: finalHasAnimation,\n            visibleByDefault: enhancedLayer.visible !== false,\n          };\n\n          if (!metadata.hasAnimation && !isLayerWithinStageBounds(baseBounds, stageSize)) {\n            if (IS_DEV) {\n              console.info(\n                `[StageSystem] Skipping static offscreen layer \"${entry.LayerID}\" (${entry.ImageID})`,\n              );\n            }\n            return null;\n          }\n\n          return {\n            entry,\n            data: enhancedLayer,\n            processors,\n            metadata,\n          } satisfies PreparedLayer;\n        } catch (error) {\n          console.error(\n            `[StageSystem] Failed to prepare layer \"${entry.LayerID}\" (renderer=${entry.renderer})`,\n            error,\n          );\n          return null;\n        }\n      }),\n    )\n  ).filter((layer): layer is PreparedLayer => layer !== null);\n\n  return {\n    stageSize,\n    layers: prepared,\n    markers: motionMarkers.length > 0 ? motionMarkers : undefined,\n  };\n}\n\nfunction appendMotionMarkers(target: StageMarker[], markers: LayerMotionMarker[]): void {\n  for (const marker of markers) {\n    target.push({\n      id: marker.id,\n      x: marker.x,\n      y: marker.y,\n      color: marker.color,\n      radius: marker.radius,\n      kind: marker.kind,\n      lineWidth: marker.lineWidth,\n      motion: marker.motion\n        ? {\n            type: \"orbit\",\n            centerX: marker.motion.centerX,\n            centerY: marker.motion.centerY,\n            radius: marker.motion.radius,\n            rotationsPerHour: marker.motion.rotationsPerHour,\n            direction: marker.motion.direction,\n            initialAngleDeg: marker.motion.initialAngleDeg,\n          }\n        : undefined,\n    });\n  }\n}\n\n// ============================================================================\n// SECTION 3: RE-EXPORTS FOR CONVENIENCE\n// ============================================================================\n// Re-export types and functions that are commonly used together with this module\n// ============================================================================\n\nexport type { ProcessorContext, EnhancedLayerData, LayerProcessor } from \"./model\";\nexport type { LayerConfigEntry } from \"./index\";\n","path":null,"size_bytes":19546,"size_tokens":null},"yuzha/src/main.tsx":{"content":"import React from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\nimport \"@shared/fonts/taimingda.css\";\n\nconst rootEl = document.getElementById(\"root\");\nif (!rootEl) {\n  throw new Error(\"Root element #root tidak ditemukan\");\n}\n\ncreateRoot(rootEl).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n);\n","path":null,"size_bytes":369,"size_tokens":null},"yuzha/src/counter/counterSettings.tsx":{"content":"import React from \"react\";\nimport FloatingWindowTemplate from \"@shared/floating/FloatingWindowTemplate\";\n\nexport type CounterSettingsProps = {\n  size: number;\n  onSizeChange: (value: number) => void;\n  position: { x: number; y: number };\n  onPositionChange: (value: { x: number; y: number }) => void;\n  messageSize: number;\n  onMessageSizeChange: (value: number) => void;\n  messagePosition: { x: number; y: number };\n  onMessagePositionChange: (value: { x: number; y: number }) => void;\n  messageFontSize: number;\n  onMessageFontSizeChange: (value: number) => void;\n  messageColor: string;\n  onMessageColorChange: (value: string) => void;\n  hapticsEnabled: boolean;\n  onHapticsToggle: (value: boolean) => void;\n  soundEnabled: boolean;\n  onSoundToggle: (value: boolean) => void;\n  backPosition: { x: number; y: number };\n  onBackPositionChange: (value: { x: number; y: number }) => void;\n  resetPosition: { x: number; y: number };\n  onResetPositionChange: (value: { x: number; y: number }) => void;\n  settingsPosition: { x: number; y: number };\n  onSettingsPositionChange: (value: { x: number; y: number }) => void;\n  onOpenDemo?: () => void;\n  onClose?: () => void;\n};\n\nexport default function CounterSettings({\n  size,\n  onSizeChange,\n  position,\n  onPositionChange,\n  messageSize,\n  onMessageSizeChange,\n  messagePosition,\n  onMessagePositionChange,\n  messageFontSize,\n  onMessageFontSizeChange,\n  messageColor,\n  onMessageColorChange,\n  hapticsEnabled,\n  onHapticsToggle,\n  soundEnabled,\n  onSoundToggle,\n  backPosition,\n  onBackPositionChange,\n  resetPosition,\n  onResetPositionChange,\n  settingsPosition,\n  onSettingsPositionChange,\n  onOpenDemo,\n  onClose,\n}: CounterSettingsProps) {\n  const clampStage = (value: number) => Math.min(2048, Math.max(0, value));\n\n  const handleSizeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const next = Number(event.target.value);\n    if (!Number.isNaN(next)) onSizeChange(next);\n  };\n\n  const handleMessageSizeChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const next = Number(event.target.value);\n    if (!Number.isNaN(next)) onMessageSizeChange(next);\n  };\n\n  const handlePositionChange =\n    (setter: (value: { x: number; y: number }) => void, current: { x: number; y: number }) =>\n    (axis: \"x\" | \"y\") =>\n    (event: React.ChangeEvent<HTMLInputElement>) => {\n      const next = Number(event.target.value);\n      if (Number.isNaN(next)) return;\n      setter({ ...current, [axis]: clampStage(next) });\n    };\n\n  const handleMessageFontChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const next = Number(event.target.value);\n    if (!Number.isNaN(next)) onMessageFontSizeChange(next);\n  };\n\n  const renderPositionInputs = (\n    label: string,\n    value: { x: number; y: number },\n    setter: (val: { x: number; y: number }) => void,\n  ) => (\n    <div>\n      <p className=\"text-sm font-semibold text-slate-800\">{label} (stage 0-2048)</p>\n      <div className=\"mt-2 grid grid-cols-2 gap-2 text-xs text-slate-700\">\n        <label className=\"flex items-center gap-2\">\n          <span className=\"w-4 text-right\">X</span>\n          <input\n            type=\"number\"\n            min={0}\n            max={2048}\n            value={value.x}\n            onChange={handlePositionChange(setter, value)(\"x\")}\n            className=\"w-full rounded border border-slate-300 px-2 py-1 focus:border-blue-500 focus:outline-none\"\n          />\n        </label>\n        <label className=\"flex items-center gap-2\">\n          <span className=\"w-4 text-right\">Y</span>\n          <input\n            type=\"number\"\n            min={0}\n            max={2048}\n            value={value.y}\n            onChange={handlePositionChange(setter, value)(\"y\")}\n            className=\"w-full rounded border border-slate-300 px-2 py-1 focus:border-blue-500 focus:outline-none\"\n          />\n        </label>\n      </div>\n    </div>\n  );\n\n  return (\n    <FloatingWindowTemplate\n      title=\"Settings\"\n      initialPos={{ x: 24, y: 24 }}\n      initialSize={{ width: 420, height: 520 }}\n      minWidth={360}\n      minHeight={360}\n      onClose={onClose}\n    >\n      <div className=\"relative space-y-4 text-slate-800\">\n        {onOpenDemo && (\n          <button\n            type=\"button\"\n            onClick={onOpenDemo}\n            className=\"absolute right-0 top-0 rounded bg-emerald-600 px-3 py-1 text-xs font-semibold text-white shadow hover:bg-emerald-500\"\n          >\n            Effect Demo\n          </button>\n        )}\n        <div>\n          <p className=\"text-sm font-semibold\">Floating Button Size</p>\n          <input\n            type=\"range\"\n            min={200}\n            max={900}\n            step={10}\n            value={size}\n            onChange={handleSizeChange}\n            className=\"mt-2 w-full\"\n            aria-label=\"Floating button size\"\n          />\n          <div className=\"mt-1 text-xs text-slate-600\">Current: {size}px</div>\n        </div>\n\n        {renderPositionInputs(\"Position\", position, onPositionChange)}\n\n        <div>\n          <p className=\"text-sm font-semibold\">Message Size</p>\n          <input\n            type=\"range\"\n            min={200}\n            max={900}\n            step={10}\n            value={messageSize}\n            onChange={handleMessageSizeChange}\n            className=\"mt-2 w-full\"\n            aria-label=\"Message size\"\n          />\n          <div className=\"mt-1 text-xs text-slate-600\">Current: {messageSize}px</div>\n        </div>\n\n        {renderPositionInputs(\"Message Position\", messagePosition, onMessagePositionChange)}\n\n        <div>\n          <p className=\"text-sm font-semibold\">Message Font Size</p>\n          <input\n            type=\"range\"\n            min={16}\n            max={120}\n            step={2}\n            value={messageFontSize}\n            onChange={handleMessageFontChange}\n            className=\"mt-2 w-full\"\n            aria-label=\"Message font size\"\n          />\n          <div className=\"mt-1 text-xs text-slate-600\">Current: {messageFontSize}px</div>\n        </div>\n\n        <div>\n          <p className=\"text-sm font-semibold\">Message Color</p>\n          <div className=\"mt-2 flex items-center gap-3 text-xs text-slate-700\">\n            <input\n              type=\"color\"\n              value={messageColor}\n              onChange={(e) => onMessageColorChange(e.target.value)}\n              className=\"h-8 w-12 rounded border border-slate-300 bg-white\"\n              aria-label=\"Message color\"\n            />\n            <span className=\"text-slate-600\">{messageColor}</span>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-2 gap-2 text-xs text-slate-700\">\n          <label className=\"flex items-center gap-2\">\n            <input\n              type=\"checkbox\"\n              checked={hapticsEnabled}\n              onChange={(e) => onHapticsToggle(e.target.checked)}\n              className=\"h-4 w-4\"\n            />\n            <span className=\"text-sm font-semibold text-slate-800\">Haptics</span>\n          </label>\n          <label className=\"flex items-center gap-2\">\n            <input\n              type=\"checkbox\"\n              checked={soundEnabled}\n              onChange={(e) => onSoundToggle(e.target.checked)}\n              className=\"h-4 w-4\"\n            />\n            <span className=\"text-sm font-semibold text-slate-800\">Sound</span>\n          </label>\n        </div>\n\n        {renderPositionInputs(\"Back Button Position\", backPosition, onBackPositionChange)}\n        {renderPositionInputs(\"Reset Button Position\", resetPosition, onResetPositionChange)}\n        {renderPositionInputs(\n          \"Settings Button Position\",\n          settingsPosition,\n          onSettingsPositionChange,\n        )}\n      </div>\n    </FloatingWindowTemplate>\n  );\n}\n","path":null,"size_bytes":7731,"size_tokens":null},"shared/component/carousel_carousel-standard-4.tsx":{"content":"import { faker } from \"@faker-js/faker\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselNext,\n  CarouselPrevious,\n} from \"@/components/ui/carousel\";\n\nexport const title = \"Hero Carousel\";\n\nconst slides = Array.from({ length: 3 }, () => ({\n  id: faker.string.uuid(),\n  title: faker.company.catchPhrase(),\n  description: faker.lorem.sentence(),\n  cta: faker.helpers.arrayElement([\n    \"Learn More\",\n    \"Get Started\",\n    \"Shop Now\",\n    \"Discover\",\n  ]),\n}));\n\nconst Example = () => (\n  <div className=\"mx-auto w-full max-w-2xl\">\n    <Carousel>\n      <CarouselContent>\n        {slides.map((slide) => (\n          <CarouselItem key={slide.id}>\n            <div className=\"relative aspect-[16/9] overflow-hidden rounded-lg bg-muted\">\n              <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent\" />\n              <div className=\"absolute inset-0 flex flex-col items-center justify-center p-8 text-center text-white\">\n                <h2 className=\"mb-2 font-bold text-3xl\">{slide.title}</h2>\n                <p className=\"mb-6 max-w-md text-sm opacity-90\">\n                  {slide.description}\n                </p>\n                <Button variant=\"secondary\">{slide.cta}</Button>\n              </div>\n            </div>\n          </CarouselItem>\n        ))}\n      </CarouselContent>\n      <CarouselPrevious className=\"left-4\" />\n      <CarouselNext className=\"right-4\" />\n    </Carousel>\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":1523,"size_tokens":null},"yuzha/src/timestamp/TimestampPreview.tsx":{"content":"import React, { useRef, useEffect, useCallback } from \"react\";\nimport StageThree from \"@shared/layer/StageThree\";\n\nexport type TimestampPreviewProps = {\n  widthPx: number;\n  heightPx: number;\n  imageSrc: string | null;\n  scale: number;\n  translateX: number;\n  translateY: number;\n  rotation?: number;\n  onScaleChange: (scale: number) => void;\n  onTranslateChange: (x: number, y: number) => void;\n  onBoundsChange: (bounds: { x: number; y: number; width: number; height: number }) => void;\n};\n\nexport default function TimestampPreview({\n  widthPx,\n  heightPx,\n  imageSrc,\n  scale,\n  translateX,\n  translateY,\n  rotation = 0,\n  onScaleChange,\n  onTranslateChange,\n  onBoundsChange,\n}: TimestampPreviewProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const isPanning = useRef(false);\n  const panStart = useRef({ x: 0, y: 0 });\n  const translateStart = useRef({ x: 0, y: 0 });\n\n  const isPinching = useRef(false);\n  const initialPinchDistance = useRef(0);\n  const initialPinchScale = useRef(1);\n  const lastTapTime = useRef(0);\n\n  useEffect(() => {\n    const updateBounds = () => {\n      if (containerRef.current) {\n        const rect = containerRef.current.getBoundingClientRect();\n        onBoundsChange({\n          x: rect.left,\n          y: rect.top,\n          width: rect.width,\n          height: rect.height,\n        });\n      }\n    };\n\n    updateBounds();\n\n    const resizeObserver = new ResizeObserver(updateBounds);\n    if (containerRef.current) {\n      resizeObserver.observe(containerRef.current);\n    }\n\n    window.addEventListener(\"resize\", updateBounds);\n\n    return () => {\n      resizeObserver.disconnect();\n      window.removeEventListener(\"resize\", updateBounds);\n    };\n  }, [onBoundsChange, widthPx, heightPx]);\n\n  const handleWheel = useCallback(\n    (e: React.WheelEvent) => {\n      if (!imageSrc) return;\n      e.preventDefault();\n      const delta = e.deltaY > 0 ? 0.9 : 1.1;\n      const newScale = Math.max(0.1, Math.min(5, scale * delta));\n      onScaleChange(newScale);\n    },\n    [imageSrc, scale, onScaleChange]\n  );\n\n  const handlePointerDown = useCallback(\n    (e: React.PointerEvent) => {\n      if (!imageSrc) return;\n      isPanning.current = true;\n      panStart.current = { x: e.clientX, y: e.clientY };\n      translateStart.current = { x: translateX, y: translateY };\n      (e.target as HTMLElement).setPointerCapture(e.pointerId);\n    },\n    [imageSrc, translateX, translateY]\n  );\n\n  const handlePointerMove = useCallback(\n    (e: React.PointerEvent) => {\n      if (!isPanning.current || !imageSrc) return;\n      const deltaX = e.clientX - panStart.current.x;\n      const deltaY = e.clientY - panStart.current.y;\n      onTranslateChange(translateStart.current.x + deltaX, translateStart.current.y + deltaY);\n    },\n    [imageSrc, onTranslateChange]\n  );\n\n  const handlePointerUp = useCallback(() => {\n    isPanning.current = false;\n  }, []);\n\n  const getTouchDistance = (touches: React.TouchList) => {\n    if (touches.length < 2) return 0;\n    const touch0 = touches[0];\n    const touch1 = touches[1];\n    if (!touch0 || !touch1) return 0;\n    const dx = touch0.clientX - touch1.clientX;\n    const dy = touch0.clientY - touch1.clientY;\n    return Math.sqrt(dx * dx + dy * dy);\n  };\n\n  const handleTouchStart = useCallback(\n    (e: React.TouchEvent) => {\n      if (!imageSrc) return;\n\n      if (e.touches.length === 1) {\n        const now = Date.now();\n        const timeSinceLastTap = now - lastTapTime.current;\n\n        if (timeSinceLastTap < 300 && timeSinceLastTap > 0) {\n          e.preventDefault();\n          onScaleChange(1);\n          onTranslateChange(0, 0);\n          lastTapTime.current = 0;\n        } else {\n          lastTapTime.current = now;\n        }\n      }\n\n      if (e.touches.length === 2) {\n        e.preventDefault();\n        isPinching.current = true;\n        isPanning.current = false;\n        initialPinchDistance.current = getTouchDistance(e.touches);\n        initialPinchScale.current = scale;\n      }\n    },\n    [imageSrc, scale, onScaleChange, onTranslateChange]\n  );\n\n  const handleTouchMove = useCallback(\n    (e: React.TouchEvent) => {\n      if (!imageSrc || !isPinching.current) return;\n\n      if (e.touches.length === 2) {\n        e.preventDefault();\n        const currentDistance = getTouchDistance(e.touches);\n\n        if (initialPinchDistance.current > 0) {\n          const scaleChange = currentDistance / initialPinchDistance.current;\n          const newScale = Math.max(0.1, Math.min(5, initialPinchScale.current * scaleChange));\n          onScaleChange(newScale);\n        }\n      }\n    },\n    [imageSrc, onScaleChange]\n  );\n\n  const handleTouchEnd = useCallback((e: React.TouchEvent) => {\n    if (e.touches.length < 2) {\n      isPinching.current = false;\n      initialPinchDistance.current = 0;\n    }\n  }, []);\n\n  return (\n    <div className=\"flex flex-1 items-start justify-center\">\n      <div\n        ref={containerRef}\n        className=\"relative border-2 border-emerald-400/70 overflow-hidden bg-slate-900\"\n        style={{\n          width: `${widthPx}px`,\n          height: `${heightPx}px`,\n          cursor: imageSrc ? \"grab\" : \"default\",\n          touchAction: \"none\",\n        }}\n        onWheel={handleWheel}\n        onPointerDown={handlePointerDown}\n        onPointerMove={handlePointerMove}\n        onPointerUp={handlePointerUp}\n        onPointerLeave={handlePointerUp}\n        onTouchStart={handleTouchStart}\n        onTouchMove={handleTouchMove}\n        onTouchEnd={handleTouchEnd}\n      >\n        {imageSrc ? (\n          <div\n            className=\"absolute inset-0 flex items-center justify-center\"\n            style={{\n              transform: `translate(${translateX}px, ${translateY}px) rotate(${rotation}deg) scale(${scale})`,\n              transformOrigin: \"center center\",\n              pointerEvents: \"none\",\n            }}\n          >\n            <img\n              src={imageSrc}\n              alt=\"Preview\"\n              className=\"max-w-none\"\n              style={{ userSelect: \"none\", pointerEvents: \"none\" }}\n              draggable={false}\n            />\n          </div>\n        ) : (\n          <div className=\"absolute inset-0 pointer-events-none\">\n            <StageThree />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":6254,"size_tokens":null},"shared/component/checkbox_checkbox-standard-4.tsx":{"content":"import { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Disabled Checkbox\";\n\nconst Example = () => (\n  <div className=\"space-y-4\">\n    <div className=\"flex items-center space-x-2\">\n      <Checkbox disabled id=\"disabled\" />\n      <Label className=\"text-muted-foreground\" htmlFor=\"disabled\">\n        Disabled unchecked\n      </Label>\n    </div>\n    <div className=\"flex items-center space-x-2\">\n      <Checkbox checked disabled id=\"disabled-checked\" />\n      <Label className=\"text-muted-foreground\" htmlFor=\"disabled-checked\">\n        Disabled checked\n      </Label>\n    </div>\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":681,"size_tokens":null},"shared/component/switch_switch-square-2.tsx":{"content":"\"use client\";\n\nimport { useId, useState } from \"react\";\n\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\n\nexport const title = \"Square Switch with Text\";\n\nconst Example = () => {\n  const id = useId();\n  const [checked, setChecked] = useState(true);\n\n  return (\n    <div>\n      <div className=\"relative inline-grid h-9 grid-cols-[1fr_1fr] items-center font-medium text-sm\">\n        <Switch\n          checked={checked}\n          className=\"peer [&_span]:data-[state=checked]:rtl:-translate-x-full absolute inset-0 h-[inherit] w-auto rounded-md data-[state=unchecked]:bg-input/50 [&_span]:z-10 [&_span]:h-full [&_span]:w-1/2 [&_span]:rounded-sm [&_span]:transition-transform [&_span]:duration-300 [&_span]:ease-[cubic-bezier(0.16,1,0.3,1)] [&_span]:data-[state=checked]:translate-x-full\"\n          id={id}\n          onCheckedChange={setChecked}\n        />\n        <span className=\"peer-data-[state=unchecked]:rtl:-translate-x-full pointer-events-none relative ms-0.5 flex items-center justify-center px-2 text-center transition-transform duration-300 ease-[cubic-bezier(0.16,1,0.3,1)] peer-data-[state=checked]:invisible peer-data-[state=unchecked]:translate-x-full\">\n          <span className=\"font-medium text-[10px] uppercase\">Off</span>\n        </span>\n        <span className=\"peer-data-[state=checked]:-translate-x-full pointer-events-none relative me-0.5 flex items-center justify-center px-2 text-center transition-transform duration-300 ease-[cubic-bezier(0.16,1,0.3,1)] peer-data-[state=unchecked]:invisible peer-data-[state=checked]:text-primary-foreground peer-data-[state=checked]:rtl:translate-x-full\">\n          <span className=\"font-medium text-[10px] uppercase\">On</span>\n        </span>\n      </div>\n      <Label className=\"sr-only\" htmlFor={id}>\n        Labeled switch\n      </Label>\n    </div>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":1892,"size_tokens":null},"shared/component/calendar_calendar-standard-2.tsx":{"content":"\"use client\";\n\nimport type { ChangeEvent, ChangeEventHandler } from \"react\";\nimport { useState } from \"react\";\n\nimport { Calendar } from \"@/components/ui/calendar\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\nexport const title = \"Calendar with Month and Year Selector\";\n\nconst Example = () => {\n  const [date, setDate] = useState<Date | undefined>(new Date());\n  const [month, setMonth] = useState<Date>(new Date());\n\n  const handleCalendarChange = (\n    value: string | number,\n    event: ChangeEventHandler<HTMLSelectElement>,\n  ) => {\n    const newEvent = {\n      target: {\n        value: String(value),\n      },\n    } as ChangeEvent<HTMLSelectElement>;\n    event(newEvent);\n  };\n\n  return (\n    <Calendar\n      captionLayout=\"dropdown\"\n      className=\"rounded-md border\"\n      components={{\n        MonthCaption: (props) => <>{props.children}</>,\n        DropdownNav: (props) => (\n          <div className=\"flex w-full items-center gap-2\">{props.children}</div>\n        ),\n        Dropdown: (props) => (\n          <Select\n            onValueChange={(value) => {\n              if (props.onChange) {\n                handleCalendarChange(value, props.onChange);\n              }\n            }}\n            value={String(props.value)}\n          >\n            <SelectTrigger className=\"first:flex-1 last:shrink-0\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              {props.options?.map((option) => (\n                <SelectItem\n                  disabled={option.disabled}\n                  key={option.value}\n                  value={String(option.value)}\n                >\n                  {option.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        ),\n      }}\n      hideNavigation\n      mode=\"single\"\n      month={month}\n      onMonthChange={setMonth}\n      onSelect={setDate}\n      selected={date}\n    />\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":2026,"size_tokens":null},"shared/component/card_card-standard-1.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\n\nexport const title = \"Standard Card\";\n\nconst Example = () => (\n  <Card className=\"w-[350px]\">\n    <CardHeader>\n      <CardTitle>Card Title</CardTitle>\n      <CardDescription>Card description goes here</CardDescription>\n    </CardHeader>\n    <CardContent>\n      <p>This is the card content area where you can place any content.</p>\n    </CardContent>\n    <CardFooter className=\"flex justify-between\">\n      <Button variant=\"outline\">Cancel</Button>\n      <Button>Submit</Button>\n    </CardFooter>\n  </Card>\n);\n\nexport default Example;\n","path":null,"size_bytes":707,"size_tokens":null},"shared/component/scroll-area_scroll-area-advanced-2.tsx":{"content":"\"use client\";\n\nimport { useState } from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\n\nexport const title = \"Dynamic Content\";\n\nconst Example = () => {\n  const [items, setItems] = useState(\n    Array.from({ length: 10 }, (_, i) => ({\n      id: i + 1,\n      title: `Item ${i + 1}`,\n      description: `This is the description for item ${i + 1}`,\n    }))\n  );\n\n  const loadMore = () => {\n    const newItems = Array.from({ length: 5 }, (_, i) => ({\n      id: items.length + i + 1,\n      title: `Item ${items.length + i + 1}`,\n      description: `This is the description for item ${items.length + i + 1}`,\n    }));\n    setItems([...items, ...newItems]);\n  };\n\n  return (\n    <div className=\"w-full max-w-md space-y-4\">\n      <ScrollArea className=\"h-[400px] rounded-md border bg-background\">\n        <div className=\"space-y-4 p-4\">\n          {items.map((item) => (\n            <div\n              className=\"rounded-lg border bg-card p-4 text-card-foreground shadow-sm\"\n              key={item.id}\n            >\n              <h3 className=\"font-semibold text-sm\">{item.title}</h3>\n              <p className=\"mt-1 text-muted-foreground text-sm\">\n                {item.description}\n              </p>\n            </div>\n          ))}\n          <Button className=\"w-full\" onClick={loadMore} variant=\"outline\">\n            Load More\n          </Button>\n        </div>\n      </ScrollArea>\n      <p className=\"text-center text-muted-foreground text-sm\">\n        Showing {items.length} items\n      </p>\n    </div>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":1608,"size_tokens":null},"meng/src/App.tsx":{"content":"/**\n * App Component - Main Application Root\n *\n * Purpose: Root component that assembles all sections of the website\n *\n * Structure:\n * 1. Navbar (fixed at top)\n * 2. Hero section\n * 3. About section\n * 4. Menu section\n * 5. Gallery section\n * 6. Contact section\n * 7. Footer\n *\n * For Future AI Agents:\n * - This is a single-page application (SPA)\n * - Navigation uses anchor links and smooth scrolling\n * - All components are imported and rendered in order\n * - No routing library needed (single page)\n * - Add new sections by importing component and adding to JSX\n *\n * Maintenance:\n * - To add new sections: import component and place in appropriate order\n * - To modify layout: adjust component order or add wrapper divs\n * - To add routing: install react-router-dom and refactor\n */\n\nimport Navbar from './components/Navbar'\nimport Hero from './components/Hero'\nimport About from './components/About'\nimport Menu from './components/Menu'\nimport Gallery from './components/Gallery'\nimport Contact from './components/Contact'\nimport Footer from './components/Footer'\n\nfunction App() {\n  return (\n    <div className=\"min-h-screen\">\n      {/* Fixed Navigation */}\n      <Navbar />\n\n      {/* Page Sections */}\n      <main>\n        <Hero />\n        <About />\n        <Menu />\n        <Gallery />\n        <Contact />\n      </main>\n\n      {/* Footer */}\n      <Footer />\n    </div>\n  )\n}\n\nexport default App\n","path":null,"size_bytes":1409,"size_tokens":null},"yuzha/src/timestamp/TimestampSettings.tsx":{"content":"import React, { useEffect, useState } from \"react\";\nimport FloatingWindowTemplate from \"@shared/floating/FloatingWindowTemplate\";\nimport Accordion from \"@shared/floating/Accordion\";\nimport { loadPresets, deletePreset, type TimestampPreset } from \"./PresetManager\";\nimport {\n  type OverlaySettings,\n  type TextAlign,\n  FONT_FAMILIES,\n  TEXT_ALIGNMENTS,\n  DATE_FORMATS,\n  TIME_FORMATS,\n  formatDate,\n  formatTime,\n} from \"./types\";\n\nexport type TimestampSettingsProps = {\n  textColor: string;\n  onTextColorChange: (value: string) => void;\n  shadowColor: string;\n  onShadowColorChange: (value: string) => void;\n  shadowBlur: number;\n  onShadowBlurChange: (value: number) => void;\n  shadowOffsetX: number;\n  onShadowOffsetXChange: (value: number) => void;\n  shadowOffsetY: number;\n  onShadowOffsetYChange: (value: number) => void;\n  scale: number;\n  onScaleChange: (value: number) => void;\n  translateX: number;\n  onTranslateXChange: (value: number) => void;\n  translateY: number;\n  onTranslateYChange: (value: number) => void;\n  rotation: number;\n  onRotationChange: (value: number) => void;\n  onResetPosition: () => void;\n  customFonts: string[];\n  onAddCustomFont: (fontName: string, fontDataUrl: string) => void;\n  timeSettings: OverlaySettings;\n  onTimeSettingsChange: (settings: OverlaySettings) => void;\n  dateSettings: OverlaySettings;\n  onDateSettingsChange: (settings: OverlaySettings) => void;\n  locationSettings: OverlaySettings;\n  onLocationSettingsChange: (settings: OverlaySettings) => void;\n  previewBounds: { x: number; y: number; width: number; height: number };\n  onTimeAlignmentChange?: (textAlign: TextAlign) => void;\n  onDateAlignmentChange?: (textAlign: TextAlign) => void;\n  onLocationAlignmentChange?: (textAlign: TextAlign) => void;\n  onSavePreset: (name: string) => void;\n  onLoadPreset: (preset: TimestampPreset) => void;\n  onAddImageOverlay?: () => void;\n  onClose?: () => void;\n};\n\nfunction OverlaySection({\n  label,\n  settings,\n  onChange,\n  customFonts,\n  formatType,\n  onAlignmentChange,\n}: {\n  label: string;\n  settings: OverlaySettings;\n  onChange: (s: OverlaySettings) => void;\n  customFonts: string[];\n  formatType?: \"time\" | \"date\";\n  onAlignmentChange?: (textAlign: TextAlign) => void;\n}) {\n  const allFonts = [\n    ...FONT_FAMILIES,\n    ...customFonts.map((f) => ({ label: f, value: f })),\n  ];\n\n  const formats = formatType === \"time\" ? TIME_FORMATS : formatType === \"date\" ? DATE_FORMATS : [];\n\n  const handleApplyFormat = (format: string) => {\n    const now = new Date();\n    const formatted = formatType === \"time\" ? formatTime(now, format) : formatDate(now, format);\n    onChange({ ...settings, text: formatted });\n  };\n\n  return (\n    <div className=\"space-y-3 text-slate-800\">\n      <div>\n        <label className=\"block text-xs font-semibold mb-1\">{label} Text</label>\n        <textarea\n          value={settings.text}\n          onChange={(e) => onChange({ ...settings, text: e.target.value })}\n          placeholder={label}\n          rows={2}\n          className=\"w-full rounded border border-slate-300 px-2 py-1 text-sm focus:border-blue-500 focus:outline-none resize-none\"\n        />\n      </div>\n\n      {formats.length > 0 && (\n        <div>\n          <label className=\"block text-xs font-semibold mb-1\">Format</label>\n          <div className=\"flex flex-wrap gap-1\">\n            {formats.map((f) => (\n              <button\n                key={f.value}\n                type=\"button\"\n                onClick={() => handleApplyFormat(f.value)}\n                className=\"px-2 py-1 text-xs rounded border border-slate-300 bg-white hover:bg-slate-50\"\n              >\n                {f.label}\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n\n      <div className=\"grid grid-cols-2 gap-2\">\n        <div>\n          <label className=\"block text-xs font-semibold mb-1\">Font</label>\n          <select\n            value={settings.fontFamily}\n            onChange={(e) => onChange({ ...settings, fontFamily: e.target.value })}\n            className=\"w-full rounded border border-slate-300 px-2 py-1 text-sm bg-white\"\n          >\n            {allFonts.map((font) => (\n              <option key={font.value} value={font.value}>\n                {font.label}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div>\n          <label className=\"block text-xs font-semibold mb-1\">Size: {settings.fontSize}px</label>\n          <input\n            type=\"range\"\n            min={12}\n            max={72}\n            value={settings.fontSize}\n            onChange={(e) => onChange({ ...settings, fontSize: Number(e.target.value) })}\n            className=\"w-full\"\n          />\n        </div>\n      </div>\n\n      <div className=\"flex items-center gap-2\">\n        <input\n          id={`${label}-shadow-toggle`}\n          type=\"checkbox\"\n          checked={settings.shadowEnabled !== false}\n          onChange={(e) => onChange({ ...settings, shadowEnabled: e.target.checked })}\n          className=\"h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500\"\n        />\n        <label htmlFor={`${label}-shadow-toggle`} className=\"text-xs font-semibold text-slate-700\">\n          Shadow\n        </label>\n      </div>\n\n      <div>\n        <label className=\"block text-xs font-semibold mb-1\">Align</label>\n        <div className=\"flex gap-1\">\n          {TEXT_ALIGNMENTS.map((a) => (\n            <button\n              key={a.value}\n              type=\"button\"\n              onClick={() => {\n                if (onAlignmentChange) {\n                  onAlignmentChange(a.value);\n                } else {\n                  onChange({ ...settings, textAlign: a.value });\n                }\n              }}\n              className={`flex-1 px-2 py-1 text-xs rounded border transition-colors ${\n                settings.textAlign === a.value\n                  ? \"bg-blue-500 text-white border-blue-500\"\n                  : \"bg-white text-slate-700 border-slate-300 hover:bg-slate-50\"\n              }`}\n            >\n              {a.label}\n            </button>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default function TimestampSettings({\n  textColor,\n  onTextColorChange,\n  shadowColor,\n  onShadowColorChange,\n  shadowBlur,\n  onShadowBlurChange,\n  shadowOffsetX,\n  onShadowOffsetXChange,\n  shadowOffsetY,\n  onShadowOffsetYChange,\n  scale,\n  onScaleChange,\n  translateX,\n  onTranslateXChange,\n  translateY,\n  onTranslateYChange,\n  rotation,\n  onRotationChange,\n  onResetPosition,\n  customFonts,\n  onAddCustomFont,\n  timeSettings,\n  onTimeSettingsChange,\n  dateSettings,\n  onDateSettingsChange,\n  locationSettings,\n  onLocationSettingsChange,\n  onTimeAlignmentChange,\n  onDateAlignmentChange,\n  onLocationAlignmentChange,\n  onSavePreset,\n  onLoadPreset,\n  onAddImageOverlay,\n  onClose,\n}: TimestampSettingsProps) {\n  const [viewport, setViewport] = useState({ width: window.innerWidth, height: window.innerHeight });\n  const [presets, setPresets] = useState<TimestampPreset[]>([]);\n  const [presetName, setPresetName] = useState(\"\");\n  const [selectedPresetId, setSelectedPresetId] = useState<string>(\"\");\n  const [rotationInput, setRotationInput] = useState(String(rotation));\n  useEffect(() => {\n    const handleResize = () => {\n      setViewport({ width: window.innerWidth, height: window.innerHeight });\n    };\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n\n  useEffect(() => {\n    setPresets(loadPresets());\n  }, []);\n\n  useEffect(() => {\n    setRotationInput(String(rotation));\n  }, [rotation]);\n\n  const refreshPresets = () => setPresets(loadPresets());\n\n  const isNarrow = viewport.width < 640;\n  const initialPos = isNarrow\n    ? { x: 20, y: viewport.height - 620 }\n    : { x: viewport.width - 360, y: 80 };\n\n  const handleZoomIn = () => onScaleChange(Math.min(5, scale + 0.1));\n  const handleZoomOut = () => onScaleChange(Math.max(0.1, scale - 0.1));\n\n  const handleRotationInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setRotationInput(e.target.value);\n  };\n\n  const handleRotationInputBlur = () => {\n    const val = parseFloat(rotationInput);\n    if (!isNaN(val)) {\n      onRotationChange(((val % 360) + 360) % 360);\n    } else {\n      setRotationInput(String(rotation));\n    }\n  };\n\n  const handleFontUpload = () => {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \".ttf,.otf,.woff,.woff2\";\n    input.onchange = (e) => {\n      const file = (e.target as HTMLInputElement).files?.[0];\n      if (file) {\n        const fontName = file.name.replace(/\\.(ttf|otf|woff2?)$/i, \"\");\n        const reader = new FileReader();\n        reader.onload = () => {\n          const dataUrl = reader.result as string;\n          onAddCustomFont(fontName, dataUrl);\n        };\n        reader.readAsDataURL(file);\n      }\n    };\n    input.click();\n  };\n\n  const handleSavePreset = () => {\n    if (!presetName.trim()) return;\n    onSavePreset(presetName.trim());\n    setPresetName(\"\");\n    refreshPresets();\n  };\n\n  const handleLoadPreset = () => {\n    const preset = presets.find((p) => p.id === selectedPresetId);\n    if (preset) onLoadPreset(preset);\n  };\n\n  const handleDeletePreset = () => {\n    if (!selectedPresetId) return;\n    deletePreset(selectedPresetId);\n    setSelectedPresetId(\"\");\n    refreshPresets();\n  };\n\n  const sections = [\n    {\n      id: \"general\",\n      title: \"General Settings\",\n      defaultOpen: false,\n      content: (\n        <div className=\"space-y-4 text-slate-800\">\n          <div className=\"grid grid-cols-2 gap-3\">\n            <div>\n              <label className=\"block text-xs font-semibold mb-1\">Text Color</label>\n              <div className=\"flex items-center gap-2\">\n                <input\n                  type=\"color\"\n                  value={textColor}\n                  onChange={(e) => onTextColorChange(e.target.value)}\n                  className=\"h-8 w-10 rounded border border-slate-300 bg-white cursor-pointer\"\n                />\n                <span className=\"text-xs text-slate-600\">{textColor}</span>\n              </div>\n            </div>\n            <div>\n              <label className=\"block text-xs font-semibold mb-1\">Shadow Color</label>\n              <div className=\"flex items-center gap-2\">\n                <input\n                  type=\"color\"\n                  value={shadowColor}\n                  onChange={(e) => onShadowColorChange(e.target.value)}\n                  className=\"h-8 w-10 rounded border border-slate-300 bg-white cursor-pointer\"\n                />\n                <span className=\"text-xs text-slate-600\">{shadowColor}</span>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <label className=\"block text-xs font-semibold\">Shadow: Blur {shadowBlur}px</label>\n            <input\n              type=\"range\"\n              min={0}\n              max={20}\n              value={shadowBlur}\n              onChange={(e) => onShadowBlurChange(Number(e.target.value))}\n              className=\"w-full\"\n            />\n            <div className=\"grid grid-cols-2 gap-2\">\n              <div>\n                <label className=\"block text-xs text-slate-600 mb-1\">Offset X: {shadowOffsetX}px</label>\n                <input\n                  type=\"range\"\n                  min={-10}\n                  max={10}\n                  value={shadowOffsetX}\n                  onChange={(e) => onShadowOffsetXChange(Number(e.target.value))}\n                  className=\"w-full\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-xs text-slate-600 mb-1\">Offset Y: {shadowOffsetY}px</label>\n                <input\n                  type=\"range\"\n                  min={-10}\n                  max={10}\n                  value={shadowOffsetY}\n                  onChange={(e) => onShadowOffsetYChange(Number(e.target.value))}\n                  className=\"w-full\"\n                />\n              </div>\n            </div>\n          </div>\n\n          <div className=\"border-t border-slate-200 pt-3\">\n            <label className=\"block text-xs font-semibold mb-2\">Image Zoom</label>\n            <div className=\"flex items-center gap-2\">\n              <button\n                type=\"button\"\n                onClick={handleZoomOut}\n                className=\"flex h-7 w-7 items-center justify-center rounded border border-slate-300 bg-white text-slate-700 hover:bg-slate-50 font-bold text-sm\"\n              >\n                -\n              </button>\n              <input\n                type=\"range\"\n                min={0.1}\n                max={5}\n                step={0.1}\n                value={scale}\n                onChange={(e) => onScaleChange(Number(e.target.value))}\n                className=\"flex-1\"\n              />\n              <button\n                type=\"button\"\n                onClick={handleZoomIn}\n                className=\"flex h-7 w-7 items-center justify-center rounded border border-slate-300 bg-white text-slate-700 hover:bg-slate-50 font-bold text-sm\"\n              >\n                +\n              </button>\n            </div>\n            <div className=\"mt-1 text-xs text-slate-600 text-center\">{Math.round(scale * 100)}%</div>\n          </div>\n\n          <div className=\"border-t border-slate-200 pt-3\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <label className=\"block text-xs font-semibold\">Image Position</label>\n              <button\n                type=\"button\"\n                onClick={onResetPosition}\n                className=\"text-xs px-2 py-1 rounded border border-slate-300 bg-white text-slate-700 hover:bg-slate-50\"\n              >\n                Reset\n              </button>\n            </div>\n            <div className=\"grid grid-cols-2 gap-2\">\n              <div>\n                <label className=\"block text-xs text-slate-600 mb-1\">X: {translateX}px</label>\n                <input\n                  type=\"range\"\n                  min={-500}\n                  max={500}\n                  value={translateX}\n                  onChange={(e) => onTranslateXChange(Number(e.target.value))}\n                  className=\"w-full\"\n                />\n              </div>\n              <div>\n                <label className=\"block text-xs text-slate-600 mb-1\">Y: {translateY}px</label>\n                <input\n                  type=\"range\"\n                  min={-500}\n                  max={500}\n                  value={translateY}\n                  onChange={(e) => onTranslateYChange(Number(e.target.value))}\n                  className=\"w-full\"\n                />\n              </div>\n            </div>\n          </div>\n\n          <div className=\"border-t border-slate-200 pt-3\">\n            <label className=\"block text-xs font-semibold mb-2\">Image Rotation</label>\n            <div className=\"flex items-center gap-2\">\n              <input\n                type=\"text\"\n                value={rotationInput}\n                onChange={handleRotationInputChange}\n                onBlur={handleRotationInputBlur}\n                className=\"w-16 rounded border border-slate-300 px-2 py-1 text-sm text-center\"\n              />\n              <span className=\"text-xs text-slate-600\">deg</span>\n              <input\n                type=\"range\"\n                min={0}\n                max={360}\n                value={rotation}\n                onChange={(e) => onRotationChange(Number(e.target.value))}\n                className=\"flex-1\"\n              />\n            </div>\n          </div>\n\n          <div className=\"border-t border-slate-200 pt-3\">\n            <label className=\"block text-xs font-semibold mb-2\">Custom Font</label>\n            <button\n              type=\"button\"\n              onClick={handleFontUpload}\n              className=\"w-full px-3 py-2 text-sm rounded border border-slate-300 bg-white text-slate-700 hover:bg-slate-50\"\n            >\n              Upload Font (.ttf, .otf, .woff)\n            </button>\n            {customFonts.length > 0 && (\n              <div className=\"mt-2 text-xs text-slate-600\">\n                Loaded: {customFonts.join(\", \")}\n              </div>\n            )}\n          </div>\n\n          {onAddImageOverlay && (\n            <div className=\"border-t border-slate-200 pt-3\">\n              <label className=\"block text-xs font-semibold mb-2\">Image Overlay</label>\n              <button\n                type=\"button\"\n                onClick={onAddImageOverlay}\n                className=\"w-full px-3 py-2 text-sm rounded border border-green-500 bg-green-500 text-white hover:bg-green-600\"\n              >\n                Add Image Overlay\n              </button>\n              <p className=\"mt-1 text-xs text-slate-500\">Upload an image to place on your photo</p>\n            </div>\n          )}\n\n          <div className=\"border-t border-slate-200 pt-3\">\n            <label className=\"block text-xs font-semibold mb-2\">Presets</label>\n            <div className=\"space-y-2\">\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"text\"\n                  value={presetName}\n                  onChange={(e) => setPresetName(e.target.value)}\n                  placeholder=\"Preset name...\"\n                  className=\"flex-1 rounded border border-slate-300 px-2 py-1 text-sm\"\n                />\n                <button\n                  type=\"button\"\n                  onClick={handleSavePreset}\n                  disabled={!presetName.trim()}\n                  className=\"px-3 py-1 text-sm rounded border border-blue-500 bg-blue-500 text-white hover:bg-blue-600 disabled:opacity-50\"\n                >\n                  Save\n                </button>\n              </div>\n              {presets.length > 0 && (\n                <div className=\"flex gap-2\">\n                  <select\n                    value={selectedPresetId}\n                    onChange={(e) => setSelectedPresetId(e.target.value)}\n                    className=\"flex-1 rounded border border-slate-300 px-2 py-1 text-sm bg-white\"\n                  >\n                    <option value=\"\">Select preset...</option>\n                    {presets.map((p) => (\n                      <option key={p.id} value={p.id}>\n                        {p.name}\n                      </option>\n                    ))}\n                  </select>\n                  <button\n                    type=\"button\"\n                    onClick={handleLoadPreset}\n                    disabled={!selectedPresetId}\n                    className=\"px-3 py-1 text-sm rounded border border-slate-300 bg-white text-slate-700 hover:bg-slate-50 disabled:opacity-50\"\n                  >\n                    Load\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={handleDeletePreset}\n                    disabled={!selectedPresetId}\n                    className=\"px-3 py-1 text-sm rounded border border-red-300 bg-white text-red-600 hover:bg-red-50 disabled:opacity-50\"\n                  >\n                    Del\n                  </button>\n                </div>\n              )}\n              {presets.length === 0 && (\n                <p className=\"text-xs text-slate-500 italic\">No presets saved yet</p>\n              )}\n            </div>\n          </div>\n        </div>\n      ),\n    },\n    {\n      id: \"time\",\n      title: \"Time Settings\",\n      defaultOpen: false,\n      content: (\n        <OverlaySection\n          label=\"Time\"\n          settings={timeSettings}\n          onChange={onTimeSettingsChange}\n          customFonts={customFonts}\n          formatType=\"time\"\n          onAlignmentChange={onTimeAlignmentChange}\n        />\n      ),\n    },\n    {\n      id: \"date\",\n      title: \"Date Settings\",\n      defaultOpen: false,\n      content: (\n        <OverlaySection\n          label=\"Date\"\n          settings={dateSettings}\n          onChange={onDateSettingsChange}\n          customFonts={customFonts}\n          formatType=\"date\"\n          onAlignmentChange={onDateAlignmentChange}\n        />\n      ),\n    },\n    {\n      id: \"location\",\n      title: \"Location Settings\",\n      defaultOpen: false,\n      content: (\n        <OverlaySection\n          label=\"Location\"\n          settings={locationSettings}\n          onChange={onLocationSettingsChange}\n          customFonts={customFonts}\n          onAlignmentChange={onLocationAlignmentChange}\n        />\n      ),\n    },\n  ];\n\n  return (\n    <FloatingWindowTemplate\n      title=\"Settings\"\n      initialPos={initialPos}\n      initialSize={{ width: 340, height: 600 }}\n      minWidth={300}\n      minHeight={400}\n      onClose={onClose}\n    >\n      <div className=\"overflow-y-auto max-h-[520px] pr-1\">\n        <Accordion sections={sections} allowMultiple />\n      </div>\n    </FloatingWindowTemplate>\n  );\n}\n","path":null,"size_bytes":20853,"size_tokens":null},"shared/component/switch_switch-cards-2.tsx":{"content":"\"use client\";\n\nimport { PlusIcon } from \"lucide-react\";\n\nimport { Label } from \"@/components/ui/label\";\nimport { Switch } from \"@/components/ui/switch\";\n\nexport const title = \"Feature Card\";\n\nconst Example = () => (\n  <div className=\"flex items-start gap-3 rounded-lg border bg-background p-4\">\n    <div className=\"flex size-10 shrink-0 items-center justify-center rounded-lg bg-green-500\">\n      <PlusIcon className=\"size-5 text-white\" />\n    </div>\n    <div className=\"flex flex-1 flex-col gap-1\">\n      <div className=\"flex items-center justify-between gap-4\">\n        <Label className=\"font-medium\" htmlFor=\"feature-toggle\">\n          Enable Feature\n        </Label>\n        <Switch id=\"feature-toggle\" />\n      </div>\n      <p className=\"text-muted-foreground text-sm\">\n        A short description goes here.\n      </p>\n    </div>\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":873,"size_tokens":null},"shared/component/toggle-group_toggle-group-standard-3.tsx":{"content":"\"use client\";\n\nimport { AlignCenterIcon, AlignLeftIcon, AlignRightIcon } from \"lucide-react\";\n\nimport { ToggleGroup, ToggleGroupItem } from \"@/components/ui/toggle-group\";\n\nexport const title = \"Single Selection Toggle Group\";\n\nconst Example = () => (\n  <ToggleGroup type=\"single\" variant=\"outline\">\n    <ToggleGroupItem aria-label=\"Align left\" value=\"left\">\n      <AlignLeftIcon />\n    </ToggleGroupItem>\n    <ToggleGroupItem aria-label=\"Align center\" value=\"center\">\n      <AlignCenterIcon />\n    </ToggleGroupItem>\n    <ToggleGroupItem aria-label=\"Align right\" value=\"right\">\n      <AlignRightIcon />\n    </ToggleGroupItem>\n  </ToggleGroup>\n);\n\nexport default Example;\n","path":null,"size_bytes":672,"size_tokens":null},"shared/component/accordion_accordion-multi-level-2.tsx":{"content":"import { faker } from \"@faker-js/faker\";\nimport { ChevronDown, FileText, Folder, Settings, Users } from \"lucide-react\";\nimport type { ReactNode } from \"react\";\n\nimport {\n  Accordion,\n  AccordionContent,\n  AccordionItem,\n  AccordionTrigger,\n} from \"@/components/ui/accordion\";\nimport {\n  Collapsible,\n  CollapsibleContent,\n  CollapsibleTrigger,\n} from \"@/components/ui/collapsible\";\n\nexport const title = \"Multi-level with Icon\";\n\nconst icons = [FileText, Folder, Settings, Users];\n\nconst items: {\n  id: string;\n  title: string;\n  icon: ReactNode;\n  collapsibles: {\n    id: string;\n    title: string;\n    content: string;\n    open?: boolean;\n  }[];\n}[] = [];\n\nfor (let i = 0; i < 4; i++) {\n  const Icon = icons[i];\n  items.push({\n    id: faker.string.uuid(),\n    title: faker.company.catchPhrase(),\n    icon: <Icon className=\"size-4 text-muted-foreground\" />,\n    collapsibles: new Array(2).fill(0).map(() => ({\n      id: faker.string.uuid(),\n      title: faker.company.catchPhrase(),\n      content: faker.lorem.paragraph(),\n    })),\n  });\n}\n\nconst Example = () => (\n  <Accordion\n    className=\"-space-y-1 w-full max-w-md\"\n    collapsible\n    defaultValue={items[0].id}\n    type=\"single\"\n  >\n    {items.map((item) => (\n      <AccordionItem\n        className=\"overflow-hidden border bg-background first:rounded-t-lg last:rounded-b-lg last:border-b\"\n        key={item.id}\n        value={item.id}\n      >\n        <AccordionTrigger className=\"px-4 py-3 hover:no-underline\">\n          <div className=\"flex items-center gap-2\">\n            {item.icon}\n            {item.title}\n          </div>\n        </AccordionTrigger>\n        <AccordionContent className=\"p-0\">\n          {item.collapsibles.map((collapsible) => (\n            <Collapsible\n              className=\"space-y-1 border-border border-t bg-accent px-4 py-3\"\n              defaultOpen={collapsible.open}\n              key={collapsible.id}\n            >\n              <CollapsibleTrigger className=\"flex gap-2 font-medium [&[data-state=open]>svg]:rotate-180\">\n                <ChevronDown\n                  aria-hidden=\"true\"\n                  className=\"mt-1 shrink-0 opacity-60 transition-transform duration-200\"\n                  size={16}\n                  strokeWidth={2}\n                />\n                {collapsible.title}\n              </CollapsibleTrigger>\n              <CollapsibleContent className=\"overflow-hidden ps-6 text-muted-foreground text-sm transition-all data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down\">\n                {collapsible.content}\n              </CollapsibleContent>\n            </Collapsible>\n          ))}\n        </AccordionContent>\n      </AccordionItem>\n    ))}\n  </Accordion>\n);\n\nexport default Example;\n","path":null,"size_bytes":2738,"size_tokens":null},"meng/netlify.toml":{"content":"[build]\n  base = \".\"\n  command = \"npm run build --workspace meng\"\n  publish = \"dist\"\n\n[[redirects]]\n  from = \"/*\"\n  to = \"/index.html\"\n  status = 200\n\n[[headers]]\n  # Basic security hardening\n  for = \"/*\"\n  [headers.values]\n    X-Content-Type-Options = \"nosniff\"\n    Referrer-Policy = \"strict-origin-when-cross-origin\"\n    X-Frame-Options = \"DENY\"\n    Permissions-Policy = \"camera=(), microphone=(), geolocation=()\"\n    Cache-Control = \"no-store\"\n    Content-Security-Policy = \"default-src 'self'; base-uri 'self'; object-src 'none'; frame-ancestors 'none'; upgrade-insecure-requests; script-src 'self' 'wasm-unsafe-eval'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https://images.unsplash.com https://images.pexels.com; font-src 'self' data:; connect-src 'self' data: https://images.unsplash.com https://images.pexels.com; media-src 'self' blob:; worker-src 'self' blob:\"\n\n[[headers]]\n  for = \"/assets/*\"\n  [headers.values]\n    Cache-Control = \"public, max-age=31536000, immutable\"\n","path":null,"size_bytes":995,"size_tokens":null},"shared/component/carousel_carousel-standard-2.tsx":{"content":"\"use client\";\n\nimport { faker } from \"@faker-js/faker\";\nimport { useState } from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Carousel,\n  type CarouselApi,\n  CarouselContent,\n  CarouselItem,\n} from \"@/components/ui/carousel\";\n\nexport const title = \"Carousel with Thumbnails\";\n\nconst slides = Array.from({ length: 5 }, (_, index) => ({\n  id: index + 1,\n  image: faker.image.urlPicsumPhotos({ width: 800, height: 400 }),\n}));\n\nconst Example = () => {\n  const [api, setApi] = useState<CarouselApi>();\n  const [current, setCurrent] = useState(0);\n\n  const handleApiChange = (newApi: CarouselApi) => {\n    setApi(newApi);\n\n    if (newApi) {\n      setCurrent(newApi.selectedScrollSnap());\n\n      newApi.on(\"select\", () => {\n        setCurrent(newApi.selectedScrollSnap());\n      });\n    }\n  };\n\n  return (\n    <div className=\"mx-auto w-full max-w-md space-y-4\">\n      <Carousel setApi={handleApiChange}>\n        <CarouselContent>\n          {slides.map((slide) => (\n            <CarouselItem key={slide.id}>\n              <div className=\"flex aspect-[2/1] items-center justify-center rounded-md border bg-background\">\n                <span className=\"font-semibold text-4xl\">{slide.id}</span>\n              </div>\n            </CarouselItem>\n          ))}\n        </CarouselContent>\n      </Carousel>\n\n      <div className=\"flex justify-center gap-2\">\n        {slides.map((slide, index) => (\n          <Button\n            key={slide.id}\n            onClick={() => api?.scrollTo(index)}\n            variant={current === index ? \"default\" : \"outline\"}\n          >\n            {slide.id}\n          </Button>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":1692,"size_tokens":null},"shared/component/input-group_input-group-custom-1.tsx":{"content":"import {\n  InputGroup,\n  InputGroupAddon,\n  InputGroupButton,\n  InputGroupTextarea,\n} from \"@/components/ui/input-group\";\n\nexport const title = \"Textarea with Actions\";\n\nconst Example = () => (\n  <InputGroup className=\"w-full max-w-sm bg-background\">\n    <InputGroupTextarea\n      className=\"min-h-[100px]\"\n      placeholder=\"Type your message...\"\n    />\n    <InputGroupAddon align=\"block-end\">\n      <InputGroupButton className=\"ml-auto\" size=\"sm\" variant=\"default\">\n        Submit\n      </InputGroupButton>\n    </InputGroupAddon>\n  </InputGroup>\n);\n\nexport default Example;\n","path":null,"size_bytes":576,"size_tokens":null},"yuzha/src/index.css":{"content":"@import \"../../shared/fonts/taimingda.css\";\n/* Tailwind entry for Launcher (minimal, global-safe) */\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* Baseline reset tweaks */\nhtml,\nbody,\n#root {\n  height: 100%;\n}\n\n/* App shell */\n.app-shell {\n  @apply w-screen h-screen overflow-hidden text-neutral-100 select-none;\n}\n\n/* Simple toolbar (optional, used later) */\n.app-toolbar {\n  @apply fixed top-0 inset-x-0 z-50 flex items-center gap-2 px-3 py-2\n         bg-neutral-900/70 backdrop-blur-sm;\n}\n\n.btn {\n  @apply inline-flex items-center gap-1 px-3 py-1.5 rounded\n         bg-neutral-800 hover:bg-neutral-700 active:bg-neutral-600\n         text-sm leading-none;\n}\n\n.badge {\n  @apply text-xs px-2 py-0.5 rounded bg-neutral-800/60;\n}\n@keyframes pulse {\n  0% {\n    transform: none;\n    opacity: 1;\n  }\n  50% {\n    transform: scale(1.02);\n    opacity: 0.95;\n  }\n  100% {\n    transform: none;\n    opacity: 1;\n  }\n}\n\n/* Custom scrollbar for accordion */\n.accordion-scroll::-webkit-scrollbar {\n  width: 8px;\n}\n\n.accordion-scroll::-webkit-scrollbar-track {\n  background: #e5e7eb; /* gray-200 */\n  border-radius: 10px;\n}\n\n.accordion-scroll::-webkit-scrollbar-thumb {\n  background: #3b82f6; /* blue-500 */\n  border-radius: 10px;\n}\n\n.accordion-scroll::-webkit-scrollbar-thumb:hover {\n  background: #2563eb; /* blue-600 */\n}\n\n@keyframes orbit {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n/* Stage DOM renderer keyframes (GPU-driven orbit/spin) */\n@keyframes stage-orbit {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes stage-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n/* Disable long-press callout and selection on UI images (counter screen only) */\n.counter-no-context img {\n  -webkit-touch-callout: none;\n  -webkit-user-drag: none;\n  user-select: none;\n}\n\n/* Remove outlines/borders/tap highlight for the floating counter button */\n.counter-floating button {\n  outline: none;\n  border: none;\n  background: transparent;\n  -webkit-tap-highlight-color: transparent;\n  box-shadow: none;\n}\n\n.counter-floating button:focus-visible {\n  outline: none;\n}\n\n/* Count bump animation */\n@keyframes count-bump-keyframes {\n  0% {\n    transform: scale(1);\n  }\n  40% {\n    transform: scale(1.08);\n  }\n  100% {\n    transform: scale(1);\n  }\n}\n\n.count-bump {\n  animation: count-bump-keyframes 0.25s ease-out;\n}\n","path":null,"size_bytes":2439,"size_tokens":null},"shared/floating/FloatingBorderless.tsx":{"content":"import React, { useEffect, useRef, useState } from \"react\";\nimport type { CSSProperties, ReactNode } from \"react\";\n\ntype Position = { x: number; y: number };\ntype Size = { width: number; height: number };\ntype ResizeHandle = \"n\" | \"s\" | \"e\" | \"w\" | \"ne\" | \"nw\" | \"se\" | \"sw\" | null;\n\nexport type BoundingRect = { x: number; y: number; width: number; height: number };\n\nexport type FloatingBorderlessProps = {\n  children: ReactNode;\n  initialPos?: Position;\n  initialSize?: Size;\n  /** Controlled position; if provided, internal position will sync to this. */\n  pos?: Position;\n  /** Controlled size; if provided, internal size will sync to this. */\n  size?: Size;\n  minWidth?: number;\n  minHeight?: number;\n  zIndex?: number;\n  onChange?: (pos: Position, size: Size) => void;\n  className?: string;\n  style?: CSSProperties;\n  /** Delay before drag activates (ms). Useful to avoid accidental drags on tap. */\n  dragDelayMs?: number;\n  /** Custom bounding rect to clamp within instead of viewport. Coordinates are absolute screen position. */\n  boundingRect?: BoundingRect;\n  /** If true, disable resize handles */\n  disableResize?: boolean;\n};\n\n/**\n * FloatingBorderless - chrome-free draggable + resizable container.\n * Reuses the drag/resize mechanics from FloatingWindowTemplate but without header or background.\n */\nexport default function FloatingBorderless({\n  children,\n  initialPos = { x: 120, y: 120 },\n  initialSize = { width: 240, height: 120 },\n  pos,\n  size: controlledSize,\n  minWidth = 80,\n  minHeight = 60,\n  zIndex = 1000,\n  onChange,\n  className,\n  style,\n  dragDelayMs = 0,\n  boundingRect,\n  disableResize = false,\n}: FloatingBorderlessProps) {\n  const viewportMargin = 8;\n\n  const getBounds = () => {\n    if (boundingRect) {\n      return {\n        minX: boundingRect.x,\n        minY: boundingRect.y,\n        maxWidth: boundingRect.width,\n        maxHeight: boundingRect.height,\n      };\n    }\n    return {\n      minX: viewportMargin,\n      minY: viewportMargin,\n      maxWidth: window.innerWidth - viewportMargin * 2,\n      maxHeight: window.innerHeight - viewportMargin * 2,\n    };\n  };\n  // Use controlled pos/size as initial value if provided, otherwise use initialPos/initialSize\n  const [position, setPosition] = useState<Position>(pos ?? initialPos);\n  const [size, setSize] = useState<Size>(controlledSize ?? initialSize);\n  const [isDragging, setIsDragging] = useState(false);\n  const [isResizing, setIsResizing] = useState(false);\n  const [activeHandle, setActiveHandle] = useState<ResizeHandle>(null);\n  const dragStartRef = useRef<Position>({ x: 0, y: 0 });\n  const resizeStartRef = useRef<{ pos: Position; size: Size }>({\n    pos: { x: 0, y: 0 },\n    size: { width: 0, height: 0 },\n  });\n  const dragTimerRef = useRef<number | null>(null);\n\n  const onChangeRef = useRef(onChange);\n  onChangeRef.current = onChange;\n\n  // Track if we're currently syncing from parent to avoid feedback loops\n  const isSyncingFromParentRef = useRef(false);\n  const prevPosRef = useRef<Position | null>(null);\n  const prevSizeRef = useRef<Size | null>(null);\n\n  // Report changes to parent - but only when not syncing from parent\n  useEffect(() => {\n    if (isSyncingFromParentRef.current) {\n      isSyncingFromParentRef.current = false;\n      return;\n    }\n    \n    const posChanged = prevPosRef.current === null || prevPosRef.current.x !== position.x || prevPosRef.current.y !== position.y;\n    const sizeChanged = prevSizeRef.current === null || prevSizeRef.current.width !== size.width || prevSizeRef.current.height !== size.height;\n    \n    if (posChanged || sizeChanged) {\n      prevPosRef.current = { ...position };\n      prevSizeRef.current = { ...size };\n      onChangeRef.current?.(position, size);\n    }\n  }, [position, size]);\n\n  // Sync controlled position from parent - use functional update to compare with current state\n  const posX = pos?.x;\n  const posY = pos?.y;\n  useEffect(() => {\n    if (posX !== undefined && posY !== undefined) {\n      setPosition((prev) => {\n        if (prev.x === posX && prev.y === posY) return prev;\n        isSyncingFromParentRef.current = true;\n        return { x: posX, y: posY };\n      });\n    }\n  }, [posX, posY]);\n\n  const ctrlW = controlledSize?.width;\n  const ctrlH = controlledSize?.height;\n  useEffect(() => {\n    if (ctrlW !== undefined && ctrlH !== undefined) {\n      setSize((prev) => {\n        if (prev.width === ctrlW && prev.height === ctrlH) return prev;\n        isSyncingFromParentRef.current = true;\n        return { width: ctrlW, height: ctrlH };\n      });\n    }\n  }, [ctrlW, ctrlH]);\n\n  const startDrag = (e: React.PointerEvent<HTMLDivElement>) => {\n    if ((e.target as HTMLElement).closest(\".fb-resize\")) return;\n    const delay = Math.max(0, dragDelayMs);\n    if (delay === 0) {\n      setIsDragging(true);\n      dragStartRef.current = { x: e.clientX - position.x, y: e.clientY - position.y };\n    } else {\n      dragTimerRef.current = window.setTimeout(() => {\n        setIsDragging(true);\n        dragStartRef.current = { x: e.clientX - position.x, y: e.clientY - position.y };\n      }, delay);\n    }\n    e.currentTarget.setPointerCapture(e.pointerId);\n  };\n\n  const onDrag = (e: PointerEvent) => {\n    if (!isDragging) return;\n    const bounds = getBounds();\n    const maxX = Math.max(0, bounds.minX + bounds.maxWidth - size.width);\n    const maxY = Math.max(0, bounds.minY + bounds.maxHeight - size.height);\n    const newX = Math.max(bounds.minX, Math.min(e.clientX - dragStartRef.current.x, maxX));\n    const newY = Math.max(bounds.minY, Math.min(e.clientY - dragStartRef.current.y, maxY));\n    setPosition({ x: newX, y: newY });\n  };\n  const endDrag = () => {\n    if (dragTimerRef.current !== null) {\n      window.clearTimeout(dragTimerRef.current);\n      dragTimerRef.current = null;\n    }\n    setIsDragging(false);\n  };\n\n  const startResize = (e: React.PointerEvent<HTMLDivElement>, handle: ResizeHandle) => {\n    e.stopPropagation();\n    setIsResizing(true);\n    setActiveHandle(handle);\n    resizeStartRef.current = { pos: { x: e.clientX, y: e.clientY }, size: { ...size } };\n    e.currentTarget.setPointerCapture(e.pointerId);\n  };\n\n  const onResize = (e: PointerEvent) => {\n    if (!isResizing || !activeHandle) return;\n    const bounds = getBounds();\n    const { size: startSize, pos: startPos } = resizeStartRef.current;\n    const deltaX = e.clientX - startPos.x;\n    const deltaY = e.clientY - startPos.y;\n    let { width, height } = startSize;\n    let { x, y } = position;\n\n    if (activeHandle.includes(\"e\")) width = Math.max(minWidth, startSize.width + deltaX);\n    if (activeHandle.includes(\"s\")) height = Math.max(minHeight, startSize.height + deltaY);\n    if (activeHandle.includes(\"w\")) {\n      const proposed = startSize.width - deltaX;\n      if (proposed >= minWidth) {\n        width = proposed;\n        x = position.x + deltaX;\n      }\n    }\n    if (activeHandle.includes(\"n\")) {\n      const proposed = startSize.height - deltaY;\n      if (proposed >= minHeight) {\n        height = proposed;\n        y = position.y + deltaY;\n      }\n    }\n\n    const maxX = Math.max(0, bounds.minX + bounds.maxWidth - width);\n    const maxY = Math.max(0, bounds.minY + bounds.maxHeight - height);\n    x = Math.max(bounds.minX, Math.min(x, maxX));\n    y = Math.max(bounds.minY, Math.min(y, maxY));\n\n    setSize({ width, height });\n    setPosition({ x, y });\n  };\n  const endResize = () => {\n    setIsResizing(false);\n    setActiveHandle(null);\n  };\n\n  useEffect(() => {\n    if (isDragging) {\n      window.addEventListener(\"pointermove\", onDrag);\n      window.addEventListener(\"pointerup\", endDrag);\n      return () => {\n        window.removeEventListener(\"pointermove\", onDrag);\n        window.removeEventListener(\"pointerup\", endDrag);\n      };\n    }\n  }, [isDragging, position, size]);\n\n  useEffect(() => {\n    if (isResizing) {\n      window.addEventListener(\"pointermove\", onResize);\n      window.addEventListener(\"pointerup\", endResize);\n      return () => {\n        window.removeEventListener(\"pointermove\", onResize);\n        window.removeEventListener(\"pointerup\", endResize);\n      };\n    }\n  }, [isResizing, activeHandle, position, size]);\n\n  const boundingX = boundingRect?.x;\n  const boundingY = boundingRect?.y;\n  const boundingW = boundingRect?.width;\n  const boundingH = boundingRect?.height;\n\n  // Use ref to track current size for clampToBounds without creating dependency loop\n  const sizeRef = useRef(size);\n  sizeRef.current = size;\n\n  useEffect(() => {\n    const clampToBounds = () => {\n      const bounds = getBounds();\n      const currentSize = sizeRef.current;\n      \n      setSize((prev) => {\n        const newW = Math.min(Math.max(prev.width, minWidth), Math.max(0, bounds.maxWidth));\n        const newH = Math.min(Math.max(prev.height, minHeight), Math.max(0, bounds.maxHeight));\n        if (prev.width === newW && prev.height === newH) return prev;\n        return { width: newW, height: newH };\n      });\n      \n      setPosition((prev) => {\n        const newX = Math.min(Math.max(prev.x, bounds.minX), Math.max(bounds.minX, bounds.minX + bounds.maxWidth - currentSize.width));\n        const newY = Math.min(Math.max(prev.y, bounds.minY), Math.max(bounds.minY, bounds.minY + bounds.maxHeight - currentSize.height));\n        if (prev.x === newX && prev.y === newY) return prev;\n        return { x: newX, y: newY };\n      });\n    };\n    clampToBounds();\n    window.addEventListener(\"resize\", clampToBounds);\n    return () => window.removeEventListener(\"resize\", clampToBounds);\n  }, [minWidth, minHeight, boundingX, boundingY, boundingW, boundingH]);\n\n  const handleSize = 8;\n  const edgeSize = 6;\n  const baseHandleStyle: CSSProperties = { position: \"absolute\", touchAction: \"none\" };\n  const handles: Array<{ h: ResizeHandle; style: CSSProperties; cursor: string }> = [\n    { h: \"n\", style: { top: 0, left: 0, right: 0, height: edgeSize }, cursor: \"ns-resize\" },\n    { h: \"s\", style: { bottom: 0, left: 0, right: 0, height: edgeSize }, cursor: \"ns-resize\" },\n    { h: \"e\", style: { right: 0, top: 0, bottom: 0, width: edgeSize }, cursor: \"ew-resize\" },\n    { h: \"w\", style: { left: 0, top: 0, bottom: 0, width: edgeSize }, cursor: \"ew-resize\" },\n    { h: \"ne\", style: { top: 0, right: 0, width: handleSize, height: handleSize }, cursor: \"nesw-resize\" },\n    { h: \"nw\", style: { top: 0, left: 0, width: handleSize, height: handleSize }, cursor: \"nwse-resize\" },\n    { h: \"se\", style: { bottom: 0, right: 0, width: handleSize, height: handleSize }, cursor: \"nwse-resize\" },\n    { h: \"sw\", style: { bottom: 0, left: 0, width: handleSize, height: handleSize }, cursor: \"nesw-resize\" },\n  ];\n\n  const containerStyle: CSSProperties = {\n    position: \"fixed\",\n    left: `${position.x}px`,\n    top: `${position.y}px`,\n    width: `${size.width}px`,\n    height: `${size.height}px`,\n    touchAction: \"none\",\n    userSelect: isDragging || isResizing ? \"none\" : \"auto\",\n    zIndex,\n    background: \"transparent\",\n    overflow: \"visible\",\n    ...style,\n  };\n\n  return (\n    <div style={containerStyle} className={className ?? \"\"}>\n      <div\n        className=\"fb-drag-surface\"\n        style={{ width: \"100%\", height: \"100%\", position: \"relative\" }}\n        onPointerDown={startDrag}\n      >\n        {children}\n        {!disableResize && handles.map(({ h, style: s, cursor }) => (\n          <div\n            key={h}\n            className=\"fb-resize\"\n            style={{ ...baseHandleStyle, ...s, cursor }}\n            onPointerDown={(e) => startResize(e, h)}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":11514,"size_tokens":null},"yuzha/src/timestamp/types.ts":{"content":"export type TextAlign = \"left\" | \"center\" | \"right\";\n\nexport type OverlayType = \"text\" | \"image\";\n\nexport type BaseOverlay = {\n  id: string;\n  type: OverlayType;\n  position: { x: number; y: number };\n  isPermanent: boolean;\n  label: string;\n};\n\nexport type TextOverlay = BaseOverlay & {\n  type: \"text\";\n  text: string;\n  fontFamily: string;\n  fontSize: number;\n  textAlign: TextAlign;\n  formatType?: \"time\" | \"date\";\n  noWrap?: boolean;\n  shadowEnabled?: boolean;\n};\n\nexport type ImageOverlay = BaseOverlay & {\n  type: \"image\";\n  src: string;\n  width: number;\n  height: number;\n};\n\nexport type Overlay = TextOverlay | ImageOverlay;\n\nexport type OverlaySettings = {\n  text: string;\n  fontFamily: string;\n  fontSize: number;\n  textAlign: TextAlign;\n  position: { x: number; y: number };\n  shadowEnabled?: boolean;\n};\n\nexport type TimestampState = {\n  imageSrc: string | null;\n  scale: number;\n  translateX: number;\n  translateY: number;\n  rotation: number;\n  textColor: string;\n  shadowColor: string;\n  shadowBlur: number;\n  shadowOffsetX: number;\n  shadowOffsetY: number;\n  customFonts: string[];\n  overlays: Overlay[];\n};\n\nexport type TimestampPresetV2 = {\n  id: string;\n  name: string;\n  createdAt: number;\n  version: 2;\n  scale: number;\n  translateX: number;\n  translateY: number;\n  rotation: number;\n  textColor: string;\n  shadowColor: string;\n  shadowBlur: number;\n  shadowOffsetX: number;\n  shadowOffsetY: number;\n  customFonts: string[];\n  time: OverlaySettings;\n  date: OverlaySettings;\n  location: OverlaySettings;\n};\n\nexport type TimestampPresetV3 = {\n  id: string;\n  name: string;\n  createdAt: number;\n  version: 3;\n  scale: number;\n  translateX: number;\n  translateY: number;\n  rotation: number;\n  textColor: string;\n  shadowColor: string;\n  shadowBlur: number;\n  shadowOffsetX: number;\n  shadowOffsetY: number;\n  customFonts: string[];\n  overlays: Overlay[];\n};\n\nexport const DEFAULT_OVERLAYS: Overlay[] = [\n  {\n    id: \"time\",\n    type: \"text\",\n    label: \"Time\",\n    text: \"12:00\",\n    fontFamily: \"sans-serif\",\n    fontSize: 24,\n    textAlign: \"left\",\n    position: { x: 20, y: 20 },\n    isPermanent: true,\n    formatType: \"time\",\n    noWrap: true,\n    shadowEnabled: false,\n  },\n  {\n    id: \"date\",\n    type: \"text\",\n    label: \"Date\",\n    text: \"2025-01-01\",\n    fontFamily: \"sans-serif\",\n    fontSize: 24,\n    textAlign: \"left\",\n    position: { x: 20, y: 70 },\n    isPermanent: true,\n    formatType: \"date\",\n    noWrap: true,\n    shadowEnabled: false,\n  },\n  {\n    id: \"location\",\n    type: \"text\",\n    label: \"Location\",\n    text: \"Location\",\n    fontFamily: \"sans-serif\",\n    fontSize: 24,\n    textAlign: \"left\",\n    position: { x: 20, y: 120 },\n    isPermanent: true,\n    noWrap: false,\n    shadowEnabled: false,\n  },\n];\n\nexport const DEFAULT_OVERLAY_SETTINGS: Record<\"time\" | \"date\" | \"location\", OverlaySettings> = {\n  time: {\n    text: \"12:00\",\n    fontFamily: \"sans-serif\",\n    fontSize: 24,\n    textAlign: \"left\",\n    position: { x: 20, y: 20 },\n    shadowEnabled: false,\n  },\n  date: {\n    text: \"2025-01-01\",\n    fontFamily: \"sans-serif\",\n    fontSize: 24,\n    textAlign: \"left\",\n    position: { x: 20, y: 70 },\n    shadowEnabled: false,\n  },\n  location: {\n    text: \"Location\",\n    fontFamily: \"sans-serif\",\n    fontSize: 24,\n    textAlign: \"left\",\n    position: { x: 20, y: 120 },\n    shadowEnabled: false,\n  },\n};\n\nexport const DEFAULT_STATE = {\n  scale: 1,\n  translateX: 0,\n  translateY: 0,\n  rotation: 0,\n  textColor: \"#ffffff\",\n  shadowColor: \"#000000\",\n  shadowBlur: 2,\n  shadowOffsetX: 1,\n  shadowOffsetY: 1,\n  customFonts: [] as string[],\n  overlays: DEFAULT_OVERLAYS.map((o) => ({ ...o, position: { ...o.position } })),\n};\n\nexport const FONT_FAMILIES = [\n  { label: \"Sans Serif\", value: \"sans-serif\" },\n  { label: \"Serif\", value: \"serif\" },\n  { label: \"Monospace\", value: \"monospace\" },\n  { label: \"Arial\", value: \"Arial, sans-serif\" },\n  { label: \"Georgia\", value: \"Georgia, serif\" },\n  { label: \"Taimingda\", value: \"Taimingda, sans-serif\" },\n];\n\nexport const TEXT_ALIGNMENTS: { label: string; value: TextAlign }[] = [\n  { label: \"Left\", value: \"left\" },\n  { label: \"Center\", value: \"center\" },\n  { label: \"Right\", value: \"right\" },\n];\n\nexport const DATE_FORMATS = [\n  { label: \"YYYY-MM-DD\", value: \"YYYY-MM-DD\" },\n  { label: \"MM/DD/YYYY\", value: \"MM/DD/YYYY\" },\n  { label: \"DD/MM/YYYY\", value: \"DD/MM/YYYY\" },\n  { label: \"MMM DD, YYYY\", value: \"MMM DD, YYYY\" },\n  { label: \"DD MMM YYYY\", value: \"DD MMM YYYY\" },\n];\n\nexport const TIME_FORMATS = [\n  { label: \"HH:MM (24h)\", value: \"HH:mm\" },\n  { label: \"HH:MM:SS (24h)\", value: \"HH:mm:ss\" },\n  { label: \"h:MM AM/PM\", value: \"h:mm A\" },\n  { label: \"h:MM:SS AM/PM\", value: \"h:mm:ss A\" },\n];\n\nexport function formatDate(date: Date, format: string): string {\n  const year = date.getFullYear();\n  const month = date.getMonth() + 1;\n  const day = date.getDate();\n  const monthNames = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\n\n  switch (format) {\n    case \"YYYY-MM-DD\":\n      return `${year}-${String(month).padStart(2, \"0\")}-${String(day).padStart(2, \"0\")}`;\n    case \"MM/DD/YYYY\":\n      return `${String(month).padStart(2, \"0\")}/${String(day).padStart(2, \"0\")}/${year}`;\n    case \"DD/MM/YYYY\":\n      return `${String(day).padStart(2, \"0\")}/${String(month).padStart(2, \"0\")}/${year}`;\n    case \"MMM DD, YYYY\":\n      return `${monthNames[month - 1]} ${String(day).padStart(2, \"0\")}, ${year}`;\n    case \"DD MMM YYYY\":\n      return `${String(day).padStart(2, \"0\")} ${monthNames[month - 1]} ${year}`;\n    default:\n      return `${year}-${String(month).padStart(2, \"0\")}-${String(day).padStart(2, \"0\")}`;\n  }\n}\n\nexport function formatTime(date: Date, format: string): string {\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n  const seconds = date.getSeconds();\n  const hours12 = hours % 12 || 12;\n  const ampm = hours >= 12 ? \"PM\" : \"AM\";\n\n  switch (format) {\n    case \"HH:mm\":\n      return `${String(hours).padStart(2, \"0\")}:${String(minutes).padStart(2, \"0\")}`;\n    case \"HH:mm:ss\":\n      return `${String(hours).padStart(2, \"0\")}:${String(minutes).padStart(2, \"0\")}:${String(seconds).padStart(2, \"0\")}`;\n    case \"h:mm A\":\n      return `${hours12}:${String(minutes).padStart(2, \"0\")} ${ampm}`;\n    case \"h:mm:ss A\":\n      return `${hours12}:${String(minutes).padStart(2, \"0\")}:${String(seconds).padStart(2, \"0\")} ${ampm}`;\n    default:\n      return `${String(hours).padStart(2, \"0\")}:${String(minutes).padStart(2, \"0\")}`;\n  }\n}\n\nexport type OverlayBounds = {\n  id: string;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n};\n\nexport function checkAABBCollision(\n  a: { x: number; y: number; width: number; height: number },\n  b: { x: number; y: number; width: number; height: number }\n): boolean {\n  return (\n    a.x < b.x + b.width &&\n    a.x + a.width > b.x &&\n    a.y < b.y + b.height &&\n    a.y + a.height > b.y\n  );\n}\n\nexport function resolveCollision(\n  moving: { x: number; y: number; width: number; height: number },\n  obstacle: { x: number; y: number; width: number; height: number },\n  prevPos: { x: number; y: number }\n): { x: number; y: number } {\n  const deltaX = moving.x - prevPos.x;\n  const deltaY = moving.y - prevPos.y;\n\n  const overlapLeft = moving.x + moving.width - obstacle.x;\n  const overlapRight = obstacle.x + obstacle.width - moving.x;\n  const overlapTop = moving.y + moving.height - obstacle.y;\n  const overlapBottom = obstacle.y + obstacle.height - moving.y;\n\n  const resolvedX = deltaX > 0\n    ? obstacle.x - moving.width\n    : obstacle.x + obstacle.width;\n\n  const resolvedY = deltaY > 0\n    ? obstacle.y - moving.height\n    : obstacle.y + obstacle.height;\n\n  const minOverlapX = Math.min(overlapLeft, overlapRight);\n  const minOverlapY = Math.min(overlapTop, overlapBottom);\n\n  if (minOverlapX < minOverlapY) {\n    return { x: resolvedX, y: moving.y };\n  } else {\n    return { x: moving.x, y: resolvedY };\n  }\n}\n\nexport function resolveAllCollisions(\n  moving: { x: number; y: number; width: number; height: number },\n  obstacles: OverlayBounds[],\n  prevPos: { x: number; y: number },\n  maxIterations: number = 10\n): { x: number; y: number; hasCollision: boolean } {\n  let currentPos = { x: moving.x, y: moving.y };\n  let referencePos = { x: prevPos.x, y: prevPos.y };\n  let hasCollision = false;\n  \n  for (let iteration = 0; iteration < maxIterations; iteration++) {\n    let collisionFound = false;\n    const posBeforeIteration = { x: currentPos.x, y: currentPos.y };\n    \n    for (const obstacle of obstacles) {\n      const currentBounds = {\n        x: currentPos.x,\n        y: currentPos.y,\n        width: moving.width,\n        height: moving.height,\n      };\n      \n      if (checkAABBCollision(currentBounds, obstacle)) {\n        collisionFound = true;\n        hasCollision = true;\n        const resolved = resolveCollision(currentBounds, obstacle, referencePos);\n        currentPos = resolved;\n      }\n    }\n    \n    if (collisionFound) {\n      referencePos = { x: currentPos.x, y: currentPos.y };\n    }\n    \n    if (!collisionFound) {\n      break;\n    }\n    \n    if (currentPos.x === posBeforeIteration.x && currentPos.y === posBeforeIteration.y) {\n      break;\n    }\n  }\n  \n  return { ...currentPos, hasCollision };\n}\n","path":null,"size_bytes":9217,"size_tokens":null},"yuzha/src/counter/counterEffectDemo.tsx":{"content":"import React, { useEffect, useRef, useMemo } from \"react\";\nimport * as THREE from \"three\";\nimport { requireAssetUrl } from \"@shared/asset/assetResolver\";\nimport { createPolarAura } from \"@shared/effect/polaraura\";\nimport { createStraightRay } from \"@shared/effect/straightRay\";\nimport straightRayConfig from \"@shared/effect/straightRay.config.json\";\n\nconst wave22TextureUrl = requireAssetUrl(\"alpha_noise_256_wave_22\");\nconst wave04TextureUrl = requireAssetUrl(\"alpha_noise_256_wave_04\");\nconst wave05TextureUrl = requireAssetUrl(\"alpha_noise_256_wave_05\");\nconst polarMaskTextureUrl = requireAssetUrl(\"Untitled-1\");\n\nexport type CounterEffectDemoProps = {\n  onClose?: () => void;\n};\n\nexport default function CounterEffectDemo({ onClose }: CounterEffectDemoProps) {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [animationType, setAnimationType] = React.useState<\n    | \"polar\"\n    | \"polarMask\"\n    | \"radial\"\n    | \"straight\"\n    | \"perspective\"\n    | \"perspectiveCircle\"\n    | \"purpleFire\"\n    | \"orangeBurst\"\n    | \"auraBlast\"\n    | \"smokeStack\"\n    | \"smokeRadial\"\n  >(\"straight\");\n\n  const rayRotationOffsets = useMemo(() => {\n    const offsets: number[] = [];\n    for (let i = 0; i < 24; i++) {\n      offsets.push((Math.random() - 0.5) * 0.15);\n    }\n    return offsets;\n  }, []);\n\n  useEffect(() => {\n    if (!canvasRef.current) return;\n\n    // Scene setup\n    const scene = new THREE.Scene();\n    const camera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0.1, 10);\n    camera.position.z = 1;\n\n    const renderer = new THREE.WebGLRenderer({\n      canvas: canvasRef.current,\n      alpha: true,\n      antialias: true,\n    });\n    renderer.setSize(400, 400);\n    renderer.setPixelRatio(window.devicePixelRatio);\n\n    // Load texture\n    const textureLoader = new THREE.TextureLoader();\n    const noiseTexture = textureLoader.load(wave22TextureUrl);\n    noiseTexture.wrapS = THREE.RepeatWrapping;\n    noiseTexture.wrapT = THREE.RepeatWrapping;\n\n    // Clear scene\n    while (scene.children.length > 0) {\n      const child = scene.children[0];\n      if (child) {\n        scene.remove(child);\n      }\n    }\n\n    const layers: THREE.Mesh[] = [];\n\n    if (animationType === \"polar\") {\n      const polarMeshes = createPolarAura(textureLoader);\n      polarMeshes.forEach((mesh) => {\n        scene.add(mesh);\n        layers.push(mesh);\n      });\n    } else if (animationType === \"polarMask\") {\n      // POLAR MASK - dual-noise scroll through mask (grayscale)\n      const maskTex = textureLoader.load(polarMaskTextureUrl);\n      maskTex.wrapS = THREE.ClampToEdgeWrapping;\n      maskTex.wrapT = THREE.ClampToEdgeWrapping;\n\n      const tex1 = textureLoader.load(wave05TextureUrl);\n      tex1.wrapS = THREE.RepeatWrapping;\n      tex1.wrapT = THREE.RepeatWrapping;\n\n      const tex2 = textureLoader.load(wave22TextureUrl);\n      tex2.wrapS = THREE.RepeatWrapping;\n      tex2.wrapT = THREE.RepeatWrapping;\n\n      const vertexShader = `\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      `;\n\n      const fragmentShader = `\n        uniform sampler2D uMask;\n        uniform sampler2D uTex1;\n        uniform sampler2D uTex2;\n        uniform float uTime;\n        uniform float uLoop;\n        uniform float uOpacity;\n        uniform float uScale;\n        uniform float uTimeOffset;\n        varying vec2 vUv;\n\n        const float PI = 3.14159265;\n\n        void main() {\n          vec2 center = vec2(0.5);\n          vec2 uvBase = (vUv - center) * uScale + center;\n\n          // looped phase 0..1\n          float phase = fract((uTime + uTimeOffset) / uLoop);\n          float flow = sin(2.0 * PI * phase);\n\n          vec2 uv1 = uvBase + flow * vec2(-0.373, 1.736);\n          vec2 uv2 = uvBase + flow * vec2(-0.264, 2.025);\n\n          float mask = texture2D(uMask, vUv).r;\n          if (mask < 0.01) discard;\n\n          float n1 = texture2D(uTex1, uv1).r;\n          float n2 = texture2D(uTex2, uv2).r;\n          float combined = mix(n1, n2, 0.79);\n\n          // soften extremes\n          float intensity = smoothstep(0.0, 1.0, combined);\n\n          vec3 color = vec3(intensity);\n          gl_FragColor = vec4(color, intensity * mask * uOpacity);\n        }\n      `;\n\n      const layerCount = 3;\n      for (let i = 0; i < layerCount; i++) {\n        const material = new THREE.ShaderMaterial({\n          vertexShader,\n          fragmentShader,\n          uniforms: {\n            uMask: { value: maskTex },\n            uTex1: { value: tex1 },\n            uTex2: { value: tex2 },\n            uTime: { value: 0 },\n            uLoop: { value: 1.0 },\n            uOpacity: { value: 0.65 - i * 0.12 },\n            uScale: { value: 0.45 }, // UV scale\n            uTimeOffset: { value: i * 0.2 },\n          },\n          transparent: true,\n          blending: THREE.AdditiveBlending,\n          depthWrite: false,\n        });\n\n        const geometry = new THREE.PlaneGeometry(2.2, 2.2);\n        const mesh = new THREE.Mesh(geometry, material);\n        mesh.position.z = -i * 0.01;\n        scene.add(mesh);\n        layers.push(mesh);\n      }\n    } else if (animationType === \"straight\") {\n      // STRAIGHT SMOKE RAY (shared effect implementation)\n      const rayMeshes = createStraightRay(textureLoader, straightRayConfig);\n      rayMeshes.forEach((mesh, index) => {\n        mesh.position.z = -index * 0.01;\n        scene.add(mesh);\n        layers.push(mesh);\n      });\n    } else if (animationType === \"purpleFire\") {\n      // PURPLE FIRE - upward flowing with purple gradient\n      const layerCount = 5;\n\n      const vertexShader = `\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      `;\n\n      const fragmentShader = `\n        uniform sampler2D uTexture;\n        uniform float uTime;\n        uniform float uOffset;\n        uniform float uOpacity;\n        varying vec2 vUv;\n\n        void main() {\n          vec2 uv = vUv;\n          \n          // Perspective: narrow at base, wider at tip\n          float perspective = 0.4 + vUv.y * 0.6;\n          uv.x = (uv.x - 0.5) * perspective + 0.5;\n          \n          // Animate upward\n          uv.y -= uTime * 0.15 + uOffset;\n          \n          vec4 noise = texture2D(uTexture, uv);\n          \n          // Purple color gradient (dark purple to bright purple/white)\n          vec3 darkPurple = vec3(0.3, 0.1, 0.5);\n          vec3 brightPurple = vec3(0.8, 0.3, 1.0);\n          vec3 white = vec3(1.0, 0.9, 1.0);\n          \n          // Map noise intensity to color\n          vec3 color;\n          if (noise.r < 0.5) {\n            color = mix(darkPurple, brightPurple, noise.r * 2.0);\n          } else {\n            color = mix(brightPurple, white, (noise.r - 0.5) * 2.0);\n          }\n          \n          // Fade at edges\n          float fadeY = smoothstep(0.0, 0.2, vUv.y) * smoothstep(1.0, 0.6, vUv.y);\n          float fadeX = smoothstep(0.0, 0.15, vUv.x) * smoothstep(1.0, 0.85, vUv.x);\n          \n          float alpha = noise.a * fadeY * fadeX * uOpacity;\n          \n          gl_FragColor = vec4(color, alpha);\n        }\n      `;\n\n      for (let i = 0; i < layerCount; i++) {\n        const material = new THREE.ShaderMaterial({\n          vertexShader,\n          fragmentShader,\n          uniforms: {\n            uTexture: { value: noiseTexture },\n            uTime: { value: 0 },\n            uOffset: { value: i * 0.25 },\n            uOpacity: { value: 0.7 - i * 0.1 },\n          },\n          transparent: true,\n          blending: THREE.AdditiveBlending,\n          depthWrite: false,\n        });\n\n        const geometry = new THREE.PlaneGeometry(0.8, 2.0);\n        const mesh = new THREE.Mesh(geometry, material);\n        mesh.position.z = -i * 0.01;\n        scene.add(mesh);\n        layers.push(mesh);\n      }\n    } else if (animationType === \"smokeStack\") {\n      // SMOKE STACK - simple stacked smoke using wave_04, stretch before fade\n      const layerCount = 6;\n\n      // Load wave_04 texture for this effect\n      const smokeTexture = textureLoader.load(wave04TextureUrl);\n      smokeTexture.wrapS = THREE.RepeatWrapping;\n      smokeTexture.wrapT = THREE.RepeatWrapping;\n\n      const vertexShader = `\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      `;\n\n      const fragmentShader = `\n        uniform sampler2D uTexture;\n        uniform float uTime;\n        uniform float uOffset;\n        uniform float uOpacity;\n        uniform float uSpeed;\n        varying vec2 vUv;\n\n        void main() {\n          vec2 uv = vUv;\n          \n          // Stretch effect: narrow at bottom (y=0), wider at top (y=1)\n          float stretch = 0.3 + vUv.y * 0.7;\n          uv.x = (uv.x - 0.5) * stretch + 0.5;\n          \n          // Slow upward smoke animation\n          uv.y -= uTime * uSpeed + uOffset;\n          \n          // Add slight horizontal wobble for organic feel\n          uv.x += sin(uTime * 0.5 + vUv.y * 3.0) * 0.02 * vUv.y;\n          \n          vec4 noise = texture2D(uTexture, uv);\n          \n          // Soft fade: bottom fades in, top fades out (stretch then fade)\n          float fadeY = smoothstep(0.0, 0.15, vUv.y) * smoothstep(1.0, 0.4, vUv.y);\n          float fadeX = smoothstep(0.0, 0.15, vUv.x) * smoothstep(1.0, 0.85, vUv.x);\n          \n          // Use texture alpha with fades\n          float alpha = noise.a * fadeY * fadeX * uOpacity;\n          \n          gl_FragColor = vec4(noise.rgb, alpha);\n        }\n      `;\n\n      for (let i = 0; i < layerCount; i++) {\n        // Varying speeds for each layer (slower to faster)\n        const speed = 0.04 + i * 0.015;\n        const opacity = 0.6 - i * 0.08;\n        const offset = i * 0.25;\n\n        const material = new THREE.ShaderMaterial({\n          vertexShader,\n          fragmentShader,\n          uniforms: {\n            uTexture: { value: smokeTexture },\n            uTime: { value: 0 },\n            uOffset: { value: offset },\n            uOpacity: { value: opacity },\n            uSpeed: { value: speed },\n          },\n          transparent: true,\n          blending: THREE.AdditiveBlending,\n          depthWrite: false,\n        });\n\n        // Tall plane for smoke column\n        const geometry = new THREE.PlaneGeometry(1.0, 2.0);\n        const mesh = new THREE.Mesh(geometry, material);\n        mesh.position.z = -i * 0.01;\n        scene.add(mesh);\n        layers.push(mesh);\n      }\n    } else if (animationType === \"smokeRadial\") {\n      // SMOKE RADIAL - multiple smoke columns arranged in circle, radiating outward\n      const rayCount = 16;\n      const layersPerRay = 3;\n\n      // Load wave_04 texture\n      const smokeTexture = textureLoader.load(wave04TextureUrl);\n      smokeTexture.wrapS = THREE.RepeatWrapping;\n      smokeTexture.wrapT = THREE.RepeatWrapping;\n\n      const vertexShader = `\n        varying vec2 vUv;\n        void main() {\n          vUv = uv;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n        }\n      `;\n\n      // Same stretch shader as smokeStack - narrow base, wide top\n      const fragmentShader = `\n        uniform sampler2D uTexture;\n        uniform float uTime;\n        uniform float uOffset;\n        uniform float uOpacity;\n        uniform float uSpeed;\n        varying vec2 vUv;\n\n        void main() {\n          vec2 uv = vUv;\n          \n          // Stretch effect: narrow at bottom (y=0), wider at top (y=1)\n          float stretch = 0.25 + vUv.y * 0.75;\n          uv.x = (uv.x - 0.5) * stretch + 0.5;\n          \n          // Slow upward/outward smoke animation\n          uv.y -= uTime * uSpeed + uOffset;\n          \n          // Slight horizontal wobble for organic feel\n          uv.x += sin(uTime * 0.4 + vUv.y * 2.5) * 0.015 * vUv.y;\n          \n          vec4 noise = texture2D(uTexture, uv);\n          \n          // Soft fade: bottom fades in, top fades out\n          float fadeY = smoothstep(0.0, 0.2, vUv.y) * smoothstep(1.0, 0.35, vUv.y);\n          float fadeX = smoothstep(0.0, 0.2, vUv.x) * smoothstep(1.0, 0.8, vUv.x);\n          \n          float alpha = noise.a * fadeY * fadeX * uOpacity;\n          \n          gl_FragColor = vec4(noise.rgb, alpha);\n        }\n      `;\n\n      // Create radial rays\n      for (let r = 0; r < rayCount; r++) {\n        const angle = (r / rayCount) * Math.PI * 2;\n        const rotationOffset = rayRotationOffsets[r % rayRotationOffsets.length] || 0;\n\n        for (let l = 0; l < layersPerRay; l++) {\n          const speed = 0.05 + l * 0.02;\n          const opacity = 0.5 - l * 0.12;\n          const offset = l * 0.3 + r * 0.08;\n\n          const material = new THREE.ShaderMaterial({\n            vertexShader,\n            fragmentShader,\n            uniforms: {\n              uTexture: { value: smokeTexture },\n              uTime: { value: 0 },\n              uOffset: { value: offset },\n              uOpacity: { value: opacity },\n              uSpeed: { value: speed },\n            },\n            transparent: true,\n            blending: THREE.AdditiveBlending,\n            depthWrite: false,\n          });\n\n          // Smoke column plane - offset so bottom edge is at origin\n          const geometry = new THREE.PlaneGeometry(0.4, 1.4);\n          geometry.translate(0, 0.7, 0); // Move so bottom edge is at y=0\n          const mesh = new THREE.Mesh(geometry, material);\n\n          // Position at center, rotate to radiate outward\n          mesh.position.set(0, 0, -r * 0.001 - l * 0.0001);\n          mesh.rotation.z = -angle + rotationOffset + Math.PI / 2;\n\n          scene.add(mesh);\n          layers.push(mesh);\n        }\n      }\n    } else {\n      // Effect placeholder for removed/unused options\n    }\n\n    // Animation loop\n    let animationId: number;\n    const clock = new THREE.Clock();\n\n    const animate = () => {\n      const elapsed = clock.getElapsedTime();\n\n      layers.forEach((layer) => {\n        const material = layer.material as THREE.ShaderMaterial;\n        if (material.uniforms?.uTime) {\n          material.uniforms.uTime.value = elapsed;\n        }\n      });\n\n      renderer.render(scene, camera);\n      animationId = requestAnimationFrame(animate);\n    };\n\n    animate();\n\n    // Cleanup\n    return () => {\n      cancelAnimationFrame(animationId);\n      layers.forEach((layer) => {\n        layer.geometry.dispose();\n        (layer.material as THREE.ShaderMaterial).dispose();\n      });\n      renderer.dispose();\n    };\n  }, [animationType]);\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/80\">\n      <button\n        type=\"button\"\n        onClick={onClose}\n        className=\"absolute right-6 top-6 rounded bg-slate-800 px-3 py-1 text-sm font-semibold text-white shadow hover:bg-slate-700\"\n      >\n        Close\n      </button>\n\n      <div className=\"relative flex flex-col items-center gap-4\">\n        <canvas ref={canvasRef} className=\"rounded-lg\" />\n\n        <div className=\"flex flex-wrap gap-2 justify-center max-w-lg\">\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"polar\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"polar\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            Polar Aura\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"polarMask\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"polarMask\"\n                ? \"bg-cyan-700 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            Polar Mask\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"straight\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"straight\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            Straight Ray\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"perspective\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"perspective\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            Perspective Single\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"radial\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"radial\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            Radial Rays\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"perspectiveCircle\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"perspectiveCircle\"\n                ? \"bg-blue-600 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            Perspective Circle\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"purpleFire\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"purpleFire\"\n                ? \"bg-purple-600 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            🔥 Purple Fire\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"orangeBurst\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"orangeBurst\"\n                ? \"bg-orange-600 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            💥 Orange Burst\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"auraBlast\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"auraBlast\"\n                ? \"bg-indigo-600 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            ✨ Aura Blast\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"smokeStack\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"smokeStack\"\n                ? \"bg-gray-600 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            💨 Smoke Stack\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setAnimationType(\"smokeRadial\")}\n            className={`rounded px-3 py-2 text-xs font-medium shadow transition ${\n              animationType === \"smokeRadial\"\n                ? \"bg-slate-500 text-white\"\n                : \"bg-slate-700 text-slate-300 hover:bg-slate-600\"\n            }`}\n          >\n            🌀 Smoke Radial\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":19697,"size_tokens":null},"shared/layer/model.ts":{"content":"/** LAYER MODEL - Single Source of Truth for Types & Configuration. */\n\nimport rawConfig from \"./ConfigYuzha.json\";\n\n// Basic geometric types used throughout the layer system.\n\n/** 2D point in pixel space. */\nexport type Point2D = { x: number; y: number };\n\n/** 2D point in percentage space (0-100% in both dimensions). */\nexport type PercentPoint = { x: number; y: number };\n\n/** A point represented in both pixel and percentage coordinates. */\nexport type CoordinateBundle = {\n  point: Point2D;\n  percent: PercentPoint;\n};\n\n/** A point represented in both image space and stage space. */\nexport type DualSpaceCoordinate = {\n  image: CoordinateBundle;\n  stage: CoordinateBundle;\n};\n\n/** Extended coordinate for orbital calculations. */\nexport type OrbitCoordinate = DualSpaceCoordinate & {\n  stageAnchor: CoordinateBundle;\n};\n\n/** 2D transformation (position + scale). */\nexport type Layer2DTransform = {\n  position: Point2D;\n  scale: Point2D;\n};\n\n// Types for clock-based animations and time calculations.\n\n/** Rotation direction. */\nexport type RotationDirection = \"cw\" | \"ccw\";\n\n/** Clock speed aliases for common time units. */\nexport type ClockSpeedAlias = \"second\" | \"minute\" | \"hour\";\n\n/** Time format for clock calculations. */\nexport type TimeFormat = \"12\" | \"24\";\n\n/** Direction sign for calculations. */\nexport type DirectionSign = 1 | -1;\n\n/** Clock speed value object. */\nexport type ClockSpeedValue = {\n  value: number;\n  direction?: RotationDirection;\n};\n\n/** Union type for all clock speed specifications. */\nexport type ClockSpeedSetting = ClockSpeedAlias | ClockSpeedValue | number;\n\n/** Clock motion configuration. */\nexport type ClockMotionConfig = {\n  speed?: ClockSpeedSetting;\n  direction?: RotationDirection;\n  format?: TimeFormat;\n  timezone?: string;\n};\n\n/** Resolved clock speed (discriminated union). */\nexport type ResolvedClockSpeed =\n  | {\n      kind: \"static\";\n      timezoneOffsetMinutes: number;\n      format: TimeFormat;\n    }\n  | {\n      kind: \"alias\";\n      alias: ClockSpeedAlias;\n      timezoneOffsetMinutes: number;\n      format: TimeFormat;\n    }\n  | {\n      kind: \"numeric\";\n      rotationsPerHour: number;\n      directionSign: DirectionSign;\n      timezoneOffsetMinutes: number;\n      format: TimeFormat;\n    };\n\n/** Clock defaults. */\nexport const CLOCK_DEFAULTS = {\n  timeFormat: \"24\" as TimeFormat,\n  direction: \"cw\" as RotationDirection,\n  numericSpeed: 1,\n};\n\n/** Available clock speed aliases. */\nexport const CLOCK_SPEED_ALIASES: ClockSpeedAlias[] = [\"second\", \"minute\", \"hour\"];\n\n// Configuration structure loaded from ConfigYuzha.json\n\n/** Layer Renderer Type. */\nexport type LayerRenderer = \"2D\" | \"3D\";\n\n/** LayerConfigEntry - Complete layer configuration. */\nexport type LayerConfigEntry = {\n  // ===== CORE PROPERTIES (Required) =====\n  LayerID: string;\n  ImageID: string;\n  renderer: LayerRenderer;\n  LayerOrder: number;\n  /** Optional blend mode for rendering (Three.js renderer). Defaults to \"normal\". */\n  BlendMode?: \"additive\" | \"normal\";\n  /** Optional per-layer opacity (0-1). */\n  Opacity?: number;\n  /** Optional pulse period in seconds; 0 or undefined disables pulse. */\n  PulseSeconds?: number;\n  /** Optional pulse amplitude (0-1) applied to opacity; defaults to 0.15 if PulseSeconds > 0. */\n  PulseAmplitude?: number;\n  ImageScale?: number[];\n\n  // ===== BASIC CONFIG (Static Positioning) =====\n  /** @deprecated Use BasicStagePoint and BasicImagePoint instead. */\n  position?: number[];\n  BasicStagePoint?: number[];\n  BasicImagePoint?: number[];\n  BasicImageAngle?: number;\n\n  // ===== SPIN CONFIG (Rotation Animation) =====\n  spinStagePoint?: number[];\n  spinImagePoint?: number[];\n  spinSpeed?: number;\n  spinDirection?: \"cw\" | \"ccw\";\n  spinSpeedAlias?: \"second\" | \"minute\" | \"hour\";\n  spinFormat?: \"12\" | \"24\";\n  spinTimezone?: string;\n\n  // ===== ORBITAL CONFIG (Orbital Motion) =====\n  orbitStagePoint?: number[];\n  orbitLinePoint?: number[];\n  orbitImagePoint?: number[];\n  orbitLine?: boolean;\n  orbitOrient?: boolean;\n  orbitSpeed?: number;\n  orbitDirection?: \"cw\" | \"ccw\";\n  orbitSpeedAlias?: \"second\" | \"minute\" | \"hour\";\n  orbitFormat?: \"12\" | \"24\";\n  orbitTimezone?: string;\n};\n\n/** Array of layer configuration entries. */\nexport type LayerConfig = LayerConfigEntry[];\n\n// Runtime layer data structures after configuration is processed\n\n/** Image mapping information. */\nexport type ImageMapping = {\n  imageDimensions: { width: number; height: number };\n};\n\n/** Precomputed calculation points for a layer. */\nexport type LayerCalculationPoints = {\n  stageCenter: CoordinateBundle;\n  imageCenter: DualSpaceCoordinate;\n  spinPoint: DualSpaceCoordinate;\n  orbitPoint: OrbitCoordinate;\n  orbitLine?: CoordinateBundle;\n};\n\n/** Universal layer data structure (base layer data before processors). */\nexport type UniversalLayerData = {\n  LayerID: string;\n  ImageID: string;\n  imageUrl: string;\n  imagePath: string;\n  blendMode?: \"additive\" | \"normal\";\n  opacity?: number;\n  pulseSeconds?: number;\n  pulseAmplitude?: number;\n  position: Point2D;\n  scale: Point2D;\n  imageMapping: ImageMapping;\n  calculation: LayerCalculationPoints;\n  rotation?: number;\n  spinStagePoint?: Point2D;\n  spinStagePercent?: PercentPoint;\n  spinPercent?: PercentPoint;\n  spinImagePoint?: Point2D;\n  orbitStagePoint?: Point2D;\n  orbitLinePoint?: Point2D;\n  orbitLineVisible?: boolean;\n  orbitRadius?: number;\n  orbitImagePercent?: PercentPoint;\n  orbitImagePoint?: Point2D;\n  orbitOrient?: boolean;\n};\n\n/** Enhanced universal layer data with processor-added properties. */\nexport type EnhancedLayerData = UniversalLayerData & {\n  // Spin properties (added by motion processor)\n  spinSpeed?: number; // rotations per hour (1 = 1 full rotation in 1 hour)\n  spinDirection?: \"cw\" | \"ccw\";\n  spinSpeedAlias?: ClockSpeedAlias;\n  spinFormat?: TimeFormat;\n  spinTimezone?: string;\n  currentRotation?: number;\n  hasSpinAnimation?: boolean;\n  spinStagePoint?: Point2D;\n  spinPercent?: PercentPoint;\n\n  // Orbital properties (added by motion processor)\n  orbitSpeed?: number; // rotations per hour (1 = 1 full orbit in 1 hour)\n  orbitSpeedAlias?: ClockSpeedAlias;\n  orbitFormat?: TimeFormat;\n  orbitTimezone?: string;\n  orbitDirection?: \"cw\" | \"ccw\";\n  currentOrbitAngle?: number;\n  hasOrbitalAnimation?: boolean;\n  visible?: boolean;\n  orbitPoint?: Point2D;\n  orbitLineStyle?: {\n    radius: number;\n    visible: boolean;\n  };\n\n  // Future properties added by other processors\n  opacity?: number;\n  filters?: string[];\n};\n\n/** Modular preparation states. */\nexport type BaseLayerState = {\n  baseData: {\n    LayerID: string;\n    ImageID: string;\n    imageUrl: string;\n    imagePath: string;\n    blendMode?: \"additive\" | \"normal\";\n    opacity?: number;\n    pulseSeconds?: number;\n    pulseAmplitude?: number;\n    position: Point2D;\n    scale: Point2D;\n    imageMapping: ImageMapping;\n    rotation: number;\n    orbitOrient: boolean;\n  };\n  stageSize: number;\n  stageCenter: CoordinateBundle;\n  imageCenter: DualSpaceCoordinate;\n};\n\nexport type SpinPreparationState = {\n  hasSpin: boolean;\n  calculation: {\n    spinPoint: DualSpaceCoordinate;\n  };\n  spinStagePoint: Point2D;\n  spinStagePercent: PercentPoint;\n  spinImagePercent: PercentPoint;\n  spinImagePoint: Point2D;\n};\n\nexport type OrbitPreparationState = {\n  hasOrbit: boolean;\n  calculation: {\n    orbitPoint: OrbitCoordinate;\n    orbitLine: CoordinateBundle;\n  };\n  orbitStagePoint: Point2D;\n  orbitLinePoint: Point2D;\n  orbitLineVisible: boolean;\n  orbitRadius: number;\n  orbitImagePercent: PercentPoint;\n  orbitImagePoint: Point2D;\n};\n\n// Types for the layer processor pipeline system\n\n/** Layer processor function type. */\nexport type LayerProcessor = (layer: UniversalLayerData, timestamp?: number) => EnhancedLayerData;\n\n/** Context for processor attachment decisions. */\nexport type ProcessorContext = {\n  force?: Record<string, unknown>;\n};\n\n/** Processor plugin definition. */\nexport type ProcessorPlugin = {\n  /** Unique name for this processor (e.g., \"spin\", \"orbital\", \"blur\"). */\n  name: string;\n\n  /** Determines if this processor should be attached to a layer. */\n  shouldAttach(entry: LayerConfigEntry, context?: ProcessorContext): boolean;\n\n  /** Creates the processor function for this layer. */\n  create(entry: LayerConfigEntry, context?: ProcessorContext): LayerProcessor;\n};\n\n// Types for layer motion artifacts (markers and processors)\n\n/** Visual marker for layer motion debugging. */\nexport type LayerMotionMarker = {\n  id: string;\n  x: number;\n  y: number;\n  color: string;\n  radius: number;\n  kind?: \"point\" | \"circle\";\n  lineWidth?: number;\n  motion?: {\n    type: \"orbit\";\n    centerX: number;\n    centerY: number;\n    radius: number;\n    rotationsPerHour: number;\n    direction: RotationDirection;\n    initialAngleDeg: number;\n  };\n};\n\n/** Motion artifacts returned by buildLayerMotion. */\nexport type LayerMotionArtifacts = {\n  processor?: (layer: UniversalLayerData, timestamp?: number) => EnhancedLayerData;\n  markers?: LayerMotionMarker[];\n};\n\n// Functions for loading and validating layer configuration\n\n/** Clock alias configuration defaults. */\nconst CLOCK_ALIAS_DEFAULT_FORMAT = \"24\";\nconst CLOCK_ALIAS_DEFAULT_TIMEZONE = \"UTC\";\nconst CLOCK_ALIAS_VALUES = new Set([\"second\", \"minute\", \"hour\"]);\n\n/** Normalize motion configuration for clock aliases. */\nfunction normalizeMotionAlias(entry: LayerConfigEntry, prefix: \"spin\" | \"orbit\"): void {\n  const speedKey = `${prefix}Speed` as keyof LayerConfigEntry;\n  const aliasKey = `${prefix}SpeedAlias` as keyof LayerConfigEntry;\n  const formatKey = `${prefix}Format` as keyof LayerConfigEntry;\n  const timezoneKey = `${prefix}Timezone` as keyof LayerConfigEntry;\n\n  const rawSpeed = entry[speedKey];\n\n  // Already an alias or number - nothing to normalize\n  if (typeof rawSpeed !== \"string\") return;\n\n  // Try parsing as number first\n  const numericValue = Number(rawSpeed);\n  if (!isNaN(numericValue) && isFinite(numericValue)) {\n    (entry[speedKey] as any) = numericValue;\n    return;\n  }\n\n  // Check if it's a clock alias\n  if (CLOCK_ALIAS_VALUES.has(rawSpeed)) {\n    // Move to alias field (only if not already set to avoid overwriting)\n    if (!entry[aliasKey]) {\n      (entry[aliasKey] as any) = rawSpeed as ClockSpeedAlias;\n    }\n    delete entry[speedKey];\n\n    // Set defaults if not provided\n    if (!entry[formatKey]) {\n      (entry[formatKey] as any) = CLOCK_ALIAS_DEFAULT_FORMAT;\n    }\n    if (!entry[timezoneKey]) {\n      (entry[timezoneKey] as any) = CLOCK_ALIAS_DEFAULT_TIMEZONE;\n    }\n  }\n  // Invalid string - remove it\n  else {\n    delete entry[speedKey];\n  }\n}\n\n/** Validate layer config entry. */\nexport function validateLayerConfig(entry: LayerConfigEntry): string[] {\n  const errors: string[] = [];\n\n  // Validate core properties\n  if (!entry.LayerID || typeof entry.LayerID !== \"string\") {\n    errors.push(\"LayerID is required and must be a string\");\n  }\n  if (!entry.ImageID || typeof entry.ImageID !== \"string\") {\n    errors.push(\"ImageID is required and must be a string\");\n  }\n  if (typeof entry.LayerOrder !== \"number\" || !isFinite(entry.LayerOrder)) {\n    errors.push(\"LayerOrder is required and must be a finite number\");\n  }\n  if (entry.renderer !== \"2D\" && entry.renderer !== \"3D\") {\n    errors.push('Renderer must be \"2D\" or \"3D\"');\n  }\n\n  // Validate ImageScale if provided\n  if (entry.ImageScale !== undefined) {\n    if (!Array.isArray(entry.ImageScale) || entry.ImageScale.length !== 2) {\n      errors.push(\"ImageScale must be an array of 2 numbers [x, y]\");\n    } else {\n      const [x, y] = entry.ImageScale;\n      if (typeof x !== \"number\" || typeof y !== \"number\" || x <= 0 || y <= 0) {\n        errors.push(\"ImageScale values must be positive numbers\");\n      }\n    }\n  }\n\n  return errors;\n}\n\n/** Load layer configuration from ConfigYuzha.json. */\nexport function loadLayerConfig(): LayerConfig {\n  // Cast raw JSON to our type\n  const entries = rawConfig as LayerConfigEntry[];\n\n  // Normalize and validate each entry\n  entries.forEach((entry, index) => {\n    // Normalize clock aliases for spin and orbit\n    normalizeMotionAlias(entry, \"spin\");\n    normalizeMotionAlias(entry, \"orbit\");\n\n    // Validate entry (development only)\n    const errors = validateLayerConfig(entry);\n    if (errors.length > 0 && typeof console !== \"undefined\") {\n      console.error(\n        `[LayerConfig] Validation errors for entry #${index} (${entry.LayerID}):`,\n        errors,\n      );\n    }\n  });\n\n  // Sort by LayerOrder (background to foreground)\n  entries.sort((a, b) => a.LayerOrder - b.LayerOrder);\n\n  return entries;\n}\n","path":null,"size_bytes":12528,"size_tokens":null},"shared/component/combobox_combobox-with-states-5.tsx":{"content":"\"use client\";\n\nimport { Check, ChevronsUpDown } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\n\nexport const title = \"With Validation Feedback\";\n\nconst currencies = [\"USD\", \"EUR\", \"GBP\", \"JPY\", \"CAD\"];\n\nconst Example = () => {\n  const [open, setOpen] = useState(false);\n  const [value, setValue] = useState(\"\");\n  const error = value ? \"\" : \"Please select a currency\";\n\n  return (\n    <div className=\"space-y-2\">\n      <Popover onOpenChange={setOpen} open={open}>\n        <PopoverTrigger asChild>\n          <Button\n            aria-expanded={open}\n            className={cn(\n              \"w-[200px] justify-between\",\n              error && \"border-destructive\",\n            )}\n            role=\"combobox\"\n            variant=\"outline\"\n          >\n            {value || \"Select currency...\"}\n            <ChevronsUpDown className=\"ml-2 size-4 shrink-0 opacity-50\" />\n          </Button>\n        </PopoverTrigger>\n        <PopoverContent className=\"w-[200px] p-0\">\n          <Command>\n            <CommandInput placeholder=\"Search currency...\" />\n            <CommandList>\n              <CommandEmpty>No currency found.</CommandEmpty>\n              <CommandGroup>\n                {currencies.map((currency) => (\n                  <CommandItem\n                    key={currency}\n                    onSelect={(currentValue) => {\n                      setValue(currentValue === value ? \"\" : currentValue);\n                      setOpen(false);\n                    }}\n                    value={currency}\n                  >\n                    <Check\n                      className={cn(\n                        \"mr-2 size-4\",\n                        value === currency ? \"opacity-100\" : \"opacity-0\",\n                      )}\n                    />\n                    {currency}\n                  </CommandItem>\n                ))}\n              </CommandGroup>\n            </CommandList>\n          </Command>\n        </PopoverContent>\n      </Popover>\n      {error && <p className=\"text-destructive text-xs\">{error}</p>}\n    </div>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":2379,"size_tokens":null},"yuzha/src/timestamp/TimestampFloating.tsx":{"content":"import React, { forwardRef, useImperativeHandle, useRef, useState, useEffect, useLayoutEffect, useCallback } from \"react\";\nimport FloatingBorderless from \"@shared/floating/FloatingBorderless\";\nimport type { BoundingRect } from \"@shared/floating/FloatingBorderless\";\nimport type { TextAlign, OverlayBounds } from \"./types\";\nimport { checkAABBCollision, resolveAllCollisions } from \"./types\";\nexport type { TextAlign } from \"./types\";\n\nexport type TimestampFloatingRef = {\n  getRelativePosition: () => { x: number; y: number };\n  getSize: () => { width: number; height: number };\n  setRelativePosition: (pos: { x: number; y: number }) => void;\n  getBounds: () => OverlayBounds;\n};\n\nexport type TimestampFloatingProps = {\n  id: string;\n  label: string;\n  value: string;\n  boundingRect: BoundingRect;\n  initialRelativePos?: { x: number; y: number };\n  fontFamily?: string;\n  fontSize?: number;\n  color?: string;\n  shadowColor?: string;\n  shadowBlur?: number;\n  shadowOffsetX?: number;\n  shadowOffsetY?: number;\n  textAlign?: TextAlign;\n  noWrap?: boolean;\n  shadowEnabled?: boolean;\n  otherOverlayBounds?: OverlayBounds[];\n  onCollision?: (collidingId: string) => void;\n  onSizeChange?: (size: { width: number; height: number }) => void;\n  showDebugBounds?: boolean;\n};\n\nconst TimestampFloating = forwardRef<TimestampFloatingRef, TimestampFloatingProps>(\n  (\n    {\n      id,\n      label,\n      value,\n      boundingRect,\n      initialRelativePos = { x: 20, y: 20 },\n      fontFamily = \"sans-serif\",\n      fontSize = 24,\n      color = \"#ffffff\",\n      shadowColor = \"#000000\",\n      shadowBlur = 2,\n      shadowOffsetX = 1,\n      shadowOffsetY = 1,\n      textAlign = \"left\",\n      noWrap = false,\n      shadowEnabled = false,\n      otherOverlayBounds = [],\n      onCollision,\n      onSizeChange,\n      showDebugBounds = false,\n    },\n    ref\n  ) => {\n    const [relativePos, setRelativePos] = useState(initialRelativePos);\n    const [size, setSize] = useState({ width: 100, height: 40 });\n    const [measuredWidth, setMeasuredWidth] = useState(100);\n    const [isColliding, setIsColliding] = useState(false);\n    const prevBoundsRef = useRef(boundingRect);\n    const textRef = useRef<HTMLDivElement>(null);\n    const prevRelativePosRef = useRef(relativePos);\n\n    useEffect(() => {\n      prevRelativePosRef.current = relativePos;\n    }, [relativePos]);\n\n    useLayoutEffect(() => {\n      if (textRef.current) {\n        const rect = textRef.current.getBoundingClientRect();\n        const shadowActive = shadowEnabled === true;\n        const shadowBufferX = shadowActive ? Math.max(0, shadowBlur * 2 + Math.abs(shadowOffsetX) * 2) : 0;\n        const shadowBufferY = shadowActive ? Math.max(0, shadowBlur * 2 + Math.abs(shadowOffsetY) * 2) : 0;\n        const newWidth = Math.ceil(rect.width) + shadowBufferX;\n        const newHeight = Math.ceil(rect.height) + shadowBufferY;\n        if (newWidth !== measuredWidth || newHeight !== size.height) {\n          setMeasuredWidth(newWidth);\n          const newSize = { width: newWidth, height: newHeight };\n          setSize(newSize);\n          onSizeChange?.(newSize);\n\n          const maxX = Math.max(0, boundingRect.width - newWidth);\n          const maxY = Math.max(0, boundingRect.height - newHeight);\n          let clampedRelX = Math.max(0, Math.min(relativePos.x, maxX));\n          let clampedRelY = Math.max(0, Math.min(relativePos.y, maxY));\n\n          if (otherOverlayBounds.length > 0) {\n            const myBounds = {\n              x: clampedRelX,\n              y: clampedRelY,\n              width: newWidth,\n              height: newHeight,\n            };\n            const result = resolveAllCollisions(myBounds, otherOverlayBounds, prevRelativePosRef.current);\n            if (result.hasCollision) {\n              clampedRelX = Math.max(0, Math.min(result.x, maxX));\n              clampedRelY = Math.max(0, Math.min(result.y, maxY));\n              setIsColliding(true);\n            }\n          }\n\n          if (clampedRelX !== relativePos.x || clampedRelY !== relativePos.y) {\n            setRelativePos({ x: clampedRelX, y: clampedRelY });\n          }\n        }\n      }\n    }, [value, label, fontFamily, fontSize, boundingRect, relativePos, measuredWidth, size.height, shadowBlur, shadowOffsetX, shadowOffsetY, shadowEnabled, otherOverlayBounds, onSizeChange]);\n\n    useEffect(() => {\n      prevBoundsRef.current = boundingRect;\n    }, [boundingRect]);\n\n    const getBounds = useCallback((): OverlayBounds => ({\n      id,\n      x: relativePos.x,\n      y: relativePos.y,\n      width: size.width,\n      height: size.height,\n    }), [id, relativePos, size]);\n\n    useImperativeHandle(ref, () => ({\n      getRelativePosition: () => relativePos,\n      getSize: () => size,\n      setRelativePosition: (pos: { x: number; y: number }) => setRelativePos(pos),\n      getBounds,\n    }));\n\n    const handleChange = useCallback((absPos: { x: number; y: number }, _newSize: { width: number; height: number }) => {\n      let newRelativeX = absPos.x - boundingRect.x;\n      let newRelativeY = absPos.y - boundingRect.y;\n\n      const myBounds = {\n        x: newRelativeX,\n        y: newRelativeY,\n        width: size.width,\n        height: size.height,\n      };\n\n      const result = resolveAllCollisions(myBounds, otherOverlayBounds, prevRelativePosRef.current);\n      newRelativeX = result.x;\n      newRelativeY = result.y;\n\n      if (result.hasCollision) {\n        otherOverlayBounds.forEach((other) => {\n          if (checkAABBCollision({ x: newRelativeX, y: newRelativeY, width: size.width, height: size.height }, other)) {\n            onCollision?.(other.id);\n          }\n        });\n      }\n\n      const maxX = Math.max(0, boundingRect.width - size.width);\n      const maxY = Math.max(0, boundingRect.height - size.height);\n      newRelativeX = Math.max(0, Math.min(newRelativeX, maxX));\n      newRelativeY = Math.max(0, Math.min(newRelativeY, maxY));\n\n      const finalBounds = {\n        x: newRelativeX,\n        y: newRelativeY,\n        width: size.width,\n        height: size.height,\n      };\n      const stillColliding = otherOverlayBounds.some((other) => checkAABBCollision(finalBounds, other));\n      if (stillColliding) {\n        newRelativeX = prevRelativePosRef.current.x;\n        newRelativeY = prevRelativePosRef.current.y;\n      }\n\n      setIsColliding(result.hasCollision || stillColliding);\n      setRelativePos({ x: newRelativeX, y: newRelativeY });\n    }, [boundingRect, size, otherOverlayBounds, onCollision]);\n\n    const absolutePos = {\n      x: boundingRect.x + relativePos.x,\n      y: boundingRect.y + relativePos.y,\n    };\n\n    const shadowActive = shadowEnabled === true;\n    const textShadow = shadowActive\n      ? `${shadowOffsetX}px ${shadowOffsetY}px ${shadowBlur}px ${shadowColor}, ${-shadowOffsetX}px ${-shadowOffsetY}px ${shadowBlur}px ${shadowColor}, ${shadowOffsetX}px ${-shadowOffsetY}px ${shadowBlur}px ${shadowColor}, ${-shadowOffsetX}px ${shadowOffsetY}px ${shadowBlur}px ${shadowColor}`\n      : \"none\";\n\n    const paddingX = 2;\n    const paddingY = 1;\n\n    const textStyle: React.CSSProperties = {\n      fontFamily,\n      fontSize: `${fontSize}px`,\n      color,\n      textShadow,\n      whiteSpace: noWrap ? \"nowrap\" : \"pre-wrap\",\n      userSelect: \"none\",\n      cursor: \"move\",\n      padding: `${paddingY}px ${paddingX}px`,\n      textAlign,\n      display: \"inline-block\",\n    };\n\n    const containerStyle: React.CSSProperties = {\n      transition: \"outline 0.15s ease-out\",\n      ...(isColliding ? {\n        outline: \"2px solid rgba(255, 100, 100, 0.8)\",\n        outlineOffset: \"-2px\",\n        borderRadius: \"2px\",\n      } : {}),\n      ...(showDebugBounds && !isColliding ? {\n        outline: \"1px dashed rgba(0, 255, 255, 0.6)\",\n        outlineOffset: \"0px\",\n      } : {}),\n    };\n\n    return (\n      <FloatingBorderless\n        pos={absolutePos}\n        size={size}\n        initialSize={size}\n        minWidth={20}\n        minHeight={20}\n        boundingRect={boundingRect}\n        disableResize\n        zIndex={1100}\n        onChange={handleChange}\n        style={containerStyle}\n      >\n        <div ref={textRef} style={textStyle}>\n          {value || label}\n        </div>\n      </FloatingBorderless>\n    );\n  }\n);\n\nTimestampFloating.displayName = \"TimestampFloating\";\n\nexport default TimestampFloating;\n","path":null,"size_bytes":8287,"size_tokens":null},"yuzha/postcss.config.ts":{"content":"export default {\n  plugins: {\n    tailwindcss: {\n      config: \"./tailwind.config.ts\",\n    },\n    autoprefixer: {},\n  },\n};\n","path":null,"size_bytes":124,"size_tokens":null},"meng/src/components/Menu.tsx":{"content":"/**\n * Menu Component\n *\n * Purpose: Display featured and main menu items\n *\n * Features:\n * - Grid layout for menu items\n * - Featured section highlight\n * - Responsive cards with images\n * - Hover effects\n *\n * For Future AI Agents:\n * - Data imported from src/menu.json\n * - Images from vision_expert_agent\n * - Grid: 1 column mobile, 2 columns tablet, 3 columns desktop\n * - Featured items shown first\n * - Add new items by updating menu.json\n */\n\nimport menuData from '../menu.json'\nimport type { MenuItem } from '../types'\n\nconst menuItems = menuData as MenuItem[]\n\nconst Menu = () => {\n  const featuredItems = menuItems.filter((item) => item.category === 'featured')\n  const mainItems = menuItems.filter((item) => item.category === 'main')\n\n  return (\n    <section id=\"menu\" className=\"py-20 bg-gray-50\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Section Header */}\n        <div className=\"text-center mb-16\">\n          <h2 className=\"text-4xl md:text-5xl font-display font-bold text-gray-900 mb-4\">\n            Menu Favorit\n          </h2>\n          <p className=\"text-xl text-gray-600\">The Plantation Cafe</p>\n        </div>\n\n        {/* Featured Items */}\n        <div className=\"mb-16\">\n          <h3 className=\"text-2xl font-display font-semibold text-gray-900 mb-8 text-center\">\n            This or That\n          </h3>\n          <p className=\"text-center text-gray-600 mb-8\">Favorit kalian yang mana nih ??</p>\n          <p className=\"text-center text-gray-600 mb-12\">Iga Bakar atau Hot Plate Singapore</p>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto\">\n            {featuredItems.map((item) => (\n              <div\n                key={item.id}\n                className=\"bg-white rounded-2xl shadow-lg overflow-hidden transform hover:scale-105 transition-transform duration-300\"\n              >\n                <div className=\"relative h-64 overflow-hidden\">\n                  <img\n                    src={item.imageUrl}\n                    alt={item.name}\n                    loading=\"lazy\"\n                    className=\"w-full h-full object-cover\"\n                  />\n                </div>\n                <div className=\"p-6\">\n                  <h4 className=\"text-2xl font-display font-semibold text-gray-900 mb-3\">\n                    {item.name}\n                  </h4>\n                  <p className=\"text-gray-600\">{item.description}</p>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Main Menu Items */}\n        {mainItems.length > 0 && (\n          <div>\n            <h3 className=\"text-2xl font-display font-semibold text-gray-900 mb-8 text-center\">\n              Our Specialties\n            </h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n              {mainItems.map((item) => (\n                <div\n                  key={item.id}\n                  className=\"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-shadow duration-300\"\n                >\n                  <div className=\"relative h-48 overflow-hidden\">\n                    <img\n                      src={item.imageUrl}\n                      alt={item.name}\n                      loading=\"lazy\"\n                      className=\"w-full h-full object-cover\"\n                    />\n                  </div>\n                  <div className=\"p-5\">\n                    <h4 className=\"text-xl font-semibold text-gray-900 mb-2\">{item.name}</h4>\n                    <p className=\"text-gray-600 text-sm\">{item.description}</p>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    </section>\n  )\n}\n\nexport default Menu\n","path":null,"size_bytes":3773,"size_tokens":null},"yuzha/src/App.tsx":{"content":"import React from \"react\";\nimport MainScreen from \"./MainScreen\";\nimport CounterScreen from \"./counter/counterScreen\";\nimport TimestampScreen from \"./timestamp/timestampScreen\";\nimport FloatingScreen from \"@shared/floating/FloatingScreen\";\nimport AlphaRemoveScreen from \"./alphaRemove/alphaRemoveScreen\";\n\ntype AppView = \"main\" | \"counter\" | \"timestamp\" | \"floating\" | \"alphaRemove\";\n\nexport default function App() {\n  const [view, setView] = React.useState<AppView>(\"main\");\n\n  const handleOpenCounter = React.useCallback(() => setView(\"counter\"), []);\n  const handleOpenTimestamp = React.useCallback(() => setView(\"timestamp\"), []);\n  const handleOpenFloating = React.useCallback(() => setView(\"floating\"), []);\n  const handleOpenAlphaRemove = React.useCallback(() => setView(\"alphaRemove\"), []);\n  const handleReturnToMain = React.useCallback(() => setView(\"main\"), []);\n\n  if (view === \"counter\") {\n    return <CounterScreen onBack={handleReturnToMain} />;\n  }\n\n  if (view === \"timestamp\") {\n    return <TimestampScreen onBack={handleReturnToMain} />;\n  }\n\n  if (view === \"floating\") {\n    return <FloatingScreen onBack={handleReturnToMain} />;\n  }\n  if (view === \"alphaRemove\") {\n    return <AlphaRemoveScreen onBack={handleReturnToMain} />;\n  }\n\n  return (\n    <MainScreen\n      onOpenCounterScreen={handleOpenCounter}\n      onOpenTimestampScreen={handleOpenTimestamp}\n      onOpenFloatingScreen={handleOpenFloating}\n      onOpenAlphaRemoveScreen={handleOpenAlphaRemove}\n    />\n  );\n}\n","path":null,"size_bytes":1491,"size_tokens":null},"yuzha/src/timestamp/timestampScreen.tsx":{"content":"import React, { useEffect, useRef, useState, useCallback } from \"react\";\nimport TimestampHeader from \"./TimestampHeader\";\nimport TimestampPreview from \"./TimestampPreview\";\nimport TimestampFloating, { type TimestampFloatingRef } from \"./TimestampFloating\";\nimport ImageFloating, { type ImageFloatingRef } from \"./ImageFloating\";\nimport TimestampSettings from \"./TimestampSettings\";\nimport { addPreset, type TimestampPreset } from \"./PresetManager\";\nimport { type Overlay, type TextOverlay, type ImageOverlay, type TextAlign, DEFAULT_STATE, DEFAULT_OVERLAYS, checkAABBCollision, resolveAllCollisions, type OverlayBounds } from \"./types\";\n\nexport type TimestampScreenProps = {\n  onBack?: () => void;\n};\n\ntype HistoryEntry = {\n  scale: number;\n  translateX: number;\n  translateY: number;\n  rotation: number;\n  textColor: string;\n  shadowColor: string;\n  shadowBlur: number;\n  shadowOffsetX: number;\n  shadowOffsetY: number;\n  customFonts: string[];\n  overlays: Overlay[];\n};\n\nfunction cloneOverlay(overlay: Overlay): Overlay {\n  return {\n    ...overlay,\n    position: { ...overlay.position },\n  };\n}\n\nfunction cloneState(s: HistoryEntry): HistoryEntry {\n  return {\n    ...s,\n    customFonts: [...s.customFonts],\n    overlays: s.overlays.map(cloneOverlay),\n  };\n}\n\nexport default function TimestampScreen({ onBack }: TimestampScreenProps) {\n  const [hInput, setHInput] = useState(\"1\");\n  const [wInput, setWInput] = useState(\"1\");\n  const [headerHeight, setHeaderHeight] = useState(56);\n  const headerRef = useRef<HTMLDivElement>(null);\n  const settingsRef = useRef<HTMLDivElement>(null);\n  const [viewport, setViewport] = useState<{ vw: number; vh: number }>({\n    vw: typeof window !== \"undefined\" ? window.innerWidth : 1024,\n    vh: typeof window !== \"undefined\" ? window.innerHeight : 768,\n  });\n\n  const [imageSrc, setImageSrc] = useState<string | null>(null);\n  const [scale, setScale] = useState(DEFAULT_STATE.scale);\n  const [translateX, setTranslateX] = useState(DEFAULT_STATE.translateX);\n  const [translateY, setTranslateY] = useState(DEFAULT_STATE.translateY);\n  const [rotation, setRotation] = useState(DEFAULT_STATE.rotation);\n\n  const [textColor, setTextColor] = useState(DEFAULT_STATE.textColor);\n  const [shadowColor, setShadowColor] = useState(DEFAULT_STATE.shadowColor);\n  const [shadowBlur, setShadowBlur] = useState(DEFAULT_STATE.shadowBlur);\n  const [shadowOffsetX, setShadowOffsetX] = useState(DEFAULT_STATE.shadowOffsetX);\n  const [shadowOffsetY, setShadowOffsetY] = useState(DEFAULT_STATE.shadowOffsetY);\n\n  const [customFonts, setCustomFonts] = useState<string[]>([]);\n\n  const [overlays, setOverlays] = useState<Overlay[]>(() =>\n    DEFAULT_OVERLAYS.map(cloneOverlay)\n  );\n\n  const [previewBounds, setPreviewBounds] = useState({ x: 0, y: 0, width: 0, height: 0 });\n  const [showDebugBounds] = useState(true);\n  const nextImageIdRef = useRef(1);\n\n  const textOverlayRefsMap = useRef<Map<string, TimestampFloatingRef>>(new Map());\n  const imageOverlayRefsMap = useRef<Map<string, ImageFloatingRef>>(new Map());\n\n  const setOverlayRef = useCallback((id: string, ref: TimestampFloatingRef | null) => {\n    if (ref) {\n      textOverlayRefsMap.current.set(id, ref);\n    } else {\n      textOverlayRefsMap.current.delete(id);\n    }\n  }, []);\n\n  const setImageOverlayRef = useCallback((id: string, ref: ImageFloatingRef | null) => {\n    if (ref) {\n      imageOverlayRefsMap.current.set(id, ref);\n    } else {\n      imageOverlayRefsMap.current.delete(id);\n    }\n  }, []);\n\n  const getOverlayRef = useCallback((id: string): TimestampFloatingRef | null => {\n    return textOverlayRefsMap.current.get(id) ?? null;\n  }, []);\n\n  const getImageOverlayRef = useCallback((id: string): ImageFloatingRef | null => {\n    return imageOverlayRefsMap.current.get(id) ?? null;\n  }, []);\n\n  const getAnyOverlayBounds = useCallback((id: string) => {\n    const textRef = textOverlayRefsMap.current.get(id);\n    if (textRef) return textRef.getBounds();\n    const imageRef = imageOverlayRefsMap.current.get(id);\n    if (imageRef) return imageRef.getBounds();\n    return null;\n  }, []);\n\n  const [history, setHistory] = useState<HistoryEntry[]>([]);\n  const [historyIndex, setHistoryIndex] = useState(-1);\n  const isUndoRedoRef = useRef(false);\n\n  const getCurrentState = useCallback((): HistoryEntry => {\n    const updatedOverlays = overlays.map((overlay) => {\n      if (overlay.type === \"text\") {\n        const ref = getOverlayRef(overlay.id);\n        if (ref) {\n          return { ...overlay, position: ref.getRelativePosition() };\n        }\n      } else if (overlay.type === \"image\") {\n        const ref = getImageOverlayRef(overlay.id);\n        if (ref) {\n          const size = ref.getSize();\n          return { ...overlay, position: ref.getRelativePosition(), width: size.width, height: size.height };\n        }\n      }\n      return overlay;\n    });\n\n    return {\n      scale,\n      translateX,\n      translateY,\n      rotation,\n      textColor,\n      shadowColor,\n      shadowBlur,\n      shadowOffsetX,\n      shadowOffsetY,\n      customFonts: [...customFonts],\n      overlays: updatedOverlays,\n    };\n  }, [scale, translateX, translateY, rotation, textColor, shadowColor, shadowBlur, shadowOffsetX, shadowOffsetY, customFonts, overlays, getOverlayRef, getImageOverlayRef]);\n\n  const pushHistory = useCallback((overrides?: Partial<HistoryEntry>) => {\n    if (isUndoRedoRef.current) {\n      isUndoRedoRef.current = false;\n      return;\n    }\n    const current = getCurrentState();\n    const stateToSave = overrides ? { ...current, ...overrides } : current;\n    setHistory((prev) => {\n      const newHistory = prev.slice(0, historyIndex + 1);\n      newHistory.push(cloneState(stateToSave));\n      if (newHistory.length > 50) newHistory.shift();\n      return newHistory;\n    });\n    setHistoryIndex((prev) => Math.min(prev + 1, 49));\n  }, [getCurrentState, historyIndex]);\n\n  const applyState = useCallback((entry: HistoryEntry) => {\n    isUndoRedoRef.current = true;\n    setScale(entry.scale);\n    setTranslateX(entry.translateX);\n    setTranslateY(entry.translateY);\n    setRotation(entry.rotation);\n    setTextColor(entry.textColor);\n    setShadowColor(entry.shadowColor);\n    setShadowBlur(entry.shadowBlur);\n    setShadowOffsetX(entry.shadowOffsetX);\n    setShadowOffsetY(entry.shadowOffsetY);\n    setCustomFonts([...entry.customFonts]);\n    setOverlays(entry.overlays.map(cloneOverlay));\n\n    entry.overlays.forEach((overlay) => {\n      if (overlay.type === \"text\") {\n        const ref = getOverlayRef(overlay.id);\n        ref?.setRelativePosition(overlay.position);\n      } else if (overlay.type === \"image\") {\n        const ref = getImageOverlayRef(overlay.id);\n        if (ref) {\n          ref.setRelativePosition(overlay.position);\n          ref.setSize({ width: overlay.width, height: overlay.height });\n        }\n      }\n    });\n  }, [getOverlayRef, getImageOverlayRef]);\n\n  const handleUndo = useCallback(() => {\n    if (historyIndex > 0) {\n      const newIndex = historyIndex - 1;\n      const entry = history[newIndex];\n      if (entry) {\n        setHistoryIndex(newIndex);\n        applyState(entry);\n      }\n    }\n  }, [historyIndex, history, applyState]);\n\n  const handleRedo = useCallback(() => {\n    if (historyIndex < history.length - 1) {\n      const newIndex = historyIndex + 1;\n      const entry = history[newIndex];\n      if (entry) {\n        setHistoryIndex(newIndex);\n        applyState(entry);\n      }\n    }\n  }, [historyIndex, history, applyState]);\n\n  useEffect(() => {\n    if (history.length === 0) {\n      const initial = getCurrentState();\n      setHistory([cloneState(initial)]);\n      setHistoryIndex(0);\n    }\n  }, []);\n\n  useEffect(() => {\n    const handle = () => {\n      setViewport({ vw: window.innerWidth, vh: window.innerHeight });\n      if (headerRef.current) {\n        setHeaderHeight(headerRef.current.offsetHeight);\n      }\n    };\n    handle();\n    window.addEventListener(\"resize\", handle);\n    return () => window.removeEventListener(\"resize\", handle);\n  }, []);\n\n  useEffect(() => {\n    if (!imageSrc || previewBounds.width === 0) return;\n    \n    const timeoutId = setTimeout(() => {\n      const maxGlobalIterations = 10;\n      \n      for (let globalIteration = 0; globalIteration < maxGlobalIterations; globalIteration++) {\n        const allBounds: OverlayBounds[] = [];\n        overlays.forEach((o) => {\n          const bounds = getAnyOverlayBounds(o.id);\n          if (bounds) {\n            allBounds.push({ ...bounds });\n          }\n        });\n        \n        if (allBounds.length < 2) return;\n        \n        let anyCollisionResolved = false;\n        \n        for (let i = 0; i < allBounds.length; i++) {\n          const current = allBounds[i]!;\n          const others = allBounds.filter((_, idx) => idx !== i);\n          \n          const hasCollision = others.some((other) => checkAABBCollision(current, other));\n          if (hasCollision) {\n            const result = resolveAllCollisions(current, others, { x: current.x, y: current.y });\n            if (result.x !== current.x || result.y !== current.y) {\n              const maxX = Math.max(0, previewBounds.width - current.width);\n              const maxY = Math.max(0, previewBounds.height - current.height);\n              const clampedX = Math.max(0, Math.min(result.x, maxX));\n              const clampedY = Math.max(0, Math.min(result.y, maxY));\n              \n              const textRef = textOverlayRefsMap.current.get(current.id);\n              if (textRef) {\n                textRef.setRelativePosition({ x: clampedX, y: clampedY });\n              }\n              const imageRef = imageOverlayRefsMap.current.get(current.id);\n              if (imageRef) {\n                imageRef.setRelativePosition({ x: clampedX, y: clampedY });\n              }\n              \n              current.x = clampedX;\n              current.y = clampedY;\n              anyCollisionResolved = true;\n            }\n          }\n        }\n        \n        if (!anyCollisionResolved) {\n          break;\n        }\n      }\n    }, 100);\n    \n    return () => clearTimeout(timeoutId);\n  }, [imageSrc, previewBounds, overlays, getAnyOverlayBounds]);\n\n  const clampRatio = (val: number) => Math.max(1, Math.min(32, Math.round(val) || 1));\n  const parseRatio = (input: string) => {\n    const num = parseInt(input, 10);\n    return isNaN(num) ? 1 : clampRatio(num);\n  };\n  const safeH = parseRatio(hInput);\n  const safeW = parseRatio(wInput);\n\n  const handleBlur = (setter: (val: string) => void, input: string) => {\n    const validated = parseRatio(input);\n    setter(String(validated));\n  };\n\n  const handleIncrement = (setter: (val: string) => void, current: string) => {\n    const num = parseInt(current, 10) || 0;\n    const newVal = Math.min(32, num + 1);\n    setter(String(newVal));\n  };\n\n  const handleDecrement = (setter: (val: string) => void, current: string) => {\n    const num = parseInt(current, 10) || 0;\n    const newVal = Math.max(1, num - 1);\n    setter(String(newVal));\n  };\n\n  const padding = 4;\n  const availableWidth = viewport.vw - padding * 2;\n  const availableHeight = viewport.vh - headerHeight - padding;\n  const aspectRatio = safeW / safeH;\n\n  let widthPx: number;\n  let heightPx: number;\n\n  if (availableWidth / availableHeight > aspectRatio) {\n    heightPx = availableHeight;\n    widthPx = heightPx * aspectRatio;\n  } else {\n    widthPx = availableWidth;\n    heightPx = widthPx / aspectRatio;\n  }\n\n  const handleOpenSettings = useCallback(() => {\n    settingsRef.current?.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n  }, []);\n\n  const handleCloseSettings = useCallback(() => {\n    settingsRef.current?.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n  }, []);\n\n  const handleOpenFile = useCallback(() => {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \"image/*\";\n    input.onchange = (e) => {\n      const file = (e.target as HTMLInputElement).files?.[0];\n      if (file) {\n        const url = URL.createObjectURL(file);\n        setImageSrc(url);\n        setScale(1);\n        setTranslateX(0);\n        setTranslateY(0);\n        setRotation(0);\n        pushHistory();\n      }\n    };\n    input.click();\n  }, [pushHistory]);\n\n  const handleTranslateChange = useCallback((x: number, y: number) => {\n    setTranslateX(x);\n    setTranslateY(y);\n  }, []);\n\n  const handleBoundsChange = useCallback((bounds: { x: number; y: number; width: number; height: number }) => {\n    setPreviewBounds(bounds);\n  }, []);\n\n  const handleResetPosition = useCallback(() => {\n    setTranslateX(0);\n    setTranslateY(0);\n    pushHistory();\n  }, [pushHistory]);\n\n  const handleAddCustomFont = useCallback((fontName: string, fontDataUrl: string) => {\n    const fontFace = new FontFace(fontName, `url(${fontDataUrl})`);\n    fontFace.load().then((loaded) => {\n      (document.fonts as unknown as { add: (font: FontFace) => void }).add(loaded);\n      setCustomFonts((prev) => (prev.includes(fontName) ? prev : [...prev, fontName]));\n      pushHistory();\n    });\n  }, [pushHistory]);\n\n  const addImageOverlay = useCallback((imageSrcUrl: string, width: number, height: number) => {\n    const id = `image-${nextImageIdRef.current}`;\n    const maxWidth = Math.min(width, previewBounds.width * 0.5);\n    const scaleRatio = maxWidth / width;\n    const scaledWidth = width * scaleRatio;\n    const scaledHeight = height * scaleRatio;\n\n    const newOverlay: ImageOverlay = {\n      id,\n      type: \"image\",\n      label: `Image ${nextImageIdRef.current}`,\n      src: imageSrcUrl,\n      position: { x: 20, y: 20 },\n      width: scaledWidth,\n      height: scaledHeight,\n      isPermanent: false,\n    };\n\n    nextImageIdRef.current += 1;\n    setOverlays((prevOverlays) => [...prevOverlays, newOverlay]);\n    pushHistory();\n  }, [previewBounds.width, pushHistory]);\n\n  const deleteImageOverlay = useCallback((id: string) => {\n    setOverlays((prev) => {\n      const overlay = prev.find((o) => o.id === id);\n      if (overlay && overlay.type === \"image\" && overlay.src.startsWith(\"blob:\")) {\n        URL.revokeObjectURL(overlay.src);\n      }\n      return prev.filter((o) => o.id !== id || o.isPermanent);\n    });\n    imageOverlayRefsMap.current.delete(id);\n    pushHistory();\n  }, [pushHistory]);\n\n  const handleAddImageOverlay = useCallback(() => {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \"image/*\";\n    input.onchange = (e) => {\n      const file = (e.target as HTMLInputElement).files?.[0];\n      if (file) {\n        const url = URL.createObjectURL(file);\n        const img = new Image();\n        img.onload = () => {\n          addImageOverlay(url, img.width, img.height);\n        };\n        img.src = url;\n      }\n    };\n    input.click();\n  }, [addImageOverlay]);\n\n  const syncOverlayPositionsFromRefs = useCallback(() => {\n    setOverlays((prev) =>\n      prev.map((overlay) => {\n        if (overlay.type === \"text\") {\n          const ref = getOverlayRef(overlay.id);\n          if (ref) {\n            return { ...overlay, position: ref.getRelativePosition() };\n          }\n        } else if (overlay.type === \"image\") {\n          const ref = getImageOverlayRef(overlay.id);\n          if (ref) {\n            const size = ref.getSize();\n            return { ...overlay, position: ref.getRelativePosition(), width: size.width, height: size.height };\n          }\n        }\n        return overlay;\n      })\n    );\n  }, [getOverlayRef, getImageOverlayRef]);\n\n  const handleSavePreset = useCallback((name: string) => {\n    syncOverlayPositionsFromRefs();\n\n    const currentOverlays = overlays.map((overlay) => {\n      if (overlay.type === \"text\") {\n        const ref = getOverlayRef(overlay.id);\n        if (ref) {\n          return { ...overlay, position: { ...ref.getRelativePosition() } };\n        }\n      } else if (overlay.type === \"image\") {\n        const ref = getImageOverlayRef(overlay.id);\n        if (ref) {\n          const size = ref.getSize();\n          return { ...overlay, position: { ...ref.getRelativePosition() }, width: size.width, height: size.height };\n        }\n      }\n      return { ...overlay, position: { ...overlay.position } };\n    });\n\n    addPreset({\n      name,\n      scale,\n      translateX,\n      translateY,\n      rotation,\n      textColor,\n      shadowColor,\n      shadowBlur,\n      shadowOffsetX,\n      shadowOffsetY,\n      customFonts,\n      overlays: currentOverlays,\n    });\n  }, [scale, translateX, translateY, rotation, textColor, shadowColor, shadowBlur, shadowOffsetX, shadowOffsetY, customFonts, overlays, getOverlayRef, getImageOverlayRef, syncOverlayPositionsFromRefs]);\n\n  const handleLoadPreset = useCallback((preset: TimestampPreset) => {\n    setScale(preset.scale);\n    setTranslateX(preset.translateX);\n    setTranslateY(preset.translateY);\n    setRotation(preset.rotation);\n    setTextColor(preset.textColor);\n    setShadowColor(preset.shadowColor);\n    setShadowBlur(preset.shadowBlur);\n    setShadowOffsetX(preset.shadowOffsetX);\n    setShadowOffsetY(preset.shadowOffsetY);\n    setCustomFonts([...preset.customFonts]);\n\n    setOverlays((prevOverlays) => {\n      prevOverlays.forEach((o) => {\n        if (o.type === \"image\" && o.src.startsWith(\"blob:\")) {\n          URL.revokeObjectURL(o.src);\n        }\n      });\n      return prevOverlays;\n    });\n\n    imageOverlayRefsMap.current.clear();\n\n    const restoredOverlays = preset.overlays.map((o) => ({\n      ...o,\n      position: { ...o.position },\n    }));\n\n    setOverlays(restoredOverlays);\n\n    let maxImageId = 0;\n    restoredOverlays.forEach((o) => {\n      if (o.type === \"image\") {\n        const numPart = parseInt(o.id.replace(\"image-\", \"\"), 10);\n        if (!isNaN(numPart) && numPart >= maxImageId) {\n          maxImageId = numPart + 1;\n        }\n      }\n    });\n    nextImageIdRef.current = maxImageId;\n\n    setTimeout(() => {\n      restoredOverlays.forEach((o) => {\n        if (o.type === \"text\") {\n          getOverlayRef(o.id)?.setRelativePosition(o.position);\n        } else if (o.type === \"image\") {\n          getImageOverlayRef(o.id)?.setRelativePosition(o.position);\n        }\n      });\n    }, 0);\n\n    pushHistory();\n  }, [pushHistory, getOverlayRef, getImageOverlayRef]);\n\n  const handleSave = useCallback(async () => {\n    if (!imageSrc) return;\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = widthPx;\n    canvas.height = heightPx;\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return;\n\n    const img = new Image();\n    img.crossOrigin = \"anonymous\";\n    img.src = imageSrc;\n    await new Promise((resolve) => {\n      img.onload = resolve;\n    });\n\n    ctx.save();\n    ctx.translate(canvas.width / 2 + translateX, canvas.height / 2 + translateY);\n    ctx.rotate((rotation * Math.PI) / 180);\n    ctx.scale(scale, scale);\n    ctx.drawImage(img, -img.width / 2, -img.height / 2);\n    ctx.restore();\n\n    type ImageLoadResult = { img: HTMLImageElement; x: number; y: number; w: number; h: number } | null;\n    const imageLoadPromises: Promise<ImageLoadResult>[] = [];\n\n    overlays.forEach((overlay) => {\n      if (overlay.type === \"text\") {\n        const ref = getOverlayRef(overlay.id);\n        if (ref) {\n          const relPos = ref.getRelativePosition();\n          const size = ref.getSize();\n\n          const shadowActive = overlay.shadowEnabled === true;\n          const paddingX = 2;\n\n          ctx.font = `${overlay.fontSize}px ${overlay.fontFamily}`;\n          ctx.fillStyle = textColor;\n          ctx.shadowColor = shadowActive ? shadowColor : \"transparent\";\n          ctx.shadowBlur = shadowActive ? shadowBlur : 0;\n          ctx.shadowOffsetX = shadowActive ? shadowOffsetX : 0;\n          ctx.shadowOffsetY = shadowActive ? shadowOffsetY : 0;\n          ctx.textAlign = overlay.textAlign;\n\n          let xPos: number;\n          if (overlay.textAlign === \"center\") {\n            xPos = relPos.x + size.width / 2;\n          } else if (overlay.textAlign === \"right\") {\n            xPos = relPos.x + size.width - paddingX;\n          } else {\n            xPos = relPos.x + paddingX;\n          }\n\n          const lines = overlay.text.split(\"\\n\");\n          lines.forEach((line, i) => {\n            ctx.fillText(line, xPos, relPos.y + overlay.fontSize + i * overlay.fontSize * 1.2);\n          });\n        }\n      } else if (overlay.type === \"image\") {\n        const ref = getImageOverlayRef(overlay.id);\n        if (ref) {\n          const relPos = ref.getRelativePosition();\n          const size = ref.getSize();\n          const imgSrc = overlay.src;\n          const loadPromise = new Promise<{ img: HTMLImageElement; x: number; y: number; w: number; h: number } | null>((resolve) => {\n            const overlayImg = new Image();\n            overlayImg.crossOrigin = \"anonymous\";\n            overlayImg.onload = () => {\n              resolve({ img: overlayImg, x: relPos.x, y: relPos.y, w: size.width, h: size.height });\n            };\n            overlayImg.onerror = () => resolve(null);\n            overlayImg.src = imgSrc;\n          });\n          imageLoadPromises.push(loadPromise);\n        }\n      }\n    });\n\n    const loadedImages = await Promise.all(imageLoadPromises);\n    loadedImages.forEach((loaded) => {\n      if (loaded) {\n        ctx.drawImage(loaded.img, loaded.x, loaded.y, loaded.w, loaded.h);\n      }\n    });\n\n    canvas.toBlob((blob) => {\n      if (!blob) return;\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement(\"a\");\n      a.href = url;\n      a.download = \"timestamp-photo.png\";\n      a.click();\n      URL.revokeObjectURL(url);\n    }, \"image/png\");\n  }, [imageSrc, widthPx, heightPx, translateX, translateY, rotation, scale, textColor, shadowColor, shadowBlur, shadowOffsetX, shadowOffsetY, overlays, getOverlayRef, getImageOverlayRef]);\n\n  const handleSettingsChange = useCallback(() => {\n    pushHistory();\n  }, [pushHistory]);\n\n  const MARGIN = 20;\n\n  const handleAlignmentChange = useCallback((overlayId: string, textAlign: TextAlign) => {\n    const ref = getOverlayRef(overlayId);\n    if (!ref || previewBounds.width === 0) return;\n\n    const size = ref.getSize();\n    const currentPos = ref.getRelativePosition();\n    let newX: number;\n\n    if (size.width === 0) {\n      newX = currentPos.x;\n    } else if (textAlign === \"left\") {\n      newX = MARGIN;\n    } else if (textAlign === \"center\") {\n      newX = (previewBounds.width - size.width) / 2;\n    } else {\n      newX = previewBounds.width - size.width - MARGIN;\n    }\n\n    const newPos = { x: newX, y: currentPos.y };\n    ref.setRelativePosition(newPos);\n\n    setOverlays((prev) =>\n      prev.map((overlay) =>\n        overlay.id === overlayId && overlay.type === \"text\"\n          ? { ...overlay, textAlign, position: newPos }\n          : overlay\n      )\n    );\n\n    pushHistory();\n  }, [previewBounds.width, pushHistory, getOverlayRef]);\n\n  const handleOverlaySettingsChange = useCallback((overlayId: string, updates: Partial<TextOverlay>) => {\n    syncOverlayPositionsFromRefs();\n    setOverlays((prev) =>\n      prev.map((overlay) =>\n        overlay.id === overlayId && overlay.type === \"text\"\n          ? { ...overlay, ...updates }\n          : overlay\n      )\n    );\n    handleSettingsChange();\n  }, [handleSettingsChange, syncOverlayPositionsFromRefs]);\n\n  const timeOverlay = overlays.find((o) => o.id === \"time\") as TextOverlay | undefined;\n  const dateOverlay = overlays.find((o) => o.id === \"date\") as TextOverlay | undefined;\n  const locationOverlay = overlays.find((o) => o.id === \"location\") as TextOverlay | undefined;\n\n  const toOverlaySettings = (overlay: TextOverlay | undefined) => {\n    if (!overlay) {\n      return {\n        text: \"\",\n        fontFamily: \"sans-serif\",\n        fontSize: 24,\n        textAlign: \"left\" as TextAlign,\n        position: { x: 20, y: 20 },\n        shadowEnabled: false,\n      };\n    }\n    return {\n      text: overlay.text,\n      fontFamily: overlay.fontFamily,\n      fontSize: overlay.fontSize,\n      textAlign: overlay.textAlign,\n      position: overlay.position,\n      shadowEnabled: overlay.shadowEnabled === true,\n    };\n  };\n\n  const getOtherOverlayBounds = useCallback((currentId: string) => {\n    return overlays\n      .filter((o) => o.id !== currentId)\n      .map((o) => {\n        const bounds = getAnyOverlayBounds(o.id);\n        if (bounds) {\n          return bounds;\n        }\n        if (o.type === \"image\") {\n          return {\n            id: o.id,\n            x: o.position.x,\n            y: o.position.y,\n            width: o.width,\n            height: o.height,\n          };\n        }\n        const textOverlay = o as TextOverlay;\n        const estimatedCharWidth = textOverlay.fontSize * 0.6;\n        const shadowActive = textOverlay.shadowEnabled === true;\n        const shadowBuffer = shadowActive ? shadowBlur * 2 : 0;\n        const estimatedWidth = Math.max(100, textOverlay.text.length * estimatedCharWidth + 4 + shadowBuffer);\n        const estimatedHeight = textOverlay.fontSize + 2 + shadowBuffer;\n        return {\n          id: o.id,\n          x: o.position.x,\n          y: o.position.y,\n          width: estimatedWidth,\n          height: estimatedHeight,\n        };\n      });\n  }, [overlays, getAnyOverlayBounds, shadowBlur]);\n\n  return (\n    <div className=\"flex h-screen w-screen flex-col overflow-hidden bg-slate-950 text-white\">\n      <TimestampHeader\n        ref={headerRef}\n        onBack={onBack}\n        hInput={hInput}\n        wInput={wInput}\n        onHInputChange={setHInput}\n        onWInputChange={setWInput}\n        onHInputBlur={() => handleBlur(setHInput, hInput)}\n        onWInputBlur={() => handleBlur(setWInput, wInput)}\n        onHIncrement={() => handleIncrement(setHInput, hInput)}\n        onHDecrement={() => handleDecrement(setHInput, hInput)}\n        onWIncrement={() => handleIncrement(setWInput, wInput)}\n        onWDecrement={() => handleDecrement(setWInput, wInput)}\n        onOpen={handleOpenFile}\n        onSettings={handleOpenSettings}\n        onSave={handleSave}\n        onUndo={handleUndo}\n        onRedo={handleRedo}\n        canUndo={historyIndex > 0}\n        canRedo={historyIndex < history.length - 1}\n      />\n      <TimestampPreview\n        widthPx={widthPx}\n        heightPx={heightPx}\n        imageSrc={imageSrc}\n        scale={scale}\n        translateX={translateX}\n        translateY={translateY}\n        rotation={rotation}\n        onScaleChange={setScale}\n        onTranslateChange={handleTranslateChange}\n        onBoundsChange={handleBoundsChange}\n      />\n\n      {imageSrc && previewBounds.width > 0 && (\n        <>\n          {overlays.map((overlay) => {\n            if (overlay.type === \"text\") {\n              return (\n                <TimestampFloating\n                  key={overlay.id}\n                  id={overlay.id}\n                  ref={(ref) => setOverlayRef(overlay.id, ref)}\n                  label={overlay.label}\n                  value={overlay.text}\n                  boundingRect={previewBounds}\n                  initialRelativePos={overlay.position}\n                  fontFamily={overlay.fontFamily}\n                  fontSize={overlay.fontSize}\n                  color={textColor}\n                  shadowColor={shadowColor}\n                  shadowBlur={shadowBlur}\n                  shadowOffsetX={shadowOffsetX}\n                  shadowOffsetY={shadowOffsetY}\n                  textAlign={overlay.textAlign}\n                  noWrap={overlay.noWrap}\n                  shadowEnabled={overlay.shadowEnabled}\n                  otherOverlayBounds={getOtherOverlayBounds(overlay.id)}\n                  showDebugBounds={showDebugBounds}\n                />\n              );\n            }\n            if (overlay.type === \"image\") {\n              return (\n                <ImageFloating\n                  key={overlay.id}\n                  id={overlay.id}\n                  ref={(ref) => setImageOverlayRef(overlay.id, ref)}\n                  src={overlay.src}\n                  boundingRect={previewBounds}\n                  initialRelativePos={overlay.position}\n                  initialSize={{ width: overlay.width, height: overlay.height }}\n                  otherOverlayBounds={getOtherOverlayBounds(overlay.id)}\n                  onDelete={() => deleteImageOverlay(overlay.id)}\n                  showDebugBounds={showDebugBounds}\n                />\n              );\n            }\n            return null;\n          })}\n        </>\n      )}\n\n      <div ref={settingsRef}>\n        <TimestampSettings\n          textColor={textColor}\n          onTextColorChange={(v) => { setTextColor(v); handleSettingsChange(); }}\n          shadowColor={shadowColor}\n          onShadowColorChange={(v) => { setShadowColor(v); handleSettingsChange(); }}\n          shadowBlur={shadowBlur}\n          onShadowBlurChange={(v) => { setShadowBlur(v); handleSettingsChange(); }}\n          shadowOffsetX={shadowOffsetX}\n          onShadowOffsetXChange={(v) => { setShadowOffsetX(v); handleSettingsChange(); }}\n          shadowOffsetY={shadowOffsetY}\n          onShadowOffsetYChange={(v) => { setShadowOffsetY(v); handleSettingsChange(); }}\n          scale={scale}\n          onScaleChange={(v) => { setScale(v); handleSettingsChange(); }}\n          translateX={translateX}\n          onTranslateXChange={(v) => { setTranslateX(v); handleSettingsChange(); }}\n          translateY={translateY}\n          onTranslateYChange={(v) => { setTranslateY(v); handleSettingsChange(); }}\n          rotation={rotation}\n          onRotationChange={(v) => { setRotation(v); handleSettingsChange(); }}\n          onResetPosition={handleResetPosition}\n          customFonts={customFonts}\n          onAddCustomFont={handleAddCustomFont}\n          timeSettings={toOverlaySettings(timeOverlay)}\n          onTimeSettingsChange={(v) => handleOverlaySettingsChange(\"time\", v)}\n          dateSettings={toOverlaySettings(dateOverlay)}\n          onDateSettingsChange={(v) => handleOverlaySettingsChange(\"date\", v)}\n          locationSettings={toOverlaySettings(locationOverlay)}\n          onLocationSettingsChange={(v) => handleOverlaySettingsChange(\"location\", v)}\n          previewBounds={previewBounds}\n          onTimeAlignmentChange={(align) => handleAlignmentChange(\"time\", align)}\n          onDateAlignmentChange={(align) => handleAlignmentChange(\"date\", align)}\n          onLocationAlignmentChange={(align) => handleAlignmentChange(\"location\", align)}\n          onSavePreset={handleSavePreset}\n          onLoadPreset={handleLoadPreset}\n          onAddImageOverlay={handleAddImageOverlay}\n          onClose={handleCloseSettings}\n        />\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":30525,"size_tokens":null},"shared/utils/RendererDetector.ts":{"content":"/**\n * Detect if the current environment is an AI agent or headless browser\n * that might not support WebGL properly for screenshots\n */\n\nexport function isAIAgentEnvironment(): boolean {\n  // Check if running in a headless browser (common for AI agents)\n  if (typeof window === \"undefined\") {\n    return true;\n  }\n\n  // Check if WebGL is not supported\n  if (!(\"WebGLRenderingContext\" in window)) {\n    return true;\n  }\n\n  // Check for webdriver (automated browser)\n  if (navigator.webdriver === true) {\n    return true;\n  }\n\n  // Check for headless user agents\n  const ua = navigator.userAgent.toLowerCase();\n  if (ua.includes(\"headless\") || ua.includes(\"phantom\") || ua.includes(\"selenium\")) {\n    return true;\n  }\n\n  // Try to create a WebGL context to verify it actually works\n  try {\n    const canvas = document.createElement(\"canvas\");\n    const gl = canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\");\n    if (!gl) {\n      return true;\n    }\n  } catch {\n    return true;\n  }\n\n  return false;\n}\n\nexport function getRendererType(): \"three\" | \"canvas\" {\n  const isAIAgent = isAIAgentEnvironment();\n  const rendererType = isAIAgent ? \"canvas\" : \"three\";\n\n  console.log(\"[RendererDetector] Environment detection:\", {\n    isAIAgent,\n    rendererType,\n    userAgent: typeof navigator !== \"undefined\" ? navigator.userAgent : \"N/A\",\n    hasWebGL: typeof window !== \"undefined\" && \"WebGLRenderingContext\" in window,\n  });\n\n  return rendererType;\n}\n","path":null,"size_bytes":1464,"size_tokens":null},"shared/utils/NavScreen.tsx":{"content":"/**\n * NavScreen.tsx - Universal Screen Template System\n *\n * A flexible image-based UI component system for Android/mobile devices.\n * Separate from MainScreenUtils with unique type names to avoid conflicts.\n *\n * Key Features:\n * - 3-state image system (normal/pressed/hover)\n * - Fallback to default button styling when no images\n * - \"cover\" and \"contain\" fit modes\n * - 2048×2048 stage coordinate positioning\n * - Touch-optimized gesture system\n * - Responsive viewport scaling\n */\n\nimport React from \"react\";\nimport type { CSSProperties } from \"react\";\n\n// ===================================================================\n// STAGE DIMENSIONS AND COORDINATE SYSTEM\n// Using 2048×2048 stage for consistent positioning across devices\n// ===================================================================\n\n/** Stage dimensions - 2048×2048 coordinate system */\nexport const NAV_STAGE_WIDTH = 2048;\nexport const NAV_STAGE_HEIGHT = 2048;\n\n/** Stage center coordinates */\nexport const NAV_STAGE_CENTER_X = NAV_STAGE_WIDTH / 2; // 1024\nexport const NAV_STAGE_CENTER_Y = NAV_STAGE_HEIGHT / 2; // 1024\n\n// ===================================================================\n// TYPE DEFINITIONS\n// Using NavScreen* naming convention to avoid MainScreen conflicts\n// ===================================================================\n\n/** Image fit mode for containers */\nexport type NavImageFitMode = \"cover\" | \"contain\";\n\n/** 3-state image configuration */\nexport type NavImageState = {\n  /** Default state image path */\n  normalImage: string | null;\n  /** Image when button is pressed */\n  pressedImage: string | null;\n  /** Optional hover effect (default: null for mobile) */\n  hoverImage: string | null;\n};\n\n/** Position in stage coordinates (0-2048) */\nexport type NavPosition = {\n  x: number;\n  y: number;\n};\n\n/** Size in pixels */\nexport type NavSize = {\n  width: number;\n  height: number;\n};\n\n/** NavSlot component props */\nexport type NavSlotProps = {\n  /** Position in stage coordinates (0-2048) - Adjust position: stage coordinates */\n  position: NavPosition;\n  /** Size in pixels - Adjust size: width and height in pixels */\n  size: NavSize;\n  /** Normal state image path (default: null) */\n  normalImage?: string | null;\n  /** Pressed state image path (default: null) */\n  pressedImage?: string | null;\n  /** Hover state image path (default: null, primarily for desktop) */\n  hoverImage?: string | null;\n  /** Image fit mode: \"cover\" fills container, \"contain\" fits entire image */\n  fitMode?: NavImageFitMode;\n  /** Click handler */\n  onClick?: () => void;\n  /** Optional children (used when no normalImage is provided) */\n  children?: React.ReactNode;\n  /** Optional custom className */\n  className?: string;\n  /** Optional custom style */\n  style?: CSSProperties;\n  /** Test ID for testing */\n  testId?: string;\n};\n\n/** NavScreenLayout component props */\nexport type NavScreenLayoutProps = {\n  /** Background image path (optional) */\n  backgroundImage?: string | null;\n  /** Background fit mode */\n  backgroundFitMode?: NavImageFitMode;\n  /** Children slots */\n  children?: React.ReactNode;\n  /** Optional custom className */\n  className?: string;\n  /** Optional custom style */\n  style?: CSSProperties;\n};\n\n/** Gesture options for hold-tap system */\nexport type NavGestureOptions = {\n  /** Minimum hold duration (ms) for detection. Default 450 ms. */\n  holdMs?: number;\n  /** Movement tolerance while holding (px). Default 8 px. */\n  moveTolerancePx?: number;\n};\n\n// ===================================================================\n// GESTURE SYSTEM FOR TOUCH INTERACTIONS\n// Hold-tap gesture handling optimized for mobile/Android\n// ===================================================================\n\ntype _PressState = {\n  active: boolean;\n  id: number | null;\n  startX: number;\n  startY: number;\n  startedAt: number;\n  timer: number | null;\n  consumed: boolean;\n};\n\n/**\n * Hook for managing press/hover states on NavSlot\n * Returns handlers for pointer events and current state\n */\nexport function useNavSlotState() {\n  const [isPressed, setIsPressed] = React.useState(false);\n  const [isHovering, setIsHovering] = React.useState(false);\n\n  const handlePointerDown = React.useCallback(() => {\n    setIsPressed(true);\n  }, []);\n\n  const handlePointerUp = React.useCallback(() => {\n    setIsPressed(false);\n  }, []);\n\n  const handlePointerLeave = React.useCallback(() => {\n    setIsPressed(false);\n    setIsHovering(false);\n  }, []);\n\n  const handleMouseEnter = React.useCallback(() => {\n    setIsHovering(true);\n  }, []);\n\n  const handleMouseLeave = React.useCallback(() => {\n    setIsHovering(false);\n  }, []);\n\n  return {\n    isPressed,\n    isHovering,\n    handlers: {\n      onPointerDown: handlePointerDown,\n      onPointerUp: handlePointerUp,\n      onPointerLeave: handlePointerLeave,\n      onMouseEnter: handleMouseEnter,\n      onMouseLeave: handleMouseLeave,\n    },\n  };\n}\n\n// ===================================================================\n// NAV SLOT COMPONENT\n// Main building block for NavScreen - supports images or default styling\n// ===================================================================\n\n/**\n * NavSlot - Universal slot/placeholder component\n *\n * Displays images based on state (normal/pressed/hover) or falls back to\n * default button styling when no images are provided.\n *\n * @example\n * ```tsx\n * <NavSlot\n *   position={{ x: 1024, y: 200 }}  // Adjust position: center-top area\n *   size={{ width: 300, height: 80 }}  // Adjust size: button dimensions\n *   normalImage={ImageRegistry.menuButton}\n *   pressedImage={ImageRegistry.menuButtonPressed}\n *   hoverImage={null}  // No hover for mobile\n *   fitMode=\"cover\"\n *   onClick={handleClick}\n * />\n * ```\n */\nexport const NavSlot = React.memo<NavSlotProps>(function NavSlot(props) {\n  const {\n    position,\n    size,\n    normalImage = null,\n    pressedImage = null,\n    hoverImage = null,\n    fitMode = \"cover\",\n    onClick,\n    children,\n    className = \"\",\n    style = {},\n    testId,\n  } = props;\n\n  const { isPressed, isHovering, handlers } = useNavSlotState();\n\n  // Determine which image to display based on state\n  const currentImage = React.useMemo(() => {\n    // Priority: pressed > hover > normal\n    if (isPressed && pressedImage) return pressedImage;\n    if (isHovering && hoverImage) return hoverImage;\n    return normalImage;\n  }, [isPressed, isHovering, pressedImage, hoverImage, normalImage]);\n\n  // Base positioning styles\n  const positionStyle: CSSProperties = {\n    position: \"absolute\",\n    left: `${position.x}px`,\n    top: `${position.y}px`,\n    width: `${size.width}px`,\n    height: `${size.height}px`,\n    transform: \"translate(-50%, -50%)\", // Center the element on the position point\n  };\n\n  // Image display logic\n  const hasImage = currentImage !== null;\n\n  // Default button styling (when no image)\n  const defaultButtonStyle: CSSProperties = hasImage\n    ? {}\n    : {\n        backgroundColor: \"rgba(30, 30, 30, 0.9)\",\n        border: \"2px solid rgba(255, 255, 255, 0.1)\",\n        borderRadius: \"12px\",\n        padding: \"8px 16px\",\n        color: \"white\",\n        fontSize: \"14px\",\n        fontWeight: \"500\",\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        boxShadow: \"0 4px 12px rgba(0, 0, 0, 0.3)\",\n        transition: \"all 0.15s ease\",\n        cursor: \"pointer\",\n      };\n\n  // Press effect for default button\n  const pressEffectStyle: CSSProperties =\n    !hasImage && isPressed\n      ? {\n          transform: \"translate(-50%, -50%) scale(0.95)\",\n          opacity: 0.8,\n        }\n      : {};\n\n  // Image container styles\n  const imageStyle: CSSProperties = hasImage\n    ? {\n        width: \"100%\",\n        height: \"100%\",\n        objectFit: fitMode,\n        pointerEvents: \"none\",\n        userSelect: \"none\",\n      }\n    : {};\n\n  const combinedStyle: CSSProperties = {\n    ...positionStyle,\n    ...defaultButtonStyle,\n    ...pressEffectStyle,\n    ...style,\n  };\n\n  return (\n    <div\n      className={`nav-slot ${className}`}\n      style={combinedStyle}\n      onClick={onClick}\n      data-testid={testId}\n      {...handlers}\n    >\n      {hasImage ? (\n        <img src={currentImage} alt=\"\" style={imageStyle} draggable={false} />\n      ) : (\n        children || \"Button\"\n      )}\n    </div>\n  );\n});\n\n// ===================================================================\n// NAV SCREEN LAYOUT COMPONENT\n// Container that manages stage scaling and slot positioning\n// ===================================================================\n\n/**\n * NavScreenLayout - Main layout container for NavScreen system\n *\n * Provides a 2048×2048 stage coordinate system that scales to fit viewport.\n *\n * CRITICAL: Uses \"contain\" behavior - entire stage always fits within viewport.\n * This ensures ALL interactive elements (NavSlot buttons) are always visible\n * and accessible. Background images can use \"cover\" for visual overflow effect.\n *\n * Place NavSlot components inside with stage coordinates.\n *\n * @example\n * ```tsx\n * <NavScreenLayout backgroundImage=\"/path/to/bg.png\" backgroundFitMode=\"cover\">\n *   <NavSlot position={{ x: 1024, y: 1024 }} size={{ width: 200, height: 60 }} />\n * </NavScreenLayout>\n * ```\n */\nexport function NavScreenLayout(props: NavScreenLayoutProps) {\n  const {\n    backgroundImage = null,\n    backgroundFitMode = \"cover\",\n    children,\n    className = \"\",\n    style = {},\n  } = props;\n\n  const containerRef = React.useRef<HTMLDivElement>(null);\n  const [scale, setScale] = React.useState(1);\n  const [offset, setOffset] = React.useState({ x: 0, y: 0 });\n\n  // Calculate responsive scaling\n  React.useEffect(() => {\n    const updateTransform = () => {\n      const viewportWidth = window.innerWidth;\n      const viewportHeight = window.innerHeight;\n\n      // Contain behavior: fit entire stage within viewport (all buttons always visible)\n      const scaleX = viewportWidth / NAV_STAGE_WIDTH;\n      const scaleY = viewportHeight / NAV_STAGE_HEIGHT;\n      const newScale = Math.min(scaleX, scaleY); // Use min for contain behavior\n\n      const width = NAV_STAGE_WIDTH * newScale;\n      const height = NAV_STAGE_HEIGHT * newScale;\n\n      setScale(newScale);\n      setOffset({\n        x: (viewportWidth - width) / 2,\n        y: (viewportHeight - height) / 2,\n      });\n    };\n\n    updateTransform();\n    window.addEventListener(\"resize\", updateTransform);\n    return () => window.removeEventListener(\"resize\", updateTransform);\n  }, []);\n\n  const containerStyle: CSSProperties = {\n    position: \"absolute\",\n    left: 0,\n    top: 0,\n    width: `${NAV_STAGE_WIDTH}px`,\n    height: `${NAV_STAGE_HEIGHT}px`,\n    transformOrigin: \"top left\",\n    transform: `translate(${offset.x}px, ${offset.y}px) scale(${scale})`,\n    overflow: \"hidden\",\n    ...style,\n  };\n\n  const backgroundStyle: CSSProperties = backgroundImage\n    ? {\n        position: \"absolute\",\n        inset: 0,\n        width: \"100%\",\n        height: \"100%\",\n        objectFit: backgroundFitMode,\n        pointerEvents: \"none\",\n        userSelect: \"none\",\n      }\n    : {};\n\n  return (\n    <div ref={containerRef} className={`nav-screen-layout ${className}`} style={containerStyle}>\n      {backgroundImage && (\n        <img src={backgroundImage} alt=\"\" style={backgroundStyle} draggable={false} />\n      )}\n      {children}\n    </div>\n  );\n}\n\n// ===================================================================\n// UTILITY FUNCTIONS\n// Helper functions for working with NavScreen coordinates\n// ===================================================================\n\n/**\n * Convert viewport coordinates to stage coordinates\n */\nexport function viewportToNavStageCoords(\n  viewportX: number,\n  viewportY: number,\n  scale: number,\n  offset: { x: number; y: number },\n): NavPosition {\n  return {\n    x: (viewportX - offset.x) / scale,\n    y: (viewportY - offset.y) / scale,\n  };\n}\n\n/**\n * Convert stage coordinates to viewport coordinates\n */\nexport function navStageToViewportCoords(\n  stageX: number,\n  stageY: number,\n  scale: number,\n  offset: { x: number; y: number },\n): { x: number; y: number } {\n  return {\n    x: stageX * scale + offset.x,\n    y: stageY * scale + offset.y,\n  };\n}\n\n/**\n * Check if a point is within a NavSlot bounds\n */\nexport function isPointInNavSlot(\n  point: NavPosition,\n  slotPosition: NavPosition,\n  slotSize: NavSize,\n): boolean {\n  const left = slotPosition.x - slotSize.width / 2;\n  const top = slotPosition.y - slotSize.height / 2;\n  const right = left + slotSize.width;\n  const bottom = top + slotSize.height;\n\n  return point.x >= left && point.x <= right && point.y >= top && point.y <= bottom;\n}\n\n// All types and components are already exported inline above\n// No need for additional exports\n","path":null,"size_bytes":12697,"size_tokens":null},"shared/component/drawer_drawer-top-5.tsx":{"content":"\"use client\";\n\nimport { Command } from \"lucide-react\";\n\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Drawer, DrawerContent, DrawerTrigger } from \"@/components/ui/drawer\";\nimport { Input } from \"@/components/ui/input\";\n\nexport const title = \"Top Drawer Command Bar\";\n\nconst Example = () => (\n  <Drawer direction=\"top\">\n    <DrawerTrigger asChild>\n      <Button variant=\"outline\">\n        <Command className=\"mr-2 h-4 w-4\" />\n        Command Bar\n      </Button>\n    </DrawerTrigger>\n    <DrawerContent>\n      <div className=\"space-y-4 p-4\">\n        <div className=\"relative\">\n          <Command className=\"-translate-y-1/2 absolute top-1/2 left-3 h-5 w-5 text-muted-foreground\" />\n          <Input\n            className=\"h-12 pl-10 text-base\"\n            placeholder=\"Type a command or search...\"\n          />\n        </div>\n        <div className=\"space-y-1\">\n          <Button className=\"w-full justify-between\" size=\"sm\" variant=\"ghost\">\n            <span className=\"flex items-center gap-3\">\n              <span className=\"text-sm\">Create new project</span>\n            </span>\n            <Badge variant=\"secondary\">⌘N</Badge>\n          </Button>\n          <Button className=\"w-full justify-between\" size=\"sm\" variant=\"ghost\">\n            <span className=\"flex items-center gap-3\">\n              <span className=\"text-sm\">Open file</span>\n            </span>\n            <Badge variant=\"secondary\">⌘O</Badge>\n          </Button>\n          <Button className=\"w-full justify-between\" size=\"sm\" variant=\"ghost\">\n            <span className=\"flex items-center gap-3\">\n              <span className=\"text-sm\">Search everywhere</span>\n            </span>\n            <Badge variant=\"secondary\">⌘K</Badge>\n          </Button>\n          <Button className=\"w-full justify-between\" size=\"sm\" variant=\"ghost\">\n            <span className=\"flex items-center gap-3\">\n              <span className=\"text-sm\">Settings</span>\n            </span>\n            <Badge variant=\"secondary\">⌘,</Badge>\n          </Button>\n        </div>\n      </div>\n    </DrawerContent>\n  </Drawer>\n);\n\nexport default Example;\n","path":null,"size_bytes":2160,"size_tokens":null},"shared/component/dropdown-menu_dropdown-menu-actions-5.tsx":{"content":"\"use client\";\n\nimport {\n  Download,\n  Filter,\n  Plus,\n  RefreshCw,\n  Search,\n  Upload,\n  Zap,\n} from \"lucide-react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuGroup,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nexport const title = \"Quick Actions Menu\";\n\nconst Example = () => (\n  <DropdownMenu>\n    <DropdownMenuTrigger asChild>\n      <Button>\n        <Zap className=\"h-4 w-4\" />\n        Quick Actions\n      </Button>\n    </DropdownMenuTrigger>\n    <DropdownMenuContent className=\"w-56\">\n      <DropdownMenuLabel>Quick Actions</DropdownMenuLabel>\n      <DropdownMenuSeparator />\n      <DropdownMenuGroup>\n        <DropdownMenuItem>\n          <Plus />\n          Create New\n          <DropdownMenuShortcut>⌘N</DropdownMenuShortcut>\n        </DropdownMenuItem>\n        <DropdownMenuItem>\n          <Search />\n          Search\n          <DropdownMenuShortcut>⌘K</DropdownMenuShortcut>\n        </DropdownMenuItem>\n        <DropdownMenuItem>\n          <Filter />\n          Filter\n          <DropdownMenuShortcut>⌘F</DropdownMenuShortcut>\n        </DropdownMenuItem>\n      </DropdownMenuGroup>\n      <DropdownMenuSeparator />\n      <DropdownMenuLabel>Import/Export</DropdownMenuLabel>\n      <DropdownMenuGroup>\n        <DropdownMenuItem>\n          <Upload />\n          Import\n          <DropdownMenuShortcut>⌘I</DropdownMenuShortcut>\n        </DropdownMenuItem>\n        <DropdownMenuItem>\n          <Download />\n          Export\n          <DropdownMenuShortcut>⌘E</DropdownMenuShortcut>\n        </DropdownMenuItem>\n      </DropdownMenuGroup>\n      <DropdownMenuSeparator />\n      <DropdownMenuItem>\n        <RefreshCw />\n        Refresh\n        <DropdownMenuShortcut>⌘R</DropdownMenuShortcut>\n      </DropdownMenuItem>\n    </DropdownMenuContent>\n  </DropdownMenu>\n);\n\nexport default Example;\n","path":null,"size_bytes":1977,"size_tokens":null},"yuzha/src/timestamp/TimestampHeader.tsx":{"content":"import React, { forwardRef } from \"react\";\nimport { requireAssetUrl } from \"@shared/asset/assetResolver\";\n\nconst lobbyBack = requireAssetUrl(\"lobby_cust_44\");\nconst diplo = requireAssetUrl(\"diplo1\");\nconst diplo2 = requireAssetUrl(\"diplo2\");\nconst btnUndo = requireAssetUrl(\"btnUndo\");\nconst btnRedo = requireAssetUrl(\"btnRedo\");\n\nexport type TimestampHeaderProps = {\n  onBack?: () => void;\n  hInput: string;\n  wInput: string;\n  onHInputChange: (value: string) => void;\n  onWInputChange: (value: string) => void;\n  onHInputBlur: () => void;\n  onWInputBlur: () => void;\n  onHIncrement: () => void;\n  onHDecrement: () => void;\n  onWIncrement: () => void;\n  onWDecrement: () => void;\n  onOpen?: () => void;\n  onSave?: () => void;\n  onSettings?: () => void;\n  onUndo?: () => void;\n  onRedo?: () => void;\n  canUndo?: boolean;\n  canRedo?: boolean;\n};\n\nconst TimestampHeader = forwardRef<HTMLDivElement, TimestampHeaderProps>(\n  (\n    {\n      onBack,\n      hInput,\n      wInput,\n      onHInputChange,\n      onWInputChange,\n      onHInputBlur,\n      onWInputBlur,\n      onHIncrement,\n      onHDecrement,\n      onWIncrement,\n      onWDecrement,\n      onOpen,\n      onSettings,\n      onSave,\n      onUndo,\n      onRedo,\n      canUndo = false,\n      canRedo = false,\n    },\n    ref\n  ) => {\n    return (\n      <div\n        ref={ref}\n        className=\"flex flex-wrap items-center justify-between gap-2 px-4 py-3 bg-slate-900\"\n      >\n        <div className=\"flex flex-wrap items-center gap-2\">\n          {onBack && (\n            <button\n              type=\"button\"\n              onClick={onBack}\n              className=\"flex h-10 px-4 items-center justify-center rounded-md bg-slate-800/80 hover:bg-slate-700/80 active:scale-[0.98] transition-transform text-sm font-semibold\"\n              style={{\n                backgroundImage: `url(${lobbyBack})`,\n                backgroundSize: \"contain\",\n                backgroundRepeat: \"no-repeat\",\n                backgroundPosition: \"center\",\n                color: \"#fff\",\n                fontFamily: \"Taimingda, sans-serif\",\n              }}\n            >\n              Back\n            </button>\n          )}\n          {onUndo && (\n            <button\n              type=\"button\"\n              onClick={onUndo}\n              disabled={!canUndo}\n              className=\"flex h-10 px-4 items-center justify-center rounded-md bg-slate-800/80 hover:bg-slate-700/80 active:scale-[0.98] transition-transform text-sm font-semibold disabled:opacity-40 disabled:cursor-not-allowed\"\n              style={{\n                backgroundImage: `url(${lobbyBack})`,\n                backgroundSize: \"contain\",\n                backgroundRepeat: \"no-repeat\",\n                backgroundPosition: \"center\",\n                color: \"#fff\",\n                fontFamily: \"Taimingda, sans-serif\",\n              }}\n              title=\"Undo\"\n              aria-label=\"Undo\"\n            >\n              Undo\n            </button>\n          )}\n          {onRedo && (\n            <button\n              type=\"button\"\n              onClick={onRedo}\n              disabled={!canRedo}\n              className=\"flex h-10 px-4 items-center justify-center rounded-md bg-slate-800/80 hover:bg-slate-700/80 active:scale-[0.98] transition-transform text-sm font-semibold disabled:opacity-40 disabled:cursor-not-allowed\"\n              style={{\n                backgroundImage: `url(${lobbyBack})`,\n                backgroundSize: \"contain\",\n                backgroundRepeat: \"no-repeat\",\n                backgroundPosition: \"center\",\n                color: \"#fff\",\n                fontFamily: \"Taimingda, sans-serif\",\n              }}\n              title=\"Redo\"\n              aria-label=\"Redo\"\n            >\n              Redo\n            </button>\n          )}\n          <div className=\"flex flex-wrap items-center gap-2 text-xs text-slate-300\">\n            <div className=\"flex items-center gap-1 group/h\">\n              <div\n                className=\"flex h-10 w-10 items-center justify-center rounded-md bg-slate-800/60 text-white font-semibold text-sm\"\n                style={{\n                  backgroundImage: `url(${diplo})`,\n                  backgroundSize: \"contain\",\n                  backgroundRepeat: \"no-repeat\",\n                  backgroundPosition: \"center\",\n                  fontFamily: \"Taimingda, sans-serif\",\n                }}\n              >\n                H\n              </div>\n              <div\n                className=\"flex h-10 w-10 items-center justify-center rounded-md bg-slate-800/60 text-white font-semibold text-sm\"\n                style={{\n                  backgroundImage: `url(${diplo2})`,\n                  backgroundSize: \"contain\",\n                  backgroundRepeat: \"no-repeat\",\n                  backgroundPosition: \"center\",\n                }}\n              >\n                <input\n                  type=\"text\"\n                  inputMode=\"numeric\"\n                  aria-label=\"Input H\"\n                  className=\"w-full bg-transparent text-center font-semibold text-white outline-none placeholder:text-white/70 border-none focus:ring-0\"\n                  style={{ fontFamily: \"Taimingda, sans-serif\" }}\n                  value={hInput}\n                  onChange={(e) =>\n                    onHInputChange(e.target.value.replace(/[^0-9]/g, \"\"))\n                  }\n                  onBlur={onHInputBlur}\n                />\n              </div>\n              <div className=\"flex flex-col opacity-0 group-hover/h:opacity-100 group-focus-within/h:opacity-100 transition-opacity\">\n                <button\n                  type=\"button\"\n                  onClick={onHIncrement}\n                  className=\"flex h-5 w-5 items-center justify-center bg-slate-700/80 hover:bg-slate-600 text-white text-xs rounded-sm\"\n                >\n                  ƒ-ı\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={onHDecrement}\n                  className=\"flex h-5 w-5 items-center justify-center bg-slate-700/80 hover:bg-slate-600 text-white text-xs rounded-sm\"\n                >\n                  ƒ-¬\n                </button>\n              </div>\n            </div>\n            <div className=\"flex items-center gap-1 group/w\">\n              <div\n                className=\"flex h-10 w-10 items-center justify-center rounded-md bg-slate-800/60 text-white font-semibold text-sm\"\n                style={{\n                  backgroundImage: `url(${diplo})`,\n                  backgroundSize: \"contain\",\n                  backgroundRepeat: \"no-repeat\",\n                  backgroundPosition: \"center\",\n                  fontFamily: \"Taimingda, sans-serif\",\n                }}\n              >\n                W\n              </div>\n              <div\n                className=\"flex h-10 w-10 items-center justify-center rounded-md bg-slate-800/60 text-white font-semibold text-sm\"\n                style={{\n                  backgroundImage: `url(${diplo2})`,\n                  backgroundSize: \"contain\",\n                  backgroundRepeat: \"no-repeat\",\n                  backgroundPosition: \"center\",\n                }}\n              >\n                <input\n                  type=\"text\"\n                  inputMode=\"numeric\"\n                  aria-label=\"Input W\"\n                  className=\"w-full bg-transparent text-center font-semibold text-white outline-none placeholder:text-white/70 border-none focus:ring-0\"\n                  style={{ fontFamily: \"Taimingda, sans-serif\" }}\n                  value={wInput}\n                  onChange={(e) =>\n                    onWInputChange(e.target.value.replace(/[^0-9]/g, \"\"))\n                  }\n                  onBlur={onWInputBlur}\n                />\n              </div>\n              <div className=\"flex flex-col opacity-0 group-hover/w:opacity-100 group-focus-within/w:opacity-100 transition-opacity\">\n                <button\n                  type=\"button\"\n                  onClick={onWIncrement}\n                  className=\"flex h-5 w-5 items-center justify-center bg-slate-700/80 hover:bg-slate-600 text-white text-xs rounded-sm\"\n                >\n                  ƒ-ı\n                </button>\n                <button\n                  type=\"button\"\n                  onClick={onWDecrement}\n                  className=\"flex h-5 w-5 items-center justify-center bg-slate-700/80 hover:bg-slate-600 text-white text-xs rounded-sm\"\n                >\n                  ƒ-¬\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className=\"flex flex-wrap items-center gap-2\">\n          <button\n            type=\"button\"\n            onClick={onOpen}\n            className=\"flex h-10 px-4 items-center justify-center rounded-md bg-slate-800/80 hover:bg-slate-700/80 active:scale-[0.98] transition-transform text-sm font-semibold\"\n            style={{\n              backgroundImage: `url(${lobbyBack})`,\n              backgroundSize: \"contain\",\n              backgroundRepeat: \"no-repeat\",\n              backgroundPosition: \"center\",\n              color: \"#fff\",\n              fontFamily: \"Taimingda, sans-serif\",\n            }}\n          >\n            Open\n          </button>\n          {onSettings && (\n            <button\n              type=\"button\"\n              onClick={onSettings}\n              className=\"flex h-10 px-4 items-center justify-center rounded-md bg-slate-800/80 hover:bg-slate-700/80 active:scale-[0.98] transition-transform text-sm font-semibold\"\n              style={{\n                backgroundImage: `url(${lobbyBack})`,\n                backgroundSize: \"contain\",\n                backgroundRepeat: \"no-repeat\",\n                backgroundPosition: \"center\",\n                color: \"#fff\",\n                fontFamily: \"Taimingda, sans-serif\",\n              }}\n            >\n              Settings\n            </button>\n          )}\n          <button\n            type=\"button\"\n            onClick={onSave}\n            className=\"flex h-10 px-4 items-center justify-center rounded-md bg-slate-800/80 hover:bg-slate-700/80 active:scale-[0.98] transition-transform text-sm font-semibold\"\n            style={{\n              backgroundImage: `url(${lobbyBack})`,\n              backgroundSize: \"contain\",\n              backgroundRepeat: \"no-repeat\",\n              backgroundPosition: \"center\",\n              color: \"#fff\",\n              fontFamily: \"Taimingda, sans-serif\",\n            }}\n          >\n            Save\n          </button>\n        </div>\n      </div>\n    );\n  }\n);\n\nTimestampHeader.displayName = \"TimestampHeader\";\n\nexport default TimestampHeader;\n","path":null,"size_bytes":10601,"size_tokens":null},"meng/src/icons.tsx":{"content":"import type { SVGProps } from 'react'\n\ntype IconProps = SVGProps<SVGSVGElement> & { size?: number }\n\nconst baseProps = {\n  fill: 'none',\n  stroke: 'currentColor',\n  strokeWidth: 2,\n  strokeLinecap: 'round' as const,\n  strokeLinejoin: 'round' as const,\n}\n\nconst createIcon =\n  (paths: JSX.Element[], size = 24) =>\n  (props: IconProps) => {\n    const { size: customSize, ...rest } = props\n    const finalSize = customSize ?? size\n    return (\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        width={finalSize}\n        height={finalSize}\n        viewBox=\"0 0 24 24\"\n        {...baseProps}\n        {...rest}\n      >\n        {paths}\n      </svg>\n    )\n  }\n\nexport const IconMenu = createIcon([\n  <path key=\"1\" d=\"M4 7h16\" />,\n  <path key=\"2\" d=\"M4 12h16\" />,\n  <path key=\"3\" d=\"M4 17h16\" />,\n])\n\nexport const IconX = createIcon([<path key=\"1\" d=\"m6 6 12 12\" />, <path key=\"2\" d=\"m6 18 12-12\" />])\n\nexport const IconPhone = createIcon([\n  <path\n    key=\"1\"\n    d=\"M22 16.92v3a2 2 0 0 1-2.18 2 19.8 19.8 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.8 19.8 0 0 1 2.12 4.1 2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.6 12.6 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.6 12.6 0 0 0 2.81.7A2 2 0 0 1 22 16.92Z\"\n  />,\n])\n\nexport const IconMapPin = createIcon([\n  <path key=\"1\" d=\"M12 21s-6-4.35-6-10a6 6 0 1 1 12 0c0 5.65-6 10-6 10Z\" />,\n  <circle key=\"2\" cx=\"12\" cy=\"11\" r=\"2.5\" />,\n])\n\nexport const IconClock = createIcon([\n  <circle key=\"1\" cx=\"12\" cy=\"12\" r=\"9\" />,\n  <path key=\"2\" d=\"M12 7v5l3 2\" />,\n])\n\nexport const IconMountain = createIcon([<path key=\"1\" d=\"m8 3 4 8 5-5 5 13H0L8 3Z\" />])\n\nexport const IconWaves = createIcon([\n  <path key=\"1\" d=\"M2 12c2 1.5 4 1.5 6 0s4-1.5 6 0 4 1.5 6 0\" />,\n  <path key=\"2\" d=\"M2 18c2 1.5 4 1.5 6 0s4-1.5 6 0 4 1.5 6 0\" />,\n  <path key=\"3\" d=\"M2 6c2 1.5 4 1.5 6 0s4-1.5 6 0 4 1.5 6 0\" />,\n])\n","path":null,"size_bytes":1874,"size_tokens":null},"shared/component/drawer_drawer-right-4.tsx":{"content":"\"use client\";\n\nimport { ShoppingCart, Trash2 } from \"lucide-react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Drawer,\n  DrawerClose,\n  DrawerContent,\n  DrawerDescription,\n  DrawerFooter,\n  DrawerHeader,\n  DrawerTitle,\n  DrawerTrigger,\n} from \"@/components/ui/drawer\";\n\nexport const title = \"Right Drawer Shopping Cart\";\n\nconst Example = () => (\n  <Drawer direction=\"right\">\n    <DrawerTrigger asChild>\n      <Button variant=\"outline\">\n        <ShoppingCart className=\"mr-2 h-4 w-4\" />\n        Cart (3)\n      </Button>\n    </DrawerTrigger>\n    <DrawerContent>\n      <DrawerHeader>\n        <DrawerTitle>Shopping Cart</DrawerTitle>\n        <DrawerDescription>3 items in your cart</DrawerDescription>\n      </DrawerHeader>\n      <div className=\"flex-1 space-y-4 overflow-y-auto p-4\">\n        <div className=\"space-y-4\">\n          <div className=\"flex gap-4 border-b pb-4\">\n            <div className=\"h-20 w-20 rounded-md bg-muted\" />\n            <div className=\"flex-1 space-y-1\">\n              <h4 className=\"font-medium text-sm\">Wireless Headphones</h4>\n              <p className=\"text-muted-foreground text-xs\">Black, Standard</p>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"font-medium text-sm\">$99.00</span>\n                <Button className=\"h-6 w-6\" size=\"icon\" variant=\"ghost\">\n                  <Trash2 className=\"h-3 w-3\" />\n                </Button>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex gap-4 border-b pb-4\">\n            <div className=\"h-20 w-20 rounded-md bg-muted\" />\n            <div className=\"flex-1 space-y-1\">\n              <h4 className=\"font-medium text-sm\">USB-C Cable</h4>\n              <p className=\"text-muted-foreground text-xs\">White, 2m</p>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"font-medium text-sm\">$19.00</span>\n                <Button className=\"h-6 w-6\" size=\"icon\" variant=\"ghost\">\n                  <Trash2 className=\"h-3 w-3\" />\n                </Button>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex gap-4 border-b pb-4\">\n            <div className=\"h-20 w-20 rounded-md bg-muted\" />\n            <div className=\"flex-1 space-y-1\">\n              <h4 className=\"font-medium text-sm\">Phone Case</h4>\n              <p className=\"text-muted-foreground text-xs\">Clear, Slim</p>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"font-medium text-sm\">$29.00</span>\n                <Button className=\"h-6 w-6\" size=\"icon\" variant=\"ghost\">\n                  <Trash2 className=\"h-3 w-3\" />\n                </Button>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className=\"space-y-2 pt-4\">\n          <div className=\"flex justify-between text-sm\">\n            <span className=\"text-muted-foreground\">Subtotal</span>\n            <span>$147.00</span>\n          </div>\n          <div className=\"flex justify-between text-sm\">\n            <span className=\"text-muted-foreground\">Shipping</span>\n            <span>$10.00</span>\n          </div>\n          <div className=\"flex justify-between border-t pt-2 font-medium\">\n            <span>Total</span>\n            <span>$157.00</span>\n          </div>\n        </div>\n      </div>\n      <DrawerFooter>\n        <Button>Checkout</Button>\n        <DrawerClose asChild>\n          <Button variant=\"outline\">Continue Shopping</Button>\n        </DrawerClose>\n      </DrawerFooter>\n    </DrawerContent>\n  </Drawer>\n);\n\nexport default Example;\n","path":null,"size_bytes":3616,"size_tokens":null},"shared/component/combobox_combobox-custom-actions-2.tsx":{"content":"\"use client\";\n\nimport { Check, ChevronsUpDown, Settings } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n  CommandSeparator,\n} from \"@/components/ui/command\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\n\nexport const title = \"With Footer Actions\";\n\nconst workspaces = [\n  { value: \"personal\", label: \"Personal Workspace\" },\n  { value: \"team\", label: \"Team Workspace\" },\n  { value: \"company\", label: \"Company Workspace\" },\n];\n\nconst Example = () => {\n  const [open, setOpen] = useState(false);\n  const [value, setValue] = useState(\"personal\");\n\n  return (\n    <Popover onOpenChange={setOpen} open={open}>\n      <PopoverTrigger asChild>\n        <Button\n          aria-expanded={open}\n          className=\"w-[250px] justify-between\"\n          role=\"combobox\"\n          variant=\"outline\"\n        >\n          {value\n            ? workspaces.find((workspace) => workspace.value === value)?.label\n            : \"Select workspace...\"}\n          <ChevronsUpDown className=\"ml-2 size-4 shrink-0 opacity-50\" />\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-[250px] p-0\">\n        <Command>\n          <CommandInput placeholder=\"Search workspaces...\" />\n          <CommandList>\n            <CommandEmpty>No workspace found.</CommandEmpty>\n            <CommandGroup>\n              {workspaces.map((workspace) => (\n                <CommandItem\n                  key={workspace.value}\n                  onSelect={(currentValue) => {\n                    setValue(currentValue === value ? \"\" : currentValue);\n                    setOpen(false);\n                  }}\n                  value={workspace.value}\n                >\n                  <Check\n                    className={cn(\n                      \"mr-2 size-4\",\n                      value === workspace.value ? \"opacity-100\" : \"opacity-0\"\n                    )}\n                  />\n                  {workspace.label}\n                </CommandItem>\n              ))}\n            </CommandGroup>\n          </CommandList>\n          <CommandSeparator />\n          <div className=\"p-1\">\n            <Button\n              className=\"w-full justify-start text-xs\"\n              onClick={() => {\n                alert(\"Opening workspace settings\");\n                setOpen(false);\n              }}\n              variant=\"ghost\"\n            >\n              <Settings className=\"mr-2 size-3\" />\n              Manage Workspaces\n            </Button>\n          </div>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":2760,"size_tokens":null},"shared/asset/assetResolver.ts":{"content":"import { resolveAssetPath, resolveAssetUrl } from \"@shared/layer\";\n\n/**\n * Resolve an image ID from ImageRegistry.json to a bundler-safe URL.\n * Uses the registry for lookup and the static asset manifest from resolveAssetUrl.\n */\nexport function getAssetUrl(imageId: string): string | null {\n  const assetPath = resolveAssetPath(imageId);\n  if (!assetPath) return null;\n  return resolveAssetUrl(assetPath);\n}\n\nexport function requireAssetUrl(imageId: string): string {\n  const url = getAssetUrl(imageId);\n  if (!url) {\n    throw new Error(`Asset not found in registry: ${imageId}`);\n  }\n  return url;\n}\n","path":null,"size_bytes":603,"size_tokens":null},"meng/vite.config.ts":{"content":"import { defineConfig } from 'vite'\nimport react from '@vitejs/plugin-react'\nimport path from 'node:path'\nimport { fileURLToPath } from 'node:url'\n\nconst resolveFromConfig = (relativePath: string) =>\n  path.resolve(path.dirname(fileURLToPath(import.meta.url)), relativePath)\n\nconst DEFAULT_PORT = 3001\nconst PORT = Number(process.env.PORT) || DEFAULT_PORT\n\nexport default defineConfig({\n  root: resolveFromConfig('.'),\n  plugins: [\n    react({\n      jsxRuntime: 'automatic',\n    }),\n  ],\n  resolve: {\n    alias: {\n      '@': resolveFromConfig('./src'),\n      '@shared': resolveFromConfig('../shared'),\n    },\n    dedupe: ['react', 'react-dom'],\n  },\n  server: {\n    host: '0.0.0.0',\n    port: PORT,\n    strictPort: true,\n    allowedHosts: true,\n    fs: {\n      allow: [resolveFromConfig('.'), resolveFromConfig('../shared')],\n    },\n    hmr: {\n      overlay: true,\n    },\n  },\n  preview: {\n    host: '0.0.0.0',\n    port: PORT,\n  },\n  build: {\n    outDir: 'dist',\n    target: 'es2020',\n    sourcemap: false,\n    cssCodeSplit: true,\n  },\n  optimizeDeps: {\n    include: ['react', 'react-dom'],\n  },\n})\n","path":null,"size_bytes":1099,"size_tokens":null},"shared/component/table_table-standard-4.tsx":{"content":"import {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\n\nexport const title = \"Striped Table\";\n\nconst transactions = [\n  {\n    id: \"TXN-001\",\n    description: \"Payment received\",\n    amount: \"$500.00\",\n    date: \"2024-01-15\",\n  },\n  {\n    id: \"TXN-002\",\n    description: \"Subscription renewal\",\n    amount: \"$29.00\",\n    date: \"2024-01-16\",\n  },\n  {\n    id: \"TXN-003\",\n    description: \"Refund processed\",\n    amount: \"-$150.00\",\n    date: \"2024-01-17\",\n  },\n  {\n    id: \"TXN-004\",\n    description: \"Product purchase\",\n    amount: \"$89.99\",\n    date: \"2024-01-18\",\n  },\n  {\n    id: \"TXN-005\",\n    description: \"Service fee\",\n    amount: \"$12.00\",\n    date: \"2024-01-19\",\n  },\n];\n\nconst Example = () => (\n  <div className=\"w-full max-w-4xl rounded-md border bg-background\">\n    <Table>\n      <TableHeader>\n        <TableRow>\n          <TableHead>ID</TableHead>\n          <TableHead>Description</TableHead>\n          <TableHead>Date</TableHead>\n          <TableHead className=\"text-right\">Amount</TableHead>\n        </TableRow>\n      </TableHeader>\n      <TableBody>\n        {transactions.map((transaction, index) => (\n          <TableRow\n            className={index % 2 === 0 ? \"bg-muted/50\" : \"\"}\n            key={transaction.id}\n          >\n            <TableCell className=\"font-medium\">{transaction.id}</TableCell>\n            <TableCell>{transaction.description}</TableCell>\n            <TableCell>{transaction.date}</TableCell>\n            <TableCell className=\"text-right\">{transaction.amount}</TableCell>\n          </TableRow>\n        ))}\n      </TableBody>\n    </Table>\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":1676,"size_tokens":null},"shared/component/checkbox_checkbox-standard-8.tsx":{"content":"import { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Vertical List Checkbox\";\n\nconst items = [\n  { id: \"javascript\", label: \"JavaScript\" },\n  { id: \"typescript\", label: \"TypeScript\" },\n  { id: \"python\", label: \"Python\" },\n  { id: \"java\", label: \"Java\" },\n  { id: \"csharp\", label: \"C#\" },\n];\n\nconst Example = () => (\n  <div className=\"space-y-3\">\n    {items.map((item) => (\n      <div className=\"flex items-center space-x-2\" key={item.id}>\n        <Checkbox id={item.id} />\n        <Label htmlFor={item.id}>{item.label}</Label>\n      </div>\n    ))}\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":655,"size_tokens":null},"yuzha/src/timestamp/PresetManager.ts":{"content":"import type { TextAlign, TimestampPresetV2, TimestampPresetV3, Overlay } from \"./types\";\n\nexport type TimestampPresetV1 = {\n  id: string;\n  name: string;\n  createdAt: number;\n  timeText: string;\n  dateText: string;\n  locationText: string;\n  fontFamily: string;\n  fontSize: number;\n  textColor: string;\n  shadowColor: string;\n  shadowBlur: number;\n  shadowOffsetX: number;\n  shadowOffsetY: number;\n  textAlign: TextAlign;\n  scale: number;\n  translateX: number;\n  translateY: number;\n  timePosition: { x: number; y: number };\n  datePosition: { x: number; y: number };\n  locationPosition: { x: number; y: number };\n};\n\nexport type TimestampPreset = TimestampPresetV3;\n\nconst STORAGE_KEY = \"timestamp_presets\";\n\nfunction migrateV1toV2(v1: TimestampPresetV1): TimestampPresetV2 {\n  return {\n    id: v1.id,\n    name: v1.name,\n    createdAt: v1.createdAt,\n    version: 2,\n    scale: v1.scale,\n    translateX: v1.translateX,\n    translateY: v1.translateY,\n    rotation: 0,\n    textColor: v1.textColor,\n    shadowColor: v1.shadowColor,\n    shadowBlur: v1.shadowBlur,\n    shadowOffsetX: v1.shadowOffsetX,\n    shadowOffsetY: v1.shadowOffsetY,\n    customFonts: [],\n    time: {\n      text: v1.timeText,\n      fontFamily: v1.fontFamily,\n      fontSize: v1.fontSize,\n      textAlign: v1.textAlign,\n      position: v1.timePosition,\n    },\n    date: {\n      text: v1.dateText,\n      fontFamily: v1.fontFamily,\n      fontSize: v1.fontSize,\n      textAlign: v1.textAlign,\n      position: v1.datePosition,\n    },\n    location: {\n      text: v1.locationText,\n      fontFamily: v1.fontFamily,\n      fontSize: v1.fontSize,\n      textAlign: v1.textAlign,\n      position: v1.locationPosition,\n    },\n  };\n}\n\nfunction migrateV2toV3(v2: TimestampPresetV2): TimestampPresetV3 {\n  const overlays: Overlay[] = [\n    {\n      id: \"time\",\n      type: \"text\",\n      label: \"Time\",\n      text: v2.time.text,\n      fontFamily: v2.time.fontFamily,\n      fontSize: v2.time.fontSize,\n      textAlign: v2.time.textAlign,\n      position: { ...v2.time.position },\n      isPermanent: true,\n      formatType: \"time\",\n      noWrap: true,\n    },\n    {\n      id: \"date\",\n      type: \"text\",\n      label: \"Date\",\n      text: v2.date.text,\n      fontFamily: v2.date.fontFamily,\n      fontSize: v2.date.fontSize,\n      textAlign: v2.date.textAlign,\n      position: { ...v2.date.position },\n      isPermanent: true,\n      formatType: \"date\",\n      noWrap: true,\n    },\n    {\n      id: \"location\",\n      type: \"text\",\n      label: \"Location\",\n      text: v2.location.text,\n      fontFamily: v2.location.fontFamily,\n      fontSize: v2.location.fontSize,\n      textAlign: v2.location.textAlign,\n      position: { ...v2.location.position },\n      isPermanent: true,\n      noWrap: false,\n    },\n  ];\n\n  return {\n    id: v2.id,\n    name: v2.name,\n    createdAt: v2.createdAt,\n    version: 3,\n    scale: v2.scale,\n    translateX: v2.translateX,\n    translateY: v2.translateY,\n    rotation: v2.rotation,\n    textColor: v2.textColor,\n    shadowColor: v2.shadowColor,\n    shadowBlur: v2.shadowBlur,\n    shadowOffsetX: v2.shadowOffsetX,\n    shadowOffsetY: v2.shadowOffsetY,\n    customFonts: [...v2.customFonts],\n    overlays,\n  };\n}\n\nfunction isV1Preset(preset: unknown): preset is TimestampPresetV1 {\n  return typeof preset === \"object\" && preset !== null && !(\"version\" in preset) && \"timeText\" in preset;\n}\n\nfunction isV2Preset(preset: unknown): preset is TimestampPresetV2 {\n  return typeof preset === \"object\" && preset !== null && \"version\" in preset && (preset as { version: number }).version === 2;\n}\n\nfunction isV3Preset(preset: unknown): preset is TimestampPresetV3 {\n  return typeof preset === \"object\" && preset !== null && \"version\" in preset && (preset as { version: number }).version === 3;\n}\n\nfunction migratePreset(preset: unknown): TimestampPresetV3 {\n  if (isV3Preset(preset)) {\n    return preset;\n  }\n  if (isV2Preset(preset)) {\n    return migrateV2toV3(preset);\n  }\n  if (isV1Preset(preset)) {\n    return migrateV2toV3(migrateV1toV2(preset));\n  }\n  throw new Error(\"Unknown preset format\");\n}\n\nexport function loadPresets(): TimestampPreset[] {\n  try {\n    const data = localStorage.getItem(STORAGE_KEY);\n    if (!data) return [];\n    const parsed = JSON.parse(data) as unknown[];\n    return parsed.map((p) => migratePreset(p));\n  } catch {\n    return [];\n  }\n}\n\nexport function savePresets(presets: TimestampPreset[]): void {\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(presets));\n  } catch {\n  }\n}\n\nexport type PresetInputV3 = {\n  name: string;\n  scale: number;\n  translateX: number;\n  translateY: number;\n  rotation: number;\n  textColor: string;\n  shadowColor: string;\n  shadowBlur: number;\n  shadowOffsetX: number;\n  shadowOffsetY: number;\n  customFonts: string[];\n  overlays: Overlay[];\n};\n\nexport function addPreset(input: PresetInputV3): TimestampPreset {\n  const presets = loadPresets();\n  const newPreset: TimestampPreset = {\n    ...input,\n    id: `preset_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n    createdAt: Date.now(),\n    version: 3,\n    overlays: input.overlays.map((o) => ({ ...o, position: { ...o.position } })),\n  };\n  presets.push(newPreset);\n  savePresets(presets);\n  return newPreset;\n}\n\nexport function deletePreset(id: string): void {\n  const presets = loadPresets();\n  const filtered = presets.filter((p) => p.id !== id);\n  savePresets(filtered);\n}\n\nexport function getPresetById(id: string): TimestampPreset | undefined {\n  const presets = loadPresets();\n  return presets.find((p) => p.id === id);\n}\n","path":null,"size_bytes":5520,"size_tokens":null},"shared/layer/index.ts":{"content":"/**\n * ============================================================================\n * LAYER MODULE - Barrel Export\n * ============================================================================\n *\n * PURPOSE FOR FUTURE AI AGENTS:\n * ------------------------------\n * This is the SINGLE ENTRY POINT for all layer system functionality.\n * Import from this file instead of individual modules to maintain clean\n * dependency boundaries and make refactoring easier.\n *\n * ARCHITECTURE AFTER REFACTORING (2025):\n * ---------------------------------------\n * The layer system is now organized into THREE focused modules:\n *\n * 1. model.ts - Types, interfaces, and configuration\n *    - All type definitions (Point2D, LayerConfig, etc.)\n *    - Configuration loading (loadLayerConfig)\n *    - Clock/time types and constants\n *    - NO runtime code, NO dependencies (except JSON imports)\n *\n * 2. math.ts - Pure calculation functions\n *    - Coordinate transformations (image ↔ stage, pixel ↔ percent)\n *    - Angle calculations and normalizations\n *    - Time/clock calculations\n *    - Validation and sanitization\n *    - Imports only types from model.ts\n *    - ALL functions are pure (no side effects)\n *\n * 3. engine.ts - Runtime execution and processing\n *    - Asset loading and resolution\n *    - Image mapping computation\n *    - Layer preparation (prepareLayer, etc.)\n *    - Motion processor building (buildLayerMotion)\n *    - Processor registry (registerProcessor, getProcessorsForEntry)\n *    - Pipeline execution (runPipeline, processBatch)\n *    - Animation utilities\n *    - Performance utilities (caching, batching)\n *    - Imports types from model.ts, functions from math.ts\n *\n * OLD STRUCTURE (DELETED):\n * -------------------------\n * - layerBasic.ts → math.ts (coordinate transformations)\n * - layerCore.ts → engine.ts (asset loading, layer preparation)\n * - layerMotion.ts → engine.ts (motion processing)\n * - layer.ts → engine.ts (processor registry, pipeline)\n *\n * HOW TO USE THIS MODULE:\n * -----------------------\n * ```typescript\n * // Import everything you need from the barrel export\n * import {\n *   // Types from model.ts\n *   Point2D,\n *   LayerConfig,\n *   UniversalLayerData,\n *\n *   // Config loading from model.ts\n *   loadLayerConfig,\n *\n *   // Math functions from math.ts\n *   imagePointToStagePoint,\n *   normalizeAngle,\n *\n *   // Runtime functions from engine.ts\n *   prepareLayer,\n *   buildLayerMotion,\n *   runPipeline,\n * } from \"@shared/layer\";\n * ```\n *\n * DEPENDENCY FLOW:\n * ----------------\n * model.ts ← math.ts ← engine.ts ← index.ts (this file) ← consumers\n *   ↑          ↑          ↑\n *   |          |          |\n * types    functions   runtime\n *\n * @module layer/index\n */\n\n// ============================================================================\n// MODEL EXPORTS - Types, Interfaces, and Configuration\n// ============================================================================\n\nexport type {\n  // Geometric primitives\n  Point2D,\n  PercentPoint,\n  CoordinateBundle,\n  DualSpaceCoordinate,\n  OrbitCoordinate,\n  Layer2DTransform,\n\n  // Layer data types\n  ImageMapping,\n  LayerCalculationPoints,\n  UniversalLayerData,\n  BaseLayerState,\n  SpinPreparationState,\n  OrbitPreparationState,\n\n  // Configuration types\n  LayerRenderer,\n  LayerConfigEntry,\n  LayerConfig,\n\n  // Clock/Time types\n  RotationDirection,\n  ClockSpeedAlias,\n  TimeFormat,\n  DirectionSign,\n  ClockSpeedValue,\n  ClockSpeedSetting,\n  ClockMotionConfig,\n  ResolvedClockSpeed,\n\n  // Processor & motion types\n  LayerProcessor,\n  ProcessorContext,\n  EnhancedLayerData,\n  LayerMotionMarker,\n  LayerMotionArtifacts,\n} from \"./model\";\n\nexport {\n  // Configuration loading\n  loadLayerConfig,\n  validateLayerConfig,\n\n  // Clock constants\n  CLOCK_DEFAULTS,\n  CLOCK_SPEED_ALIASES,\n} from \"./model\";\n\n// ============================================================================\n// MATH EXPORTS - Pure Calculation Functions\n// ============================================================================\n\nexport {\n  // Coordinate transformations\n  imagePointToStagePoint,\n  stagePointToImagePoint,\n  imagePointToPercent,\n  imagePercentToImagePoint,\n  stagePointToPercent,\n  stagePercentToStagePoint,\n  getImageCenter,\n\n  // Pivot-based positioning\n  calculatePositionForPivot,\n\n  // Coordinate bundles\n  createCoordinateBundle,\n  createDualSpaceCoordinate,\n\n  // Validation & sanitization\n  validatePoint,\n  validateScale,\n  validateDimensions,\n\n  // Normalization utilities\n  normalizePercent,\n  normalizePair,\n  normalizePercentInput,\n  normalizeStagePointInput,\n  clampedPercentToScale,\n\n  // Angle & rotation math\n  AnimationConstants,\n  degreesToRadians,\n  radiansToDegrees,\n  normalizeAngle,\n  applyRotationDirection,\n  calculateAngleToPoint,\n  calculateOrbitPosition,\n  calculateOrbitalVisibility,\n  isPointInBounds,\n\n  // Clock/time functions\n  toDirectionSign,\n  parseTimezoneOffset,\n  resolveTimezoneOffset,\n  resolveClockSpeed,\n  calculateRotationDegrees,\n\n  // Easing utilities\n  easeInOutQuad,\n  easeOutElastic,\n  easeOutBounce,\n} from \"./math\";\n\n// ============================================================================\n// ENGINE EXPORTS - Runtime Execution & Processing\n// ============================================================================\n\nexport type {\n  // Performance types\n  LayerBatch,\n} from \"./engine\";\n\nexport {\n  // Asset loading\n  resolveAssetPath,\n  resolveAssetUrl,\n  preloadCriticalAssets,\n  loadImage,\n\n  // Image mapping\n  computeImageMapping,\n\n  // Layer preparation\n  prepareBasicState,\n  prepareSpinState,\n  prepareOrbitState,\n  prepareLayer,\n  is2DLayer,\n  compute2DTransform,\n\n  // Processor registry\n  registerProcessor,\n  unregisterProcessor,\n  clearProcessors,\n  listRegisteredProcessors,\n  resolveProcessorsForEntry,\n  getProcessorsForEntry,\n\n  // Pipeline execution\n  runPipeline,\n  processBatch,\n\n  // Animation utilities\n  calculateElapsedTime,\n\n  // Performance utilities\n  PipelineCache,\n  createPipelineCache,\n  StaticLayerBuffer,\n  batchLayersByAnimation,\n} from \"./engine\";\n\n// ============================================================================\n// MOTION EXPORTS - Motion builder utilities\n// ============================================================================\n\nexport { buildLayerMotion } from \"./motion\";\n\n// ============================================================================\n// STAGE SYSTEM & RENDERERS\n// ============================================================================\n// These remain in separate files for size/complexity reasons but are\n// re-exported here for convenience\n\nexport * from \"./StageSystem\";\nexport { default as StageCanvas } from \"./StageCanvas\";\nexport { default as StageThree } from \"./StageThree\";\n","path":null,"size_bytes":6771,"size_tokens":null},"shared/component/carousel_carousel-standard-1.tsx":{"content":"import { faker } from \"@faker-js/faker\";\n\nimport {\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselNext,\n  CarouselPrevious,\n} from \"@/components/ui/carousel\";\n\nexport const title = \"Standard Carousel\";\n\nconst slides = Array.from({ length: 5 }, (_, index) => ({\n  id: index + 1,\n  image: faker.image.urlPicsumPhotos({ width: 800, height: 400 }),\n}));\n\nconst Example = () => (\n  <div className=\"mx-auto w-full max-w-xl\">\n    <Carousel>\n      <CarouselContent>\n        {slides.map((slide) => (\n          <CarouselItem key={slide.id}>\n            <div className=\"flex aspect-video w-full items-center justify-center rounded-md border bg-background\">\n              <span className=\"font-semibold text-4xl\">{slide.id}</span>\n            </div>\n          </CarouselItem>\n        ))}\n      </CarouselContent>\n      <CarouselPrevious />\n      <CarouselNext />\n    </Carousel>\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":914,"size_tokens":null},"shared/component/tooltip_tooltip-content-4.tsx":{"content":"\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\n\nexport const title = \"Tooltip with Image\";\n\nconst Example = () => (\n  <Tooltip>\n    <TooltipTrigger asChild>\n      <Button variant=\"outline\">Preview</Button>\n    </TooltipTrigger>\n    <TooltipContent className=\"max-w-xs p-0\">\n      <div className=\"flex flex-col gap-1 p-3\">\n        {/** biome-ignore lint/performance/noImgElement: \"Kibo UI is framework agnostic\" */}\n        <img\n          alt=\"Preview\"\n          className=\"mb-1 h-[150px] w-[257px] rounded-md\"\n          height={300}\n          src=\"https://placehold.co/514x300\"\n          width={514}\n        />\n        <p className=\"font-semibold\">Product Preview</p>\n        <p className=\"text-xs\">\n          View the full product details and specifications\n        </p>\n      </div>\n    </TooltipContent>\n  </Tooltip>\n);\n\nexport default Example;\n","path":null,"size_bytes":955,"size_tokens":null},"postcss.config.ts":{"content":"// PostCSS minimal untuk Tailwind + Autoprefixer.\n// Toleran: kalau plugin belum terpasang, error akan jelas di terminal.\n\nexport default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n};\n","path":null,"size_bytes":204,"size_tokens":null},"meng/src/components/Contact.tsx":{"content":"/**\n * Contact Component\n *\n * Purpose: Contact information and WhatsApp button\n *\n * Features:\n * - WhatsApp contact button\n * - Operating hours\n * - Location info\n * - Call-to-action for reservations\n *\n * For Future AI Agents:\n * - WhatsApp number: 0811-1658-033 (from original website)\n * - Opens WhatsApp with pre-filled message\n * - Update contact info as needed\n * - Add Google Maps embed for location\n */\n\nimport { IconPhone, IconMapPin, IconClock } from '../icons'\nimport contactData from '../contact.json'\nimport type { ContactContent } from '../types'\n\nconst Contact = () => {\n  const content = contactData as ContactContent\n  const whatsappNumber = content.whatsapp.number // Format: country code + number without +\n  const whatsappMessage = encodeURIComponent(content.whatsapp.message)\n\n  return (\n    <section id=\"contact\" className=\"py-20 bg-gradient-to-b from-primary-50 to-white\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        {/* Section Header */}\n        <div className=\"text-center mb-16\">\n          <h2 className=\"text-4xl md:text-5xl font-display font-bold text-gray-900 mb-4\">\n            {content.heading}\n          </h2>\n          <p className=\"text-xl text-gray-600\">{content.subheading}</p>\n        </div>\n\n        {/* Contact Info Cards */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 mb-12\">\n          {/* Phone */}\n          <div className=\"bg-white rounded-xl shadow-md p-8 text-center\">\n            <div className=\"inline-flex items-center justify-center w-16 h-16 bg-primary-100 rounded-full mb-4\">\n              <IconPhone className=\"w-8 h-8 text-primary-600\" />\n            </div>\n            <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n              {content.cards.phone.title}\n            </h3>\n            <p className=\"text-gray-600\">{content.cards.phone.value}</p>\n          </div>\n\n          {/* Location */}\n          <div className=\"bg-white rounded-xl shadow-md p-8 text-center\">\n            <div className=\"inline-flex items-center justify-center w-16 h-16 bg-primary-100 rounded-full mb-4\">\n              <IconMapPin className=\"w-8 h-8 text-primary-600\" />\n            </div>\n            <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n              {content.cards.location.title}\n            </h3>\n            {content.cards.location.lines.map((line) => (\n              <p key={line} className=\"text-gray-600\">\n                {line}\n              </p>\n            ))}\n          </div>\n\n          {/* Hours */}\n          <div className=\"bg-white rounded-xl shadow-md p-8 text-center\">\n            <div className=\"inline-flex items-center justify-center w-16 h-16 bg-primary-100 rounded-full mb-4\">\n              <IconClock className=\"w-8 h-8 text-primary-600\" />\n            </div>\n            <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n              {content.cards.hours.title}\n            </h3>\n            <p className=\"text-gray-600\">{content.cards.hours.days}</p>\n            <p className=\"text-gray-600 text-sm\">{content.cards.hours.hours}</p>\n          </div>\n        </div>\n\n        {/* WhatsApp CTA */}\n        <div className=\"text-center\">\n          <p className=\"text-lg text-gray-700 mb-6\">{content.ctaNote}</p>\n          <a\n            href={`https://wa.me/${whatsappNumber}?text=${whatsappMessage}`}\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"inline-flex items-center space-x-2 bg-green-600 hover:bg-green-700 text-white font-semibold px-8 py-4 rounded-full text-lg transition-all duration-300 transform hover:scale-105 shadow-lg\"\n          >\n            <IconPhone className=\"w-6 h-6\" />\n            <span>{content.whatsapp.label}</span>\n          </a>\n        </div>\n      </div>\n    </section>\n  )\n}\n\nexport default Contact\n","path":null,"size_bytes":3817,"size_tokens":null},"shared/layer/StageCanvas.tsx":{"content":"/**\n * ============================================================================\n * STAGE CANVAS RENDERER\n * ============================================================================\n *\n * This is a COMPLETE SELF-CONTAINED RENDERER that uses HTML Canvas 2D API\n * to render the stage. It's one of two rendering engines:\n * - StageCanvas.tsx (this file) - Uses Canvas 2D API\n * - StageThree.tsx - Uses Three.js WebGL\n *\n * ARCHITECTURE FOR FUTURE AI AGENTS:\n * -----------------------------------\n * 1. React component mounts and calls createStagePipeline() from StageSystem\n * 2. Pipeline contains all prepared layers with positions, scales, processors\n * 3. mountCanvasRenderer() sets up the stage transformer (auto-scaling)\n * 4. mountCanvasLayers() loads images and renders to canvas every frame\n * 5. Animation loop runs processors and redraws canvas each frame\n *\n * WHY CANVAS RENDERER:\n * - Better performance than DOM for many layers\n * - Full pixel control (custom effects, filters)\n * - Consistent rendering across browsers\n * - Fallback for AI agents (no WebGL needed)\n *\n * WHEN TO USE:\n * - Many layers (>50)\n * - Custom visual effects needed\n * - WebGL not available or has issues\n * - Consistent pixel-perfect rendering required\n *\n * @module StageCanvas\n */\n\nimport React, { useEffect, useRef } from \"react\";\nimport {\n  createStagePipeline,\n  toRendererInput,\n  createStageTransformer,\n  roundStagePoint,\n  type StagePipeline,\n  type StageMarker,\n  type LayerBounds,\n  type LayerMetadata,\n  type EnhancedLayerData,\n  type LayerProcessor,\n  computeLayerBounds,\n  isLayerWithinStageBounds,\n} from \"./StageSystem\";\nimport { loadImage, runPipeline, createPipelineCache } from \"./engine\";\nimport { getImageCenter, AnimationConstants } from \"./math\";\n\nconst IS_DEV = Boolean((import.meta as ImportMeta & { env?: { DEV?: boolean } }).env?.DEV);\n\n// ============================================================================\n// CANVAS LAYER RENDERING ENGINE\n// ============================================================================\n// This section contains the actual Canvas 2D rendering logic. It loads images\n// and draws them to a canvas using the 2D context API.\n// ============================================================================\n\n/**\n * Pre-calculated transform values for efficient canvas rendering.\n * These values are computed once per layer and reused every frame.\n */\ntype CanvasTransformCache = {\n  /** Image width after scaling */\n  scaledWidth: number;\n  /** Image height after scaling */\n  scaledHeight: number;\n  /** X position of image center after scaling */\n  centerX: number;\n  /** Y position of image center after scaling */\n  centerY: number;\n  /** X position of pivot point after scaling */\n  pivotX: number;\n  /** Y position of pivot point after scaling */\n  pivotY: number;\n  /** Horizontal offset from center to pivot */\n  dx: number;\n  /** Vertical offset from center to pivot */\n  dy: number;\n  /** Whether this layer has rotation */\n  hasRotation: boolean;\n};\n\nconst transformCachePool: CanvasTransformCache[] = [];\nconst STATIC_CULL_PADDING = 4;\nconst DYNAMIC_CULL_PADDING = 48;\nconst acquireTransformCache = (): CanvasTransformCache =>\n  transformCachePool.pop() ?? {\n    scaledWidth: 0,\n    scaledHeight: 0,\n    centerX: 0,\n    centerY: 0,\n    pivotX: 0,\n    pivotY: 0,\n    dx: 0,\n    dy: 0,\n    hasRotation: false,\n  };\n\nconst releaseTransformCache = (cache: CanvasTransformCache): void => {\n  transformCachePool.push(cache);\n};\n\ntype PreparedMarker =\n  | {\n      marker: StageMarker;\n      motion?: undefined;\n    }\n  | {\n      marker: StageMarker;\n      motion: {\n        angularVelocityDegPerMs: number;\n        initialAngleDeg: number;\n        centerX: number;\n        centerY: number;\n        radius: number;\n      };\n    };\n\n/**\n * Internal representation of a Canvas layer.\n * Contains the image and data needed for rendering.\n */\ntype CanvasLayerEntry = {\n  /** Loaded image to draw */\n  image: HTMLImageElement;\n  /** Base layer data (unchanging) */\n  baseData: EnhancedLayerData;\n  /** Processors that animate this layer */\n  processors: LayerProcessor[];\n  /** Pre-calculated transform values for performance */\n  transformCache: CanvasTransformCache;\n  /** Whether this layer has no animation */\n  isStatic: boolean;\n  /** Whether this layer has animation */\n  hasAnimation: boolean;\n  /** Precomputed bounds for the base layer state */\n  baseBounds: LayerBounds;\n};\n\n/**\n * Mounts Canvas layers and sets up rendering loop.\n *\n * RENDERING PROCESS:\n * 1. Load all images\n * 2. Pre-calculate transform caches for performance\n * 3. If animated: start requestAnimationFrame loop\n *    - Clear canvas\n *    - Run processors for each layer\n *    - Draw updated layers\n *    - Render debug visualizations if enabled\n * 4. If static: render once and return\n *\n * PERFORMANCE OPTIMIZATIONS:\n * - Transform cache prevents repeated calculations\n * - Pipeline cache prevents re-running processors\n * - Sub-pixel precision preserved for smooth orbital animations\n * - Static layers rendered once, never updated\n *\n * CANVAS DRAWING TECHNIQUE:\n * - save() → translate to layer position → rotate if needed → drawImage → restore()\n * - Rotation happens around pivot point (not center) for proper spin behavior\n *\n * @param ctx - Canvas 2D rendering context\n * @param layersWithProcessors - Prepared layers from pipeline\n * @returns Cleanup function to stop animation\n */\nasync function mountCanvasLayers(\n  ctx: CanvasRenderingContext2D,\n  layersWithProcessors: Array<{\n    data: EnhancedLayerData;\n    processors: LayerProcessor[];\n    metadata: LayerMetadata;\n  }>,\n  markers: StageMarker[] = [],\n  stageSize: number,\n): Promise<() => void> {\n  const layers: CanvasLayerEntry[] = [];\n\n  // Load images and setup transform caches\n  for (const item of layersWithProcessors) {\n    try {\n      const { data, processors, metadata } = item;\n      const image = await loadImage(data.imageUrl);\n      const { isStatic, hasAnimation, baseBounds, visibleByDefault } = metadata;\n\n      // Pre-calculate transform values for performance\n      const transformCache = acquireTransformCache();\n      transformCache.scaledWidth = image.width * data.scale.x;\n      transformCache.scaledHeight = image.height * data.scale.y;\n      transformCache.centerX = (image.width / 2) * data.scale.x;\n      transformCache.centerY = (image.height / 2) * data.scale.y;\n      const pivot = getImageCenter(data.imageMapping);\n      transformCache.pivotX = pivot.x * data.scale.x;\n      transformCache.pivotY = pivot.y * data.scale.y;\n      transformCache.dx = transformCache.centerX - transformCache.pivotX;\n      transformCache.dy = transformCache.centerY - transformCache.pivotY;\n      transformCache.hasRotation = (data.rotation ?? 0) !== 0;\n\n      if (isStatic && visibleByDefault && !isLayerWithinStageBounds(baseBounds, stageSize)) {\n        releaseTransformCache(transformCache);\n        if (IS_DEV) {\n          console.info(`[StageCanvas] Skipping offscreen static layer \"${data.LayerID}\"`);\n        }\n        continue;\n      }\n\n      layers.push({\n        image,\n        baseData: data,\n        processors,\n        transformCache,\n        isStatic,\n        hasAnimation,\n        baseBounds,\n      });\n    } catch (error) {\n      if (IS_DEV) {\n        console.error(`[StageCanvas] Failed to load image for \"${item.data.ImageID}\"`, error);\n      }\n    }\n  }\n\n  const preparedMarkers: PreparedMarker[] = markers.map((marker) => {\n    if (marker.motion?.type === \"orbit\") {\n      const directionSign = marker.motion.direction === \"ccw\" ? 1 : -1;\n      const angularVelocityDegPerMs =\n        (marker.motion.rotationsPerHour * 360 * directionSign) / 3600000;\n      return {\n        marker,\n        motion: {\n          angularVelocityDegPerMs,\n          initialAngleDeg: marker.motion.initialAngleDeg,\n          centerX: marker.motion.centerX,\n          centerY: marker.motion.centerY,\n          radius: marker.motion.radius,\n        },\n      };\n    }\n    return { marker };\n  });\n\n  const hasMarkerAnimation = preparedMarkers.some((entry) => entry.motion !== undefined);\n  const hasAnyAnimation = layers.some((layer) => layer.hasAnimation) || hasMarkerAnimation;\n\n  let markerStartTime: number | undefined;\n\n  const renderMarkers = (timestamp?: number) => {\n    if (preparedMarkers.length === 0) return;\n    const elapsedMs =\n      timestamp !== undefined\n        ? (() => {\n            if (markerStartTime === undefined) {\n              markerStartTime = timestamp;\n              return 0;\n            }\n            return timestamp - markerStartTime;\n          })()\n        : 0;\n    ctx.save();\n    for (const entry of preparedMarkers) {\n      const marker = entry.marker;\n      let drawX = marker.x;\n      let drawY = marker.y;\n\n      if (entry.motion) {\n        const angleDeg =\n          entry.motion.initialAngleDeg + elapsedMs * entry.motion.angularVelocityDegPerMs;\n        const angleRad = (angleDeg * Math.PI) / 180;\n        drawX = entry.motion.centerX + entry.motion.radius * Math.cos(angleRad);\n        drawY = entry.motion.centerY - entry.motion.radius * Math.sin(angleRad);\n      }\n\n      if (marker.kind === \"circle\") {\n        const radius = marker.radius ?? 0;\n        if (radius <= 0) continue;\n        ctx.beginPath();\n        ctx.arc(drawX, drawY, radius, 0, Math.PI * 2);\n        ctx.lineWidth = marker.lineWidth ?? 1;\n        ctx.strokeStyle = marker.color ?? \"rgba(255, 255, 255, 0.9)\";\n        ctx.stroke();\n        continue;\n      }\n\n      const radius = marker.radius ?? 6;\n      ctx.beginPath();\n      ctx.arc(drawX, drawY, radius, 0, Math.PI * 2);\n      ctx.fillStyle = marker.color ?? \"rgba(255, 255, 255, 0.9)\";\n      ctx.fill();\n      ctx.lineWidth = 1;\n      ctx.strokeStyle = \"rgba(0, 0, 0, 0.6)\";\n      ctx.stroke();\n    }\n    ctx.restore();\n  };\n\n  const pipelineCache = createPipelineCache<EnhancedLayerData>();\n  const releaseCaches = (): void => {\n    for (const layer of layers) {\n      releaseTransformCache(layer.transformCache);\n    }\n    layers.length = 0;\n  };\n\n  const computeRuntimeBounds = (data: EnhancedLayerData): LayerBounds =>\n    computeLayerBounds(data.position, data.scale, data.imageMapping);\n\n  const shouldRenderLayer = (layer: CanvasLayerEntry, enhancedData: EnhancedLayerData): boolean => {\n    if (enhancedData.visible === false) return false;\n    const padding = layer.hasAnimation ? DYNAMIC_CULL_PADDING : STATIC_CULL_PADDING;\n    return isLayerWithinStageBounds(computeRuntimeBounds(enhancedData), stageSize, padding);\n  };\n\n  /**\n   * Renders a single layer to the canvas.\n   * Handles positioning, rotation, and scaling.\n   */\n  const renderLayer = (layer: CanvasLayerEntry, enhancedData: EnhancedLayerData) => {\n    if (!shouldRenderLayer(layer, enhancedData)) return;\n\n    const { transformCache } = layer;\n    const rotation =\n      enhancedData.currentRotation ?? enhancedData.rotation ?? layer.baseData.rotation ?? 0;\n\n    ctx.save();\n    // Preserve spin/orbit sub-pixel precision to avoid wobble when pivot isn't centered\n    const position =\n      enhancedData.hasOrbitalAnimation || enhancedData.hasSpinAnimation\n        ? enhancedData.position\n        : roundStagePoint(enhancedData.position);\n    ctx.translate(position.x, position.y);\n    const alpha = enhancedData.opacity ?? 1;\n    ctx.globalAlpha = alpha;\n\n    // Apply rotation around pivot point\n    if (rotation !== 0) {\n      ctx.translate(-transformCache.dx, -transformCache.dy);\n      ctx.rotate(rotation * AnimationConstants.DEG_TO_RAD);\n      ctx.translate(transformCache.dx, transformCache.dy);\n    }\n\n    // Draw the image\n    ctx.drawImage(\n      layer.image,\n      -transformCache.centerX,\n      -transformCache.centerY,\n      transformCache.scaledWidth,\n      transformCache.scaledHeight,\n    );\n    ctx.restore();\n  };\n\n  /**\n   * Main render loop for animated layers.\n   * Clears canvas, updates all layers, renders composited pixels.\n   */\n  const renderFrame = (timestamp: number) => {\n    ctx.clearRect(0, 0, stageSize, stageSize);\n    // Render all layers\n    for (const layer of layers) {\n      const enhancedData =\n        layer.hasAnimation && layer.processors.length > 0\n          ? pipelineCache.get(layer.baseData.LayerID, () =>\n              runPipeline(layer.baseData, layer.processors, timestamp),\n            )\n          : layer.baseData;\n\n      renderLayer(layer, enhancedData);\n    }\n\n    renderMarkers(timestamp);\n\n    pipelineCache.nextFrame();\n    requestAnimationFrame(renderFrame);\n  };\n\n  // If any layers are animated, start the render loop\n  if (hasAnyAnimation) {\n    requestAnimationFrame(renderFrame);\n    return () => {\n      pipelineCache.clear();\n      releaseCaches();\n    };\n  }\n\n  // For static scenes, render once\n  ctx.clearRect(0, 0, stageSize, stageSize);\n  const renderStaticLayer = (layer: CanvasLayerEntry) => {\n    const enhancedData =\n      layer.processors.length > 0 ? runPipeline(layer.baseData, layer.processors) : layer.baseData;\n    renderLayer(layer, enhancedData);\n    return enhancedData;\n  };\n\n  for (const layer of layers) {\n    renderStaticLayer(layer);\n  }\n\n  renderMarkers();\n\n  return () => {\n    releaseCaches();\n  };\n}\n\n// ============================================================================\n// CANVAS RENDERER COMPONENT\n// ============================================================================\n// React component that orchestrates the Canvas rendering pipeline\n// ============================================================================\n\n/**\n * Mounts the complete Canvas renderer with auto-scaling transformer.\n *\n * WHAT IT DOES:\n * 1. Gets 2D context from canvas element\n * 2. Sets canvas size to STAGE_SIZE (2048x2048)\n * 3. Sets up the stage transformer (handles viewport resize/scaling)\n * 4. Mounts the canvas layers (loads images, starts rendering)\n * 5. Returns cleanup function\n *\n * @param container - Container element for the stage\n * @param canvas - Canvas element (will be 2048x2048, then scaled)\n * @param pipeline - Complete prepared pipeline from StageSystem\n * @returns Cleanup function\n */\nasync function mountCanvasRenderer(\n  container: HTMLDivElement,\n  canvas: HTMLCanvasElement,\n  pipeline: StagePipeline,\n): Promise<() => void> {\n  const context = canvas.getContext(\"2d\");\n  if (!context) {\n    throw new Error(\"[StageCanvas] Failed to acquire 2D context\");\n  }\n\n  // Set canvas to stage size\n  canvas.width = pipeline.stageSize;\n  canvas.height = pipeline.stageSize;\n\n  // Setup auto-scaling transformer (handles window resize)\n  const cleanupTransform = createStageTransformer(canvas, container, {\n    resizeDebounce: 100,\n  });\n\n  // Mount layers and start rendering\n  const cleanupLayers = await mountCanvasLayers(\n    context,\n    toRendererInput(pipeline),\n    pipeline.markers ?? [],\n    pipeline.stageSize,\n  );\n\n  return () => {\n    cleanupTransform?.();\n    cleanupLayers?.();\n  };\n}\n\nexport type StageCanvasProps = {\n  loadPipeline?: () => Promise<StagePipeline>;\n};\n\n/**\n * StageCanvas React Component\n *\n * LIFECYCLE:\n * 1. Component mounts\n * 2. useEffect creates pipeline from StageSystem (or custom loader)\n * 3. mountCanvasRenderer sets up rendering\n * 4. Component unmounts → cleanup is called\n *\n * USAGE: Just render <StageCanvas />. Provide `loadPipeline` to override data source.\n */\nfunction StageCanvas({ loadPipeline = createStagePipeline }: StageCanvasProps) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n\n  useEffect(() => {\n    const container = containerRef.current;\n    const canvas = canvasRef.current;\n    if (!container || !canvas) return;\n\n    let cleanup: (() => void) | undefined;\n    let active = true;\n\n    (async () => {\n      // Load and prepare all layers\n      const pipeline = await loadPipeline();\n      if (!active) return;\n      // Mount renderer\n      cleanup = await mountCanvasRenderer(container, canvas, pipeline);\n    })().catch((error) => {\n      console.error(\"[StageCanvas] Failed to initialize Canvas stage\", error);\n    });\n\n    return () => {\n      active = false;\n      cleanup?.();\n    };\n  }, [loadPipeline]);\n\n  return (\n    <div ref={containerRef} className=\"absolute inset-0 z-0 pointer-events-none\">\n      <canvas ref={canvasRef} className=\"block\" />\n    </div>\n  );\n}\n\nexport default React.memo(StageCanvas);\n","path":null,"size_bytes":16334,"size_tokens":null},"shared/component/dropdown-menu_dropdown-menu-standard-3.tsx":{"content":"\"use client\";\n\nimport {\n  ClipboardPaste,\n  Copy,\n  FileText,\n  Menu,\n  Scissors,\n  Search,\n  Trash2,\n} from \"lucide-react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nexport const title = \"Dropdown with Shortcuts\";\n\nconst Example = () => (\n  <DropdownMenu>\n    <DropdownMenuTrigger asChild>\n      <Button size=\"icon\" variant=\"outline\">\n        <Menu className=\"h-4 w-4\" />\n      </Button>\n    </DropdownMenuTrigger>\n    <DropdownMenuContent className=\"w-56\">\n      <DropdownMenuItem>\n        <FileText />\n        New File\n        <DropdownMenuShortcut>⌘N</DropdownMenuShortcut>\n      </DropdownMenuItem>\n      <DropdownMenuSeparator />\n      <DropdownMenuItem>\n        <Copy />\n        Copy\n        <DropdownMenuShortcut>⌘C</DropdownMenuShortcut>\n      </DropdownMenuItem>\n      <DropdownMenuItem>\n        <Scissors />\n        Cut\n        <DropdownMenuShortcut>⌘X</DropdownMenuShortcut>\n      </DropdownMenuItem>\n      <DropdownMenuItem>\n        <ClipboardPaste />\n        Paste\n        <DropdownMenuShortcut>⌘V</DropdownMenuShortcut>\n      </DropdownMenuItem>\n      <DropdownMenuSeparator />\n      <DropdownMenuItem>\n        <Search />\n        Search\n        <DropdownMenuShortcut>⌘F</DropdownMenuShortcut>\n      </DropdownMenuItem>\n      <DropdownMenuItem variant=\"destructive\">\n        <Trash2 />\n        Delete\n        <DropdownMenuShortcut>⌘⌫</DropdownMenuShortcut>\n      </DropdownMenuItem>\n    </DropdownMenuContent>\n  </DropdownMenu>\n);\n\nexport default Example;\n","path":null,"size_bytes":1673,"size_tokens":null},"shared/component/dialog_dialog-standard-7.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\n\nexport const title = \"Feedback\";\n\nconst Example = () => (\n  <Dialog>\n    <DialogTrigger asChild>\n      <Button variant=\"outline\">Send Feedback</Button>\n    </DialogTrigger>\n    <DialogContent className=\"sm:max-w-lg\">\n      <DialogHeader>\n        <DialogTitle>Share your feedback</DialogTitle>\n        <DialogDescription>\n          We'd love to hear your thoughts on how we can improve.\n        </DialogDescription>\n      </DialogHeader>\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"feedback\">Your feedback</Label>\n        <Textarea\n          className=\"min-h-[120px]\"\n          id=\"feedback\"\n          placeholder=\"Tell us what you think...\"\n        />\n      </div>\n      <DialogFooter>\n        <Button type=\"button\" variant=\"outline\">\n          Cancel\n        </Button>\n        <Button type=\"button\">Submit Feedback</Button>\n      </DialogFooter>\n    </DialogContent>\n  </Dialog>\n);\n\nexport default Example;\n","path":null,"size_bytes":1226,"size_tokens":null},"shared/component/tabs_tabs-content-2.tsx":{"content":"import { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\n\nexport const title = \"Tabs with Cards\";\n\nconst Example = () => (\n  <Tabs className=\"w-full max-w-2xl\" defaultValue=\"featured\">\n    <TabsList>\n      <TabsTrigger value=\"featured\">Featured</TabsTrigger>\n      <TabsTrigger value=\"popular\">Popular</TabsTrigger>\n      <TabsTrigger value=\"recent\">Recent</TabsTrigger>\n    </TabsList>\n    <TabsContent value=\"featured\">\n      <div className=\"grid gap-4 md:grid-cols-2\">\n        <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n          <Badge className=\"mb-3\" variant=\"secondary\">\n            Featured\n          </Badge>\n          <h3 className=\"mb-2 font-semibold text-lg\">\n            Building Modern Web Apps\n          </h3>\n          <p className=\"mb-4 text-muted-foreground text-sm\">\n            Learn how to build modern web applications with the latest\n            technologies and best practices.\n          </p>\n          <Button size=\"sm\" variant=\"outline\">\n            Learn More\n          </Button>\n        </div>\n        <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n          <Badge className=\"mb-3\" variant=\"secondary\">\n            Featured\n          </Badge>\n          <h3 className=\"mb-2 font-semibold text-lg\">Advanced TypeScript</h3>\n          <p className=\"mb-4 text-muted-foreground text-sm\">\n            Master advanced TypeScript concepts and patterns for building robust\n            applications.\n          </p>\n          <Button size=\"sm\" variant=\"outline\">\n            Learn More\n          </Button>\n        </div>\n      </div>\n    </TabsContent>\n    <TabsContent value=\"popular\">\n      <div className=\"grid gap-4 md:grid-cols-2\">\n        <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n          <Badge className=\"mb-3\">Popular</Badge>\n          <h3 className=\"mb-2 font-semibold text-lg\">React Best Practices</h3>\n          <p className=\"mb-4 text-muted-foreground text-sm\">\n            Discover the most popular patterns and practices used by React\n            developers worldwide.\n          </p>\n          <Button size=\"sm\" variant=\"outline\">\n            Learn More\n          </Button>\n        </div>\n        <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n          <Badge className=\"mb-3\">Popular</Badge>\n          <h3 className=\"mb-2 font-semibold text-lg\">API Design Principles</h3>\n          <p className=\"mb-4 text-muted-foreground text-sm\">\n            Learn how to design clean, maintainable, and scalable APIs that\n            developers love.\n          </p>\n          <Button size=\"sm\" variant=\"outline\">\n            Learn More\n          </Button>\n        </div>\n      </div>\n    </TabsContent>\n    <TabsContent value=\"recent\">\n      <div className=\"grid gap-4 md:grid-cols-2\">\n        <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n          <Badge className=\"mb-3\" variant=\"outline\">\n            New\n          </Badge>\n          <h3 className=\"mb-2 font-semibold text-lg\">Next.js 15 Features</h3>\n          <p className=\"mb-4 text-muted-foreground text-sm\">\n            Explore the latest features and improvements in Next.js 15 and how\n            to use them.\n          </p>\n          <Button size=\"sm\" variant=\"outline\">\n            Learn More\n          </Button>\n        </div>\n        <div className=\"rounded-lg border bg-card p-6 text-card-foreground shadow-sm\">\n          <Badge className=\"mb-3\" variant=\"outline\">\n            New\n          </Badge>\n          <h3 className=\"mb-2 font-semibold text-lg\">Tailwind CSS Updates</h3>\n          <p className=\"mb-4 text-muted-foreground text-sm\">\n            Learn about the newest additions to Tailwind CSS and how they can\n            improve your workflow.\n          </p>\n          <Button size=\"sm\" variant=\"outline\">\n            Learn More\n          </Button>\n        </div>\n      </div>\n    </TabsContent>\n  </Tabs>\n);\n\nexport default Example;\n","path":null,"size_bytes":4122,"size_tokens":null},"shared/component/input_input-standard-1.tsx":{"content":"\"use client\";\n\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Input with Label\";\n\nconst Example = () => (\n  <div className=\"w-full max-w-sm space-y-2\">\n    <Label htmlFor=\"name\">Name</Label>\n    <Input className=\"bg-background\" id=\"name\" placeholder=\"Enter your name\" />\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":378,"size_tokens":null},"shared/component/input_input-special-2.tsx":{"content":"\"use client\";\n\nimport { Clock } from \"lucide-react\";\n\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\n\nexport const title = \"Time Input\";\n\nconst Example = () => (\n  <div className=\"w-full max-w-sm space-y-2\">\n    <Label htmlFor=\"time-input\">Meeting Time</Label>\n    <div className=\"relative\">\n      <Clock className=\"-translate-y-1/2 absolute top-1/2 left-3 h-4 w-4 text-muted-foreground\" />\n      <Input className=\"bg-background pl-9\" id=\"time-input\" type=\"time\" />\n    </div>\n  </div>\n);\n\nexport default Example;\n","path":null,"size_bytes":561,"size_tokens":null},"shared/component/data-table_data-table-advanced-1.tsx":{"content":"\"use client\";\n\nimport {\n  type ColumnDef,\n  flexRender,\n  getCoreRowModel,\n  getExpandedRowModel,\n  useReactTable,\n} from \"@tanstack/react-table\";\nimport { ChevronDownIcon, ChevronRightIcon } from \"lucide-react\";\nimport * as React from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\n\nexport const title = \"Expandable Sub-Rows\";\n\ntype Project = {\n  id: string;\n  name: string;\n  status: string;\n  tasks?: Task[];\n};\n\ntype Task = {\n  id: string;\n  name: string;\n  assignee: string;\n  status: string;\n};\n\nconst data: Project[] = [\n  {\n    id: \"1\",\n    name: \"Website Redesign\",\n    status: \"In Progress\",\n    tasks: [\n      { id: \"1-1\", name: \"Design mockups\", assignee: \"John\", status: \"Done\" },\n      {\n        id: \"1-2\",\n        name: \"Frontend dev\",\n        assignee: \"Jane\",\n        status: \"In Progress\",\n      },\n      { id: \"1-3\", name: \"Review & QA\", assignee: \"Bob\", status: \"Pending\" },\n    ],\n  },\n  {\n    id: \"2\",\n    name: \"Mobile App\",\n    status: \"Planning\",\n    tasks: [\n      { id: \"2-1\", name: \"User research\", assignee: \"Alice\", status: \"Done\" },\n      {\n        id: \"2-2\",\n        name: \"Wireframes\",\n        assignee: \"Charlie\",\n        status: \"In Progress\",\n      },\n    ],\n  },\n  {\n    id: \"3\",\n    name: \"API Integration\",\n    status: \"Completed\",\n    tasks: [\n      { id: \"3-1\", name: \"API design\", assignee: \"Dave\", status: \"Done\" },\n      { id: \"3-2\", name: \"Implementation\", assignee: \"Eve\", status: \"Done\" },\n      { id: \"3-3\", name: \"Testing\", assignee: \"Frank\", status: \"Done\" },\n    ],\n  },\n];\n\nconst columns: ColumnDef<Project>[] = [\n  {\n    id: \"expander\",\n    header: () => null,\n    cell: ({ row }) => {\n      return row.original.tasks ? (\n        <Button\n          className=\"h-8 w-8 p-0\"\n          onClick={() => row.toggleExpanded()}\n          size=\"sm\"\n          variant=\"ghost\"\n        >\n          {row.getIsExpanded() ? (\n            <ChevronDownIcon className=\"size-4\" />\n          ) : (\n            <ChevronRightIcon className=\"size-4\" />\n          )}\n        </Button>\n      ) : null;\n    },\n  },\n  {\n    accessorKey: \"name\",\n    header: \"Name\",\n    cell: ({ row }) => (\n      <div className=\"font-medium\">{row.getValue(\"name\")}</div>\n    ),\n  },\n  {\n    accessorKey: \"status\",\n    header: \"Status\",\n    cell: ({ row }) => <div>{row.getValue(\"status\")}</div>,\n  },\n];\n\nconst Example = () => {\n  const table = useReactTable({\n    data,\n    columns,\n    getCoreRowModel: getCoreRowModel(),\n    getExpandedRowModel: getExpandedRowModel(),\n    getRowCanExpand: (row) => !!row.original.tasks,\n  });\n\n  return (\n    <div className=\"w-full max-w-4xl\">\n      <div className=\"rounded-md border bg-background\">\n        <Table>\n          <TableHeader>\n            {table.getHeaderGroups().map((headerGroup) => (\n              <TableRow key={headerGroup.id}>\n                {headerGroup.headers.map((header) => (\n                  <TableHead key={header.id}>\n                    {header.isPlaceholder\n                      ? null\n                      : flexRender(\n                          header.column.columnDef.header,\n                          header.getContext()\n                        )}\n                  </TableHead>\n                ))}\n              </TableRow>\n            ))}\n          </TableHeader>\n          <TableBody>\n            {table.getRowModel().rows?.length ? (\n              table.getRowModel().rows.map((row) => (\n                <React.Fragment key={row.id}>\n                  <TableRow>\n                    {row.getVisibleCells().map((cell) => (\n                      <TableCell key={cell.id}>\n                        {flexRender(\n                          cell.column.columnDef.cell,\n                          cell.getContext()\n                        )}\n                      </TableCell>\n                    ))}\n                  </TableRow>\n                  {row.getIsExpanded() && row.original.tasks && (\n                    <TableRow>\n                      <TableCell colSpan={columns.length}>\n                        <div className=\"rounded-md bg-muted/50 p-4\">\n                          <div className=\"space-y-2\">\n                            {row.original.tasks.map((task) => (\n                              <div\n                                className=\"flex items-center gap-4 text-sm\"\n                                key={task.id}\n                              >\n                                <div className=\"flex-1 font-medium\">\n                                  {task.name}\n                                </div>\n                                <div className=\"text-muted-foreground\">\n                                  {task.assignee}\n                                </div>\n                                <div>{task.status}</div>\n                              </div>\n                            ))}\n                          </div>\n                        </div>\n                      </TableCell>\n                    </TableRow>\n                  )}\n                </React.Fragment>\n              ))\n            ) : (\n              <TableRow>\n                <TableCell\n                  className=\"h-24 text-center\"\n                  colSpan={columns.length}\n                >\n                  No results.\n                </TableCell>\n              </TableRow>\n            )}\n          </TableBody>\n        </Table>\n      </div>\n    </div>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":5486,"size_tokens":null},"yuzha/src/MainScreenUtils.tsx":{"content":"/**\n * MainScreenUtils.tsx - Unified MainScreen Component System (Simplified)\n *\n * Organized into isolated blocks:\n * 🔴 CRITICAL - Core functionality (DO NOT DELETE)\n * 🟡 OPTIONAL - UI features (safe to remove)\n * 🟢 UTILITY - Helper functions (safe to remove)\n */\n\nimport React from \"react\";\nimport type { CSSProperties } from \"react\";\n\n// ===================================================================\n// 🔴 BLOCK 1: STAGE CONSTANTS\n// ===================================================================\n\n/** Stage dimensions - 2048×2048 coordinate system */\nexport const STAGE_WIDTH = 2048;\nexport const STAGE_HEIGHT = 2048;\nexport const STAGE_CENTER_X = 1024;\nexport const STAGE_CENTER_Y = 1024;\n\n/** Stage quadrants for positioning reference */\nexport const STAGE_QUADRANTS = {\n  TOP_LEFT: { x: 0, y: 0, width: 1024, height: 1024 },\n  TOP_RIGHT: { x: 1024, y: 0, width: 1024, height: 1024 },\n  BOTTOM_LEFT: { x: 0, y: 1024, width: 1024, height: 1024 },\n  BOTTOM_RIGHT: { x: 1024, y: 1024, width: 1024, height: 1024 },\n} as const;\n\n/** Common positioning zones within 2048×2048 stage */\nexport const STAGE_ZONES = {\n  CENTER: { x: 1024, y: 1024 },\n  TOP_CENTER: { x: 1024, y: 256 },\n  BOTTOM_CENTER: { x: 1024, y: 1792 },\n  LEFT_CENTER: { x: 256, y: 1024 },\n  RIGHT_CENTER: { x: 1792, y: 1024 },\n} as const;\n\n// ===================================================================\n// 🔴 BLOCK 2: TYPE DEFINITIONS\n// ===================================================================\n\nexport type MainScreenBtnGestureOptions = {\n  holdMs?: number;\n  moveTolerancePx?: number;\n};\n\nexport type MainScreenBtnGesture = {\n  open: boolean;\n  setOpen: (v: boolean) => void;\n  toggle: () => void;\n  bindTargetProps: () => React.HTMLAttributes<HTMLElement>;\n};\n\nexport type MainScreenBtnEffectKind = \"none\" | \"fade\" | \"pulse\" | \"glow\";\n\nexport type MainScreenBtnEffectConfig = {\n  kind?: MainScreenBtnEffectKind;\n};\n\nexport type MainScreenBtnEffectState = {\n  open: boolean;\n};\n\nexport type MainScreenBtnVisual = {\n  panelClass: string;\n  panelStyle?: CSSProperties;\n  buttonClass: string;\n  badgeClass: string;\n};\n\nexport type MainScreenBtnProps = {\n  open: boolean;\n  onToggle?: () => void;\n  effect?: MainScreenBtnEffectConfig;\n  title?: string;\n};\n\nexport type MainScreenRendererBadgeProps = {\n  visible: boolean;\n  label: string;\n};\n\nexport type MainScreenUpdaterProps = {\n  visible: boolean;\n  rendererMode?: \"auto\" | \"canvas\" | \"three\";\n  onRendererModeChange?: (mode: \"auto\" | \"canvas\" | \"three\") => void;\n  onOpenCounterScreen?: () => void;\n  onOpenTimestampScreen?: () => void;\n  onOpenFloatingScreen?: () => void;\n  onOpenAlphaRemoveScreen?: () => void;\n  rendererLabel?: string;\n};\n\nexport type MainScreenBtnGestureAreaProps = {\n  className?: string;\n  style?: React.CSSProperties;\n  children?: React.ReactNode;\n  options?: MainScreenBtnGestureOptions;\n  onOpenChange?: (open: boolean) => void;\n};\n\n// ===================================================================\n// 🟢 BLOCK 3: UTILITY FUNCTIONS\n// ===================================================================\n\nasync function clearCachesAndReload() {\n  // Run cleanup operations in parallel for better performance\n  await Promise.allSettled([\n    // Service worker cleanup\n    (async () => {\n      if (\"serviceWorker\" in navigator) {\n        const regs = await navigator.serviceWorker.getRegistrations();\n        await Promise.all(regs.map((r) => r.unregister()));\n      }\n    })(),\n\n    // Cache cleanup\n    (async () => {\n      if (\"caches\" in window) {\n        const keys = await caches.keys();\n        await Promise.all(keys.map((k) => caches.delete(k)));\n      }\n    })(),\n  ]);\n\n  // Force reload with cache bust, fallback to simple reload\n  try {\n    const url = new URL(window.location.href);\n    url.searchParams.set(\"_ts\", String(Date.now()));\n    window.location.replace(url.toString());\n  } catch {\n    window.location.reload();\n  }\n}\n\n// ===================================================================\n// 🔴 BLOCK 4: GESTURE SYSTEM (SIMPLIFIED)\n// ===================================================================\n\ntype PressState = {\n  active: boolean;\n  pointerId: number | null;\n  startX: number;\n  startY: number;\n  timer: number | null;\n};\n\nexport function useMainScreenBtnGesture(opts?: MainScreenBtnGestureOptions): MainScreenBtnGesture {\n  const holdMs = opts?.holdMs ?? 450;\n  const tolerance = opts?.moveTolerancePx ?? 8;\n  const toleranceSq = tolerance * tolerance;\n\n  const [open, setOpen] = React.useState(false);\n  const toggle = React.useCallback(() => setOpen((v) => !v), []);\n\n  const pressRef = React.useRef<PressState>({\n    active: false,\n    pointerId: null,\n    startX: 0,\n    startY: 0,\n    timer: null,\n  });\n\n  const clearTimer = () => {\n    if (pressRef.current.timer !== null) {\n      window.clearTimeout(pressRef.current.timer);\n      pressRef.current.timer = null;\n    }\n  };\n\n  const onPointerDown = (e: React.PointerEvent<HTMLElement>) => {\n    if (!e.isPrimary) return;\n    (e.currentTarget as HTMLElement).setPointerCapture?.(e.pointerId);\n\n    const p = pressRef.current;\n    p.active = true;\n    p.pointerId = e.pointerId;\n    p.startX = e.clientX;\n    p.startY = e.clientY;\n\n    clearTimer();\n    p.timer = window.setTimeout(() => {\n      if (p.active) {\n        toggle();\n        p.active = false;\n      }\n    }, holdMs);\n  };\n\n  const onPointerMove = (e: React.PointerEvent<HTMLElement>) => {\n    const p = pressRef.current;\n    if (!p.active || p.pointerId !== e.pointerId) return;\n\n    const dx = e.clientX - p.startX;\n    const dy = e.clientY - p.startY;\n    if (dx * dx + dy * dy > toleranceSq) {\n      p.active = false;\n      clearTimer();\n    }\n  };\n\n  const onPointerEnd = (e: React.PointerEvent<HTMLElement>) => {\n    const p = pressRef.current;\n    if (p.pointerId !== null && p.pointerId !== e.pointerId) return;\n\n    p.active = false;\n    p.pointerId = null;\n    clearTimer();\n\n    try {\n      (e.currentTarget as HTMLElement).releasePointerCapture?.(e.pointerId);\n    } catch {}\n  };\n\n  const bindTargetProps = (): React.HTMLAttributes<HTMLElement> => ({\n    onPointerDown,\n    onPointerMove,\n    onPointerUp: onPointerEnd,\n    onPointerCancel: onPointerEnd,\n  });\n\n  React.useEffect(() => clearTimer, []);\n\n  return { open, setOpen, toggle, bindTargetProps };\n}\n\n// ===================================================================\n// 🔴 BLOCK 5: EFFECT SYSTEM (SIMPLIFIED)\n// ===================================================================\n\nexport function useMainScreenBtnEffect(\n  state: MainScreenBtnEffectState,\n  cfg?: MainScreenBtnEffectConfig,\n): MainScreenBtnVisual {\n  const kind = cfg?.kind ?? \"none\";\n\n  const basePanel =\n    \"pointer-events-auto fixed bottom-4 right-4 z-[9999] \" +\n    \"bg-neutral-900/80 backdrop-blur-md border border-neutral-800 \" +\n    \"rounded-2xl shadow-lg px-3 py-2 flex items-center gap-2\";\n\n  const baseButton =\n    \"btn inline-flex items-center gap-2 px-3 py-1.5 rounded-xl \" +\n    \"bg-neutral-800 hover:bg-neutral-700 active:bg-neutral-600 \" +\n    \"text-sm leading-none\";\n\n  const baseBadge =\n    \"badge text-[10px] px-2 py-0.5 rounded bg-neutral-800/70 border border-neutral-700\";\n\n  if (kind === \"glow\") {\n    return {\n      panelClass: basePanel + \" ring-1 ring-pink-400/25\",\n      panelStyle: state.open ? { boxShadow: \"0 0 24px rgba(236,72,153,0.25)\" } : undefined,\n      buttonClass: baseButton + \" ring-1 ring-pink-400/20\",\n      badgeClass: baseBadge,\n    };\n  }\n\n  if (kind === \"pulse\") {\n    return {\n      panelClass: basePanel,\n      panelStyle: state.open ? { animation: \"pulse 1.5s ease-in-out infinite\" } : undefined,\n      buttonClass: baseButton,\n      badgeClass: baseBadge,\n    };\n  }\n\n  if (kind === \"fade\") {\n    return {\n      panelClass: basePanel,\n      panelStyle: { opacity: state.open ? 1 : 0.85, transition: \"opacity 160ms ease\" },\n      buttonClass: baseButton,\n      badgeClass: baseBadge,\n    };\n  }\n\n  return {\n    panelClass: basePanel,\n    panelStyle: undefined,\n    buttonClass: baseButton,\n    badgeClass: baseBadge,\n  };\n}\n\n// ===================================================================\n// 🟡 BLOCK 6: RENDERER BADGE COMPONENT\n// ===================================================================\n\nexport function MainScreenRendererBadge(props: MainScreenRendererBadgeProps) {\n  if (!props.visible) return null;\n  return (\n    <div\n      className=\"pointer-events-none select-none fixed top-3 right-3 z-[9998] text-[10px] px-2 py-0.5 rounded bg-black/60 border border-white/10 text-white/80\"\n      aria-live=\"polite\"\n    >\n      {props.label}\n    </div>\n  );\n}\n\n// ===================================================================\n// 🟡 BLOCK 7: UPDATER COMPONENT\n// ===================================================================\n\nexport function MainScreenUpdater(props: MainScreenUpdaterProps) {\n  const currentMode = props.rendererMode ?? \"auto\";\n\n  const getRendererButtonClass = (mode: \"auto\" | \"canvas\" | \"three\") => {\n    const baseClass = \"text-[11px] px-3 py-2 rounded text-white shadow-sm border\";\n    const isSelected = currentMode === mode;\n\n    if (!isSelected) {\n      return `${baseClass} bg-gray-600/40 border-gray-700/40 text-gray-400`;\n    }\n\n    if (mode === \"auto\") {\n      return `${baseClass} bg-blue-600/80 hover:bg-blue-500/80 active:bg-blue-600 border-white/10`;\n    } else if (mode === \"canvas\") {\n      return `${baseClass} bg-amber-600/80 hover:bg-amber-500/80 active:bg-amber-600 border-white/10`;\n    } else {\n      return `${baseClass} bg-emerald-600/80 hover:bg-emerald-500/80 active:bg-emerald-600 border-white/10`;\n    }\n  };\n\n  if (!props.visible) return null;\n\n  return (\n    <div className=\"fixed top-3 right-3 z-[9998] flex flex-col items-end gap-2\">\n      {props.rendererLabel && (\n        <div className=\"pointer-events-none select-none rounded bg-black/60 px-3 py-1 text-xs text-white/80 shadow-inner border border-white/10 whitespace-normal break-words text-right leading-tight\">\n          {props.rendererLabel}\n        </div>\n      )}\n      {props.onRendererModeChange && (\n        <div className=\"flex flex-row gap-1\">\n          <button\n            type=\"button\"\n            onClick={() => props.onRendererModeChange?.(\"auto\")}\n            className={getRendererButtonClass(\"auto\")}\n            aria-label=\"Auto renderer mode\"\n          >\n            Auto\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => props.onRendererModeChange?.(\"canvas\")}\n            className={getRendererButtonClass(\"canvas\")}\n            aria-label=\"Canvas renderer mode\"\n          >\n            Canvas\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => props.onRendererModeChange?.(\"three\")}\n            className={getRendererButtonClass(\"three\")}\n            aria-label=\"Three renderer mode\"\n          >\n            Three\n          </button>\n        </div>\n      )}\n      <div className=\"flex flex-col gap-1 self-end\">\n        <button\n          type=\"button\"\n          onClick={clearCachesAndReload}\n          className=\"text-xs px-3 py-2 rounded bg-pink-600/80 hover:bg-pink-500/80 active:bg-pink-600 text-white shadow-sm border border-white/10 text-center whitespace-normal break-words leading-tight\"\n          aria-label=\"Force update and reload\"\n        >\n          Update\n        </button>\n        {props.onOpenCounterScreen && (\n          <button\n            type=\"button\"\n            onClick={props.onOpenCounterScreen}\n            className=\"text-xs px-3 py-2 rounded bg-sky-600/80 hover:bg-sky-500/80 active:bg-sky-600 text-white shadow-sm border border-white/10 text-center whitespace-normal break-words leading-tight\"\n          >\n            Counter\n          </button>\n        )}\n        {props.onOpenTimestampScreen && (\n          <button\n            type=\"button\"\n            onClick={props.onOpenTimestampScreen}\n            className=\"text-xs px-3 py-2 rounded bg-emerald-600/80 hover:bg-emerald-500/80 active:bg-emerald-600 text-white shadow-sm border border-white/10 text-center whitespace-normal break-words leading-tight\"\n          >\n            Timestamp\n          </button>\n        )}\n        {props.onOpenFloatingScreen && (\n          <button\n            type=\"button\"\n            onClick={props.onOpenFloatingScreen}\n            className=\"text-xs px-3 py-2 rounded bg-violet-600/80 hover:bg-violet-500/80 active:bg-violet-600 text-white shadow-sm border border-white/10 text-center whitespace-normal break-words leading-tight\"\n          >\n            Floating Window\n          </button>\n        )}\n        {props.onOpenAlphaRemoveScreen && (\n          <button\n            type=\"button\"\n            onClick={props.onOpenAlphaRemoveScreen}\n            className=\"text-xs px-3 py-2 rounded bg-orange-600/80 hover:bg-orange-500/80 active:bg-orange-600 text-white shadow-sm border border-white/10 text-center whitespace-normal break-words leading-tight\"\n          >\n            Alpha Remover\n          </button>\n        )}\n      </div>\n    </div>\n  );\n}\n\n// ===================================================================\n// 🔴 BLOCK 8: BUTTON PANEL COMPONENT (SIMPLIFIED)\n// ===================================================================\n\nexport function MainScreenBtnPanel(props: MainScreenBtnProps) {\n  const { open, onToggle, title = \"Launcher\" } = props;\n\n  const vis = useMainScreenBtnEffect({ open }, props.effect);\n\n  React.useEffect(() => {\n    if (!open) return;\n    const onKey = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\") onToggle?.();\n    };\n    window.addEventListener(\"keydown\", onKey);\n    return () => window.removeEventListener(\"keydown\", onKey);\n  }, [open, onToggle]);\n\n  if (!open) return null;\n\n  return (\n    <div className={vis.panelClass} style={vis.panelStyle}>\n      <span className={vis.badgeClass}>{title}</span>\n      <div className=\"flex items-center gap-2\">\n        <button type=\"button\" className={vis.buttonClass} onClick={onToggle}>\n          Close\n        </button>\n      </div>\n    </div>\n  );\n}\n\n// ===================================================================\n// 🟡 BLOCK 9: GESTURE AREA COMPONENT\n// ===================================================================\n\nexport function MainScreenBtnGestureArea(props: MainScreenBtnGestureAreaProps) {\n  const g = useMainScreenBtnGesture(props.options);\n\n  React.useEffect(() => {\n    props.onOpenChange?.(g.open);\n  }, [g.open, props]);\n\n  return (\n    <div\n      {...g.bindTargetProps()}\n      className={props.className ?? \"absolute inset-0 pointer-events-auto\"}\n      style={props.style}\n    >\n      {typeof props.children === \"function\"\n        ? (props.children as (arg: { open: boolean; toggle: () => void }) => React.ReactNode)({\n            open: g.open,\n            toggle: g.toggle,\n          })\n        : props.children}\n    </div>\n  );\n}\n\n// ===================================================================\n// 🟡 BLOCK 10: BUTTON DOCK (SIMPLIFIED)\n// ===================================================================\n\nexport function MainScreenBtnDock(\n  props: Omit<MainScreenBtnProps, \"open\" | \"onToggle\"> & { overlayClassName?: string },\n) {\n  const gesture = useMainScreenBtnGesture();\n  return (\n    <>\n      <div\n        {...gesture.bindTargetProps()}\n        className={props.overlayClassName ?? \"absolute inset-0 pointer-events-auto\"}\n      />\n      <MainScreenBtnPanel\n        open={gesture.open}\n        onToggle={gesture.toggle}\n        effect={props.effect}\n        title={props.title}\n      />\n    </>\n  );\n}\n\n// Export utility functions\nexport { clearCachesAndReload };\n","path":null,"size_bytes":15615,"size_tokens":null},"shared/floating/Accordion.tsx":{"content":"import React, { useState, useCallback } from \"react\";\n\nexport type AccordionSection = {\n  id: string;\n  title: string;\n  content: React.ReactNode;\n  defaultOpen?: boolean;\n};\n\nexport type AccordionProps = {\n  sections: AccordionSection[];\n  allowMultiple?: boolean;\n  className?: string;\n  sectionClassName?: string;\n  headerClassName?: string;\n  bodyClassName?: string;\n  openIds?: Set<string>;\n  onToggle?: (id: string, isOpen: boolean) => void;\n  renderHeader?: (section: AccordionSection, isOpen: boolean) => React.ReactNode;\n  renderIcon?: (isOpen: boolean) => React.ReactNode;\n};\n\nconst defaultRenderIcon = (isOpen: boolean) => (\n  <svg\n    className={`w-4 h-4 transition-transform ${isOpen ? \"rotate-180\" : \"\"}`}\n    fill=\"none\"\n    stroke=\"currentColor\"\n    viewBox=\"0 0 24 24\"\n    aria-hidden=\"true\"\n  >\n    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n  </svg>\n);\n\nexport default function Accordion({\n  sections,\n  allowMultiple = true,\n  className,\n  sectionClassName,\n  headerClassName,\n  bodyClassName,\n  openIds: controlledOpenIds,\n  onToggle,\n  renderHeader,\n  renderIcon = defaultRenderIcon,\n}: AccordionProps) {\n  const [internalOpenIds, setInternalOpenIds] = useState<Set<string>>(() => {\n    const initial = new Set<string>();\n    sections.forEach((s) => {\n      if (s.defaultOpen) initial.add(s.id);\n    });\n    return initial;\n  });\n\n  const isControlled = controlledOpenIds !== undefined;\n  const openIds = isControlled ? controlledOpenIds : internalOpenIds;\n\n  const toggle = useCallback(\n    (id: string) => {\n      const isCurrentlyOpen = openIds.has(id);\n      const willBeOpen = !isCurrentlyOpen;\n\n      if (isControlled) {\n        onToggle?.(id, willBeOpen);\n      } else {\n        setInternalOpenIds((prev) => {\n          const next = new Set(prev);\n          if (next.has(id)) {\n            next.delete(id);\n          } else {\n            if (!allowMultiple) next.clear();\n            next.add(id);\n          }\n          return next;\n        });\n        onToggle?.(id, willBeOpen);\n      }\n    },\n    [openIds, isControlled, allowMultiple, onToggle]\n  );\n\n  const containerClass = className ?? \"space-y-2\";\n\n  return (\n    <div className={containerClass}>\n      {sections.map((section) => {\n        const isOpen = openIds.has(section.id);\n        const headerId = `accordion-header-${section.id}`;\n        const contentId = `accordion-content-${section.id}`;\n\n        const sectionClass =\n          sectionClassName ?? \"border border-slate-300 rounded overflow-hidden\";\n        const headerClass =\n          headerClassName ??\n          \"w-full flex items-center justify-between px-3 py-2 bg-slate-100 hover:bg-slate-200 text-slate-800 font-semibold text-sm transition-colors\";\n        const bodyClass = bodyClassName ?? \"px-3 py-3 bg-white\";\n\n        return (\n          <div key={section.id} className={sectionClass}>\n            <button\n              type=\"button\"\n              id={headerId}\n              aria-expanded={isOpen}\n              aria-controls={contentId}\n              onClick={() => toggle(section.id)}\n              className={headerClass}\n            >\n              {renderHeader ? (\n                renderHeader(section, isOpen)\n              ) : (\n                <>\n                  <span>{section.title}</span>\n                  {renderIcon(isOpen)}\n                </>\n              )}\n            </button>\n            {isOpen && (\n              <div id={contentId} role=\"region\" aria-labelledby={headerId} className={bodyClass}>\n                {section.content}\n              </div>\n            )}\n          </div>\n        );\n      })}\n    </div>\n  );\n}\n","path":null,"size_bytes":3658,"size_tokens":null},"shared/component/textarea_textarea-standard-1.tsx":{"content":"import { Textarea } from \"@/components/ui/textarea\";\n\nexport const title = \"Simple Textarea\";\n\nconst Example = () => (\n  <Textarea\n    className=\"w-full max-w-md bg-background\"\n    placeholder=\"Type your message here...\"\n  />\n);\n\nexport default Example;\n","path":null,"size_bytes":254,"size_tokens":null},"shared/layer/engine.ts":{"content":"/// <reference types=\"vite/client\" />\n\n/** LAYER ENGINE - Runtime Execution & Processing. */\n\nimport type {\n  Point2D,\n  PercentPoint,\n  Layer2DTransform,\n  ImageMapping,\n  UniversalLayerData,\n  EnhancedLayerData,\n  LayerProcessor,\n  LayerCalculationPoints,\n  BaseLayerState,\n  SpinPreparationState,\n  OrbitPreparationState,\n  LayerConfigEntry,\n  ProcessorContext,\n  ProcessorPlugin,\n} from \"./model\";\n\nimport {\n  imagePointToStagePoint,\n  imagePointToPercent,\n  imagePercentToImagePoint,\n  stagePointToPercent,\n  getImageCenter,\n  createCoordinateBundle,\n  createDualSpaceCoordinate,\n  normalizePair,\n  clampedPercentToScale,\n  normalizePercentInput,\n  normalizeStagePointInput,\n  normalizePercent,\n  calculatePositionForPivot,\n} from \"./math\";\n\nimport registryData from \"../asset/ImageRegistry.json\" assert { type: \"json\" };\n\nexport type {\n  LayerMotionMarker,\n  LayerMotionArtifacts,\n  LayerProcessor,\n  ProcessorContext,\n  EnhancedLayerData,\n} from \"./model\";\n\n// Convert imageId to file paths, URLs, and load image dimensions.\n// CRITICAL FOR PRODUCTION BUILDS:\n// We use import.meta.glob to statically import all assets. This allows Vite\n// to analyze and bundle assets at build time, preventing 404s in production.\n// Dynamic URL construction with new URL(variable, import.meta.url) breaks builds!\n\n/** Static asset manifest using import.meta.glob. */\nconst assetManifest = import.meta.glob(\"../asset/*.{png,jpg,jpeg,gif,svg,webp}\", {\n  eager: true,\n  query: \"?url\",\n  import: \"default\",\n}) as Record<string, string>;\n\ntype AssetRegistryEntry = { id: string; path: string };\nconst registry = registryData as Array<AssetRegistryEntry>;\n\n// Validate registry entries at initialization (development only)\nconst IS_DEV_VALIDATION =\n  typeof import.meta !== \"undefined\" && typeof (import.meta as any).env !== \"undefined\"\n    ? (import.meta as any).env.DEV\n    : true;\n\nif (IS_DEV_VALIDATION) {\n  registry.forEach((entry, index) => {\n    if (!entry.id || typeof entry.id !== \"string\") {\n      console.error(`[Engine] Invalid asset registry entry #${index}: missing or invalid id`);\n    }\n    if (!entry.path || typeof entry.path !== \"string\") {\n      console.error(\n        `[Engine] Invalid asset registry entry #${index} (${entry.id}): missing or invalid path`,\n      );\n    }\n  });\n}\n\nconst pathMap = new Map(registry.map((entry) => [entry.id, entry.path]));\n\n/** Resolve asset path from imageId. */\nexport function resolveAssetPath(imageId: string): string | null {\n  const path = pathMap.get(imageId);\n  if (path && typeof path === \"string\" && path.length > 0) {\n    return path;\n  }\n  return null;\n}\n\n/** Convert asset path to URL for loading. */\nexport function resolveAssetUrl(path: string): string {\n  if (!path || typeof path !== \"string\") {\n    throw new Error(`Invalid asset path: ${path}`);\n  }\n\n  // Validate path format (case-insensitive check)\n  if (!path.toLowerCase().startsWith(\"shared/asset/\")) {\n    throw new Error(`Unsupported asset path: ${path}`);\n  }\n\n  // Extract filename: \"shared/asset/file.png\" → \"file.png\"\n  const filename = path.replace(/^shared\\/asset\\//i, \"\");\n\n  // Build manifest key (relative to THIS file: shared/layer/engine.ts)\n  const manifestKey = `../asset/${filename}`;\n\n  // Look up in static asset manifest (populated by import.meta.glob)\n  const url = assetManifest[manifestKey];\n\n  if (!url) {\n    throw new Error(\n      `Asset not found in manifest: ${manifestKey} (from registry path: ${path}). ` +\n        `Available assets: ${Object.keys(assetManifest).join(\", \")}`,\n    );\n  }\n\n  return url;\n}\n\n/** Image dimension cache for performance. */\nconst IMAGE_DIMENSION_CACHE = new Map<string, { width: number; height: number }>();\n\n/** Get image dimensions (with caching). */\nasync function getImageDimensions(url: string): Promise<{ width: number; height: number }> {\n  // Return cached dimensions if available\n  if (IMAGE_DIMENSION_CACHE.has(url)) {\n    return IMAGE_DIMENSION_CACHE.get(url)!;\n  }\n\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => {\n      const dimensions = { width: img.width, height: img.height };\n      IMAGE_DIMENSION_CACHE.set(url, dimensions);\n      resolve(dimensions);\n    };\n    img.onerror = reject;\n    img.src = url;\n  });\n}\n\n/** Preload critical assets in parallel. */\nexport async function preloadCriticalAssets(imageIds: string[]): Promise<void> {\n  const preloadPromises = imageIds.map(async (imageId) => {\n    const assetPath = resolveAssetPath(imageId);\n    if (!assetPath) return;\n\n    const imageUrl = resolveAssetUrl(assetPath);\n    try {\n      await getImageDimensions(imageUrl);\n    } catch (error) {\n      console.warn(`[Engine] Failed to preload asset \"${imageId}\":`, error);\n    }\n  });\n\n  await Promise.all(preloadPromises);\n}\n\n/** Load image from URL. */\nexport async function loadImage(src: string): Promise<HTMLImageElement> {\n  return new Promise((resolve, reject) => {\n    const img = new Image();\n    img.onload = () => resolve(img);\n    img.onerror = reject;\n    img.src = src;\n  });\n}\n\n// Calculate image geometry information needed for positioning.\n\n/** Compute image mapping from dimensions. */\nexport function computeImageMapping(imageDimensions: {\n  width: number;\n  height: number;\n}): ImageMapping {\n  const { width, height } = imageDimensions;\n  return {\n    imageDimensions: { width, height },\n  };\n}\n\n// Convert configuration to renderable layer data.\n\nconst ZERO_POINT: Point2D = { x: 0, y: 0 };\nconst ZERO_PERCENT: PercentPoint = { x: 0, y: 0 };\nconst ZERO_COORDINATE_BUNDLE = createCoordinateBundle(ZERO_POINT, ZERO_PERCENT);\nconst ZERO_DUAL_COORDINATE = createDualSpaceCoordinate(\n  ZERO_POINT,\n  ZERO_PERCENT,\n  ZERO_POINT,\n  ZERO_PERCENT,\n);\n\n/** Compute 2D transform (position + scale) from configuration. */\nexport function compute2DTransform(\n  entry: LayerConfigEntry,\n  stageSize: number,\n  imageDimensions: { width: number; height: number },\n): Layer2DTransform {\n  const [sxPercent, syPercent] = normalizePair(entry.ImageScale, 100, 100);\n  const sx = clampedPercentToScale(sxPercent);\n  const sy = clampedPercentToScale(syPercent);\n\n  const defaultCenter = stageSize / 2;\n  const scale: Point2D = { x: sx, y: sy };\n\n  // Check for new BasicStagePoint/BasicImagePoint system\n  if (entry.BasicStagePoint !== undefined) {\n    // New pivot-based positioning system\n    const [stageX, stageY] = normalizePair(entry.BasicStagePoint, defaultCenter, defaultCenter);\n    const basicStagePoint: Point2D = { x: stageX, y: stageY };\n\n    // Default BasicImagePoint to [50, 50] (center) if not specified\n    const [imgPercentX, imgPercentY] = normalizePair(entry.BasicImagePoint, 50, 50);\n    const basicImagePercent: PercentPoint = {\n      x: normalizePercent(imgPercentX),\n      y: normalizePercent(imgPercentY),\n    };\n\n    // Calculate position that places BasicImagePoint at BasicStagePoint\n    const minimalMapping: ImageMapping = { imageDimensions };\n    const position = calculatePositionForPivot(\n      basicStagePoint,\n      basicImagePercent,\n      minimalMapping,\n      scale,\n      0,\n    );\n\n    return { position, scale };\n  } else {\n    // Legacy position system (backward compatibility)\n    const [px, py] = normalizePair(entry.position, defaultCenter, defaultCenter);\n    return {\n      position: { x: px, y: py },\n      scale,\n    };\n  }\n}\n\n/** Prepare the basic, renderer-agnostic layer state. */\nexport async function prepareBasicState(\n  entry: LayerConfigEntry,\n  stageSize: number,\n): Promise<BaseLayerState | null> {\n  const assetPath = resolveAssetPath(entry.ImageID);\n  if (!assetPath) {\n    console.warn(`[Engine] Missing asset for ImageID \"${entry.ImageID}\"`);\n    return null;\n  }\n\n  const imageUrl = resolveAssetUrl(assetPath);\n  const imageDimensions = await getImageDimensions(imageUrl);\n\n  const { position, scale } = compute2DTransform(entry, stageSize, imageDimensions);\n  const imageMapping = computeImageMapping(imageDimensions);\n\n  const stageCenterValue = stageSize / 2;\n  const stageCenterPoint: Point2D = { x: stageCenterValue, y: stageCenterValue };\n  const stageCenterPercent = stagePointToPercent(stageCenterPoint, stageSize);\n\n  const imageCenter = getImageCenter(imageMapping);\n  const imageCenterStage = imagePointToStagePoint(\n    imageCenter,\n    imageMapping.imageDimensions,\n    scale,\n    position,\n  );\n  const imageCenterPercent = imagePointToPercent(imageCenter, imageMapping.imageDimensions);\n  const imageCenterStagePercent = stagePointToPercent(imageCenterStage, stageSize);\n\n  const rotation = typeof entry.BasicImageAngle === \"number\" ? entry.BasicImageAngle : 0;\n  const blendMode = entry.BlendMode === \"additive\" ? \"additive\" : \"normal\";\n  const pulseSeconds =\n    typeof entry.PulseSeconds === \"number\" && entry.PulseSeconds > 0 ? entry.PulseSeconds : undefined;\n  const rawPulseAmplitude =\n    typeof entry.PulseAmplitude === \"number\" ? entry.PulseAmplitude : undefined;\n  const pulseAmplitude =\n    rawPulseAmplitude !== undefined ? Math.min(1, Math.max(0, rawPulseAmplitude)) : undefined;\n  const rawOpacity =\n    typeof entry.Opacity === \"number\"\n      ? entry.Opacity\n      : typeof (entry as any).opacity === \"number\"\n        ? (entry as any).opacity\n        : undefined;\n  const opacity =\n    rawOpacity !== undefined\n      ? Math.min(1, Math.max(0, rawOpacity))\n      : undefined;\n\n  return {\n    baseData: {\n      LayerID: entry.LayerID,\n      ImageID: entry.ImageID,\n      imageUrl,\n      imagePath: assetPath,\n      blendMode,\n      pulseSeconds,\n      pulseAmplitude,\n      opacity,\n      position,\n      scale,\n      imageMapping,\n      rotation,\n      orbitOrient: Boolean(entry.orbitOrient),\n    },\n    stageSize,\n    stageCenter: createCoordinateBundle(stageCenterPoint, stageCenterPercent),\n    imageCenter: createDualSpaceCoordinate(\n      imageCenter,\n      imageCenterPercent,\n      imageCenterStage,\n      imageCenterStagePercent,\n    ),\n  };\n}\n\n/** Prepare spin-specific coordinates and metadata. */\nexport function prepareSpinState(\n  baseState: BaseLayerState,\n  entry: LayerConfigEntry,\n): SpinPreparationState {\n  const { baseData, stageSize } = baseState;\n  const hasSpinConfig =\n    entry.spinStagePoint !== undefined ||\n    entry.spinImagePoint !== undefined ||\n    (typeof entry.spinSpeed === \"number\" && entry.spinSpeed !== 0);\n\n  if (!hasSpinConfig) {\n    return {\n      hasSpin: false,\n      calculation: { spinPoint: ZERO_DUAL_COORDINATE },\n      spinStagePoint: ZERO_POINT,\n      spinStagePercent: ZERO_PERCENT,\n      spinImagePercent: ZERO_PERCENT,\n      spinImagePoint: ZERO_POINT,\n    };\n  }\n\n  const spinStagePoint = normalizeStagePointInput(\n    entry.spinStagePoint,\n    baseData.position,\n    stageSize,\n  );\n  const spinStagePercent = stagePointToPercent(spinStagePoint, stageSize);\n  const spinImagePercent = normalizePercentInput(entry.spinImagePoint, 50, 50);\n  const spinImagePoint = imagePercentToImagePoint(\n    spinImagePercent,\n    baseData.imageMapping.imageDimensions,\n  );\n\n  const spinPoint = createDualSpaceCoordinate(\n    spinImagePoint,\n    spinImagePercent,\n    spinStagePoint,\n    spinStagePercent,\n  );\n\n  return {\n    hasSpin: true,\n    calculation: { spinPoint },\n    spinStagePoint,\n    spinStagePercent,\n    spinImagePercent,\n    spinImagePoint,\n  };\n}\n\n/** Prepare orbit-specific coordinates and metadata. */\nexport function prepareOrbitState(\n  baseState: BaseLayerState,\n  entry: LayerConfigEntry,\n): OrbitPreparationState {\n  const { baseData, stageCenter, stageSize } = baseState;\n\n  const orbitConfigured =\n    entry.orbitStagePoint !== undefined ||\n    entry.orbitLinePoint !== undefined ||\n    entry.orbitImagePoint !== undefined ||\n    entry.orbitLine === true ||\n    entry.orbitOrient === true ||\n    (typeof entry.orbitSpeed === \"number\" && entry.orbitSpeed !== 0);\n\n  if (!orbitConfigured) {\n    return {\n      hasOrbit: false,\n      calculation: {\n        orbitPoint: {\n          ...ZERO_DUAL_COORDINATE,\n          stageAnchor: ZERO_COORDINATE_BUNDLE,\n        },\n        orbitLine: ZERO_COORDINATE_BUNDLE,\n      },\n      orbitStagePoint: ZERO_POINT,\n      orbitLinePoint: ZERO_POINT,\n      orbitLineVisible: false,\n      orbitRadius: 0,\n      orbitImagePercent: ZERO_PERCENT,\n      orbitImagePoint: ZERO_POINT,\n    };\n  }\n\n  const orbitStagePoint = normalizeStagePointInput(\n    entry.orbitStagePoint,\n    stageCenter.point,\n    stageSize,\n  );\n  const orbitStagePercent = stagePointToPercent(orbitStagePoint, stageSize);\n\n  const orbitLinePoint = normalizeStagePointInput(entry.orbitLinePoint, orbitStagePoint, stageSize);\n  const orbitLinePercent = stagePointToPercent(orbitLinePoint, stageSize);\n  const orbitLineVisible = Boolean(entry.orbitLine);\n\n  const radiusDx = orbitLinePoint.x - orbitStagePoint.x;\n  const radiusDy = orbitLinePoint.y - orbitStagePoint.y;\n  const orbitRadius = Math.sqrt(radiusDx * radiusDx + radiusDy * radiusDy);\n\n  const orbitImagePercent = normalizePercentInput(entry.orbitImagePoint, 50, 50);\n  const orbitImagePoint = imagePercentToImagePoint(\n    orbitImagePercent,\n    baseData.imageMapping.imageDimensions,\n  );\n  const orbitImageStagePoint = imagePointToStagePoint(\n    orbitImagePoint,\n    baseData.imageMapping.imageDimensions,\n    baseData.scale,\n    baseData.position,\n  );\n  const orbitImageStagePercent = stagePointToPercent(orbitImageStagePoint, stageSize);\n\n  const orbitPoint = {\n    ...createDualSpaceCoordinate(\n      orbitImagePoint,\n      orbitImagePercent,\n      orbitStagePoint,\n      orbitStagePercent,\n    ),\n    stageAnchor: createCoordinateBundle(orbitImageStagePoint, orbitImageStagePercent),\n  };\n\n  return {\n    hasOrbit: true,\n    calculation: {\n      orbitPoint,\n      orbitLine: createCoordinateBundle(orbitLinePoint, orbitLinePercent),\n    },\n    orbitStagePoint,\n    orbitLinePoint,\n    orbitLineVisible,\n    orbitRadius,\n    orbitImagePercent,\n    orbitImagePoint,\n  };\n}\n\n/** Prepare layer data from configuration (MAIN ENTRY POINT). */\nexport async function prepareLayer(\n  entry: LayerConfigEntry,\n  stageSize: number,\n): Promise<UniversalLayerData | null> {\n  const baseState = await prepareBasicState(entry, stageSize);\n  if (!baseState) return null;\n\n  const spinState = prepareSpinState(baseState, entry);\n  const orbitState = prepareOrbitState(baseState, entry);\n\n  const calculation: LayerCalculationPoints = {\n    stageCenter: baseState.stageCenter,\n    imageCenter: baseState.imageCenter,\n    spinPoint: spinState.calculation.spinPoint,\n    orbitPoint: orbitState.calculation.orbitPoint,\n    orbitLine: orbitState.hasOrbit ? orbitState.calculation.orbitLine : undefined,\n  };\n\n  const layer: UniversalLayerData = {\n    ...baseState.baseData,\n    calculation,\n    spinStagePoint: spinState.hasSpin ? spinState.spinStagePoint : undefined,\n    spinStagePercent: spinState.hasSpin ? spinState.spinStagePercent : undefined,\n    spinPercent: spinState.hasSpin ? spinState.spinImagePercent : undefined,\n    spinImagePoint: spinState.hasSpin ? spinState.spinImagePoint : undefined,\n    orbitStagePoint: orbitState.hasOrbit ? orbitState.orbitStagePoint : undefined,\n    orbitLinePoint: orbitState.hasOrbit ? orbitState.orbitLinePoint : undefined,\n    orbitLineVisible: orbitState.orbitLineVisible,\n    orbitRadius: orbitState.hasOrbit ? orbitState.orbitRadius : undefined,\n    orbitImagePercent: orbitState.hasOrbit ? orbitState.orbitImagePercent : undefined,\n    orbitImagePoint: orbitState.hasOrbit ? orbitState.orbitImagePoint : undefined,\n  };\n\n  return layer;\n}\n\n/** Check if layer uses 2D renderer. */\nexport function is2DLayer(entry: LayerConfigEntry): boolean {\n  // Currently both \"2D\" and \"3D\" go through the same 2D prep path.\n  // Allow \"3D\" so Three.js layers are not filtered out.\n  return entry.renderer === \"2D\" || entry.renderer === \"3D\";\n}\n\n// Build motion processors for spin and orbit animations.\nexport { buildLayerMotion } from \"./motion\";\n\n// Plugin system for layer behaviors and pipeline execution.\n\n/** Internal registry of all processor plugins. */\nconst processorRegistry = new Map<string, ProcessorPlugin>();\n\n/** Register or replace a processor plugin. */\nexport function registerProcessor(plugin: ProcessorPlugin): void {\n  processorRegistry.set(plugin.name, plugin);\n}\n\n/** Remove a processor plugin by name. */\nexport function unregisterProcessor(name: string): boolean {\n  return processorRegistry.delete(name);\n}\n\n/** Remove all registered processor plugins (primarily for tests). */\nexport function clearProcessors(): void {\n  processorRegistry.clear();\n}\n\n/** Snapshot the currently registered processor plugins. */\nexport function listRegisteredProcessors(): ProcessorPlugin[] {\n  return Array.from(processorRegistry.values());\n}\n\n/** Resolve processors for an entry using a registry source. */\nexport function resolveProcessorsForEntry(\n  entry: LayerConfigEntry,\n  context?: ProcessorContext,\n  registry: Iterable<ProcessorPlugin> = processorRegistry.values(),\n): LayerProcessor[] {\n  const attached: LayerProcessor[] = [];\n  for (const plugin of registry) {\n    try {\n      if (plugin.shouldAttach(entry, context)) {\n        attached.push(plugin.create(entry, context));\n      }\n    } catch (error) {\n      console.warn(\n        `[Engine] Failed to attach processor \"${plugin.name}\" for layer \"${entry.LayerID}\":`,\n        error,\n      );\n    }\n  }\n  return attached;\n}\n\n/** Backward-compatible alias for resolveProcessorsForEntry. */\nexport function getProcessorsForEntry(\n  entry: LayerConfigEntry,\n  context?: ProcessorContext,\n): LayerProcessor[] {\n  const processors = resolveProcessorsForEntry(entry, context);\n  const pulse = createPulseProcessor(entry);\n  if (pulse) processors.push(pulse);\n  return processors;\n}\n\nconst DEFAULT_PULSE_AMPLITUDE = 0.15;\n\n/** Create a simple opacity pulse processor if configured. */\nfunction createPulseProcessor(entry: LayerConfigEntry): LayerProcessor | null {\n  const pulseSeconds =\n    typeof entry.PulseSeconds === \"number\" && entry.PulseSeconds > 0 ? entry.PulseSeconds : null;\n  if (!pulseSeconds) return null;\n  const amplitude =\n    typeof entry.PulseAmplitude === \"number\"\n      ? Math.min(1, Math.max(0, entry.PulseAmplitude))\n      : DEFAULT_PULSE_AMPLITUDE;\n  const periodMs = pulseSeconds * 1000;\n  return (layer, timestamp) => {\n    if (timestamp === undefined) return layer;\n    const baseOpacity = layer.opacity ?? 1;\n    const pulseAmplitude = layer.pulseAmplitude ?? amplitude;\n    const phase = ((timestamp % periodMs) / periodMs) * Math.PI * 2;\n    const factor = 1 + pulseAmplitude * Math.sin(phase); // oscillates between 1-amp .. 1+amp\n    const opacity = Math.max(0, Math.min(1, baseOpacity * factor));\n    return {\n      ...layer,\n      opacity,\n    };\n  };\n}\n\n/** Run layer data through a pipeline of processors. */\nexport function runPipeline(\n  baseLayer: UniversalLayerData,\n  processors: LayerProcessor[],\n  timestamp?: number,\n): EnhancedLayerData {\n  let enhanced: EnhancedLayerData = { ...baseLayer };\n\n  for (const processor of processors) {\n    enhanced = processor(enhanced, timestamp);\n  }\n\n  return enhanced;\n}\n\n/** Process multiple layers through the same pipeline. */\nexport function processBatch(\n  baseLayers: UniversalLayerData[],\n  processors: LayerProcessor[],\n  timestamp?: number,\n): EnhancedLayerData[] {\n  return baseLayers.map((layer) => runPipeline(layer, processors, timestamp));\n}\n\n// Helper functions for animations and calculations.\n\n/** Calculate elapsed time from timestamp and start time. */\nexport function calculateElapsedTime(\n  timestamp: number,\n  startTime?: number,\n): { elapsed: number; effectiveStartTime: number } {\n  if (startTime === undefined) {\n    return { elapsed: timestamp, effectiveStartTime: 0 };\n  }\n  const elapsed = timestamp - startTime;\n  return { elapsed, effectiveStartTime: startTime };\n}\n\n// Utilities for optimizing layer rendering performance.\n\n/** Frame-based cache for pipeline results. */\nexport class PipelineCache<T = EnhancedLayerData> {\n  private frameId: number = 0;\n  private cache = new Map<string, { frameId: number; value: T }>();\n\n  get(layerId: string, factory: () => T): T {\n    const cached = this.cache.get(layerId);\n    if (cached && cached.frameId === this.frameId) {\n      return cached.value;\n    }\n    const value = factory();\n    this.cache.set(layerId, { frameId: this.frameId, value });\n    return value;\n  }\n\n  clear(): void {\n    this.cache.clear();\n  }\n\n  nextFrame(): void {\n    this.clear();\n    this.frameId++;\n  }\n\n  getFrameId(): number {\n    return this.frameId;\n  }\n}\n\n/** Create a new pipeline cache. */\nexport function createPipelineCache<T = EnhancedLayerData>(): PipelineCache<T> {\n  return new PipelineCache<T>();\n}\n\n/** Offscreen canvas buffer for static layers. */\nexport class StaticLayerBuffer {\n  private offscreenCanvas: OffscreenCanvas | null = null;\n  private offscreenCtx: OffscreenCanvasRenderingContext2D | null = null;\n  private isRendered = false;\n\n  constructor(width: number, height: number) {\n    if (typeof OffscreenCanvas !== \"undefined\") {\n      this.offscreenCanvas = new OffscreenCanvas(width, height);\n      this.offscreenCtx = this.offscreenCanvas.getContext(\"2d\");\n    }\n  }\n\n  getContext(): OffscreenCanvasRenderingContext2D | null {\n    return this.offscreenCtx;\n  }\n\n  markRendered(): void {\n    this.isRendered = true;\n  }\n\n  isAlreadyRendered(): boolean {\n    return this.isRendered;\n  }\n\n  compositeTo(ctx: CanvasRenderingContext2D, x: number = 0, y: number = 0): void {\n    if (this.offscreenCanvas && this.isRendered) {\n      ctx.drawImage(this.offscreenCanvas, x, y);\n    }\n  }\n\n  static isSupported(): boolean {\n    return typeof OffscreenCanvas !== \"undefined\";\n  }\n}\n\n/** Batched layers by animation type. */\nexport type LayerBatch<T> = {\n  static: T[];\n  spinOnly: T[];\n  orbital: T[];\n  complex: T[];\n};\n\n/** Batch layers by animation type. */\nexport function batchLayersByAnimation<\n  T extends {\n    hasSpinAnimation?: boolean;\n    hasOrbitalAnimation?: boolean;\n    isStatic?: boolean;\n  },\n>(layers: T[]): LayerBatch<T> {\n  const batched: LayerBatch<T> = {\n    static: [],\n    spinOnly: [],\n    orbital: [],\n    complex: [],\n  };\n\n  for (const layer of layers) {\n    if (layer.isStatic) {\n      batched.static.push(layer);\n    } else if (layer.hasOrbitalAnimation) {\n      if (layer.hasSpinAnimation) {\n        batched.complex.push(layer);\n      } else {\n        batched.orbital.push(layer);\n      }\n    } else if (layer.hasSpinAnimation) {\n      batched.spinOnly.push(layer);\n    } else {\n      batched.static.push(layer);\n    }\n  }\n\n  return batched;\n}\n","path":null,"size_bytes":22481,"size_tokens":null},"shared/component/spinner_spinner-standard-3.tsx":{"content":"import { Spinner } from \"@/components/ui/spinner\";\n\nexport const title = \"Large Spinner\";\n\nconst Example = () => <Spinner className=\"size-8\" />;\n\nexport default Example;\n","path":null,"size_bytes":170,"size_tokens":null},"shared/component/globals.css":{"content":"/* \nUncomment to import Google fonts if you want to use them in your project.\n@import url(\"https://fonts.googleapis.com/css2?family=Inter:ital%2Copsz%2Cwght@0%2C14..32%2C100..900;1%2C14..32%2C100..900&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Playfair+Display:ital%2Cwght@0%2C400..900;1%2C400..900&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Roboto+Mono:ital%2Cwght@0%2C100..700;1%2C100..700&display=swap\");\n\n@import url(\"https://fonts.googleapis.com/css2?family=Caveat:wght@400..700&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Cal+Sans&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Merriweather:ital%2Copsz%2Cwght@0%2C18..144%2C300..900;1%2C18..144%2C300..900&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Ubuntu:ital%2Cwght@0%2C300;0%2C400;0%2C500;0%2C700;1%2C300;1%2C400;1%2C500;1%2C700&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=DM+Sans:ital%2Copsz%2Cwght@0%2C9..40%2C100..1000;1%2C9..40%2C100..1000&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Instrument+Sans:ital%2Cwght@0%2C400..700;1%2C400..700&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Assistant:wght@200..800&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Poppins:ital%2Cwght@0%2C100;0%2C200;0%2C300;0%2C400;0%2C500;0%2C600;0%2C700;0%2C800;0%2C900;1%2C100;1%2C200;1%2C300;1%2C400;1%2C500;1%2C600;1%2C700;1%2C800;1%2C900&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Hedvig+Letters+Serif:opsz@12..24&display=swap\");\n@import url(\"https://fonts.googleapis.com/css2?family=Antonio:wght@100..700&display=swap\");\n*/\n\n@import \"tailwindcss\";\n\n@plugin \"@tailwindcss/typography\";\n@import \"tw-animate-css\";\n\n@custom-variant dark (&:where(.dark, .dark *));\n\n:root {\n  --background: oklch(1 0 0);\n  --foreground: oklch(0.141 0.005 285.823);\n  --card: oklch(1 0 0);\n  --card-foreground: oklch(0.141 0.005 285.823);\n  --popover: oklch(1 0 0);\n  --popover-foreground: oklch(0.141 0.005 285.823);\n  --primary: oklch(0.21 0.006 285.885);\n  --primary-foreground: oklch(0.985 0 0);\n  --secondary: oklch(0.967 0.001 286.375);\n  --secondary-foreground: oklch(0.21 0.006 285.885);\n  --muted: oklch(0.967 0.001 286.375);\n  --muted-foreground: oklch(0.552 0.016 285.938);\n  --accent: oklch(0.967 0.001 286.375);\n  --accent-foreground: oklch(0.21 0.006 285.885);\n  --destructive: oklch(0.577 0.245 27.325);\n  --border: oklch(0.92 0.004 286.32);\n  --input: oklch(0.92 0.004 286.32);\n  --ring: oklch(0.705 0.015 286.067);\n  --chart-1: oklch(0.646 0.222 41.116);\n  --chart-2: oklch(0.6 0.118 184.704);\n  --chart-3: oklch(0.398 0.07 227.392);\n  --chart-4: oklch(0.828 0.189 84.429);\n  --chart-5: oklch(0.769 0.188 70.08);\n  --sidebar: oklch(0.985 0 0);\n  --sidebar-foreground: oklch(0.141 0.005 285.823);\n  --sidebar-primary: oklch(0.21 0.006 285.885);\n  --sidebar-primary-foreground: oklch(0.985 0 0);\n  --sidebar-accent: oklch(0.967 0.001 286.375);\n  --sidebar-accent-foreground: oklch(0.21 0.006 285.885);\n  --sidebar-border: oklch(0.92 0.004 286.32);\n  --sidebar-ring: oklch(0.705 0.015 286.067);\n\n  --radius: 8px;\n\n  --shadow-2xs: 0 1px 3px 0px hsl(0 0% 0% / 0.05);\n  --shadow-xs: 0 1px 3px 0px hsl(0 0% 0% / 0.05);\n  --shadow-sm: 0 1px 3px 0px hsl(0 0% 0% / 0.1), 0 1px 2px -1px hsl(0 0% 0% / 0.1);\n  --shadow: 0 1px 3px 0px hsl(0 0% 0% / 0.1), 0 1px 2px -1px hsl(0 0% 0% / 0.1);\n  --shadow-md: 0 1px 3px 0px hsl(0 0% 0% / 0.1), 0 2px 4px -1px hsl(0 0% 0% / 0.1);\n  --shadow-lg: 0 1px 3px 0px hsl(0 0% 0% / 0.1), 0 4px 6px -1px hsl(0 0% 0% / 0.1);\n  --shadow-xl: 0 1px 3px 0px hsl(0 0% 0% / 0.1), 0 8px 10px -1px hsl(0 0% 0% / 0.1);\n  --shadow-2xl: 0 1px 3px 0px hsl(0 0% 0% / 0.25);\n\n  /* Shadcnblocks.com Colors */\n  --gradient-1: oklch(0.643 0.4075 269.926);\n  --gradient-2: oklch(0.727 0.4675 144.688);\n  --gradient-3: oklch(0.701 0.3775 339.956);\n\n  /* Alerts */\n  --error: oklch(0.704 0.191 22.216);\n  --success: oklch(0.34 0.69 165.96);\n  --info: oklch(0.36 0.68 241.16);\n  --warning: oklch(0.769 0.288 70.08);\n\n  /* Fonts */\n  /* Main font aliases */\n  --font-sans: var(--font-inter), \"Inter\", sans-serif;\n  --font-serif: var(--font-playfair), \"Playfair Display\", serif;\n  --font-mono: var(--font-roboto-mono), \"Roboto Mono\", monospace;\n\n  /* Magicui Colors */\n  --color-1: oklch(66.2% 0.225 25.9);\n  --color-2: oklch(60.4% 0.26 302);\n  --color-3: oklch(69.6% 0.165 251);\n  --color-4: oklch(80.2% 0.134 225);\n  --color-5: oklch(90.7% 0.231 133);\n}\n.dark {\n  --background: oklch(0.141 0.005 285.823);\n  --foreground: oklch(0.985 0 0);\n  --card: oklch(0.21 0.006 285.885);\n  --card-foreground: oklch(0.985 0 0);\n  --popover: oklch(0.21 0.006 285.885);\n  --popover-foreground: oklch(0.985 0 0);\n  --primary: oklch(0.92 0.004 286.32);\n  --primary-foreground: oklch(0.21 0.006 285.885);\n  --secondary: oklch(0.274 0.006 286.033);\n  --secondary-foreground: oklch(0.985 0 0);\n  --muted: oklch(0.274 0.006 286.033);\n  --muted-foreground: oklch(0.705 0.015 286.067);\n  --accent: oklch(0.274 0.006 286.033);\n  --accent-foreground: oklch(0.985 0 0);\n  --destructive: oklch(0.704 0.191 22.216);\n  --border: oklch(1 0 0 / 10%);\n  --input: oklch(1 0 0 / 15%);\n  --ring: oklch(0.552 0.016 285.938);\n  --chart-1: oklch(0.488 0.243 264.376);\n  --chart-2: oklch(0.696 0.17 162.48);\n  --chart-3: oklch(0.769 0.188 70.08);\n  --chart-4: oklch(0.627 0.265 303.9);\n  --chart-5: oklch(0.645 0.246 16.439);\n  --sidebar: oklch(0.21 0.006 285.885);\n  --sidebar-foreground: oklch(0.985 0 0);\n  --sidebar-primary: oklch(0.488 0.243 264.376);\n  --sidebar-primary-foreground: oklch(0.985 0 0);\n  --sidebar-accent: oklch(0.274 0.006 286.033);\n  --sidebar-accent-foreground: oklch(0.985 0 0);\n  --sidebar-border: oklch(1 0 0 / 10%);\n  --sidebar-ring: oklch(0.552 0.016 285.938);\n\n  /* Shadcnblocks.com Colors */\n  --gradient-1: oklch(0.643 0.4075 269.926);\n  --gradient-2: oklch(0.727 0.4675 144.688);\n  --gradient-3: oklch(0.701 0.3775 339.956);\n\n  /* Alerts */\n  --error: oklch(0.704 0.191 22.216);\n  --success: oklch(0.34 0.69 165.96);\n  --info: oklch(0.36 0.68 241.16);\n  --warning: oklch(0.769 0.288 70.08);\n\n  /* Magicui Colors */\n  --color-1: oklch(66.2% 0.225 25.9);\n  --color-2: oklch(60.4% 0.26 302);\n  --color-3: oklch(69.6% 0.165 251);\n  --color-4: oklch(80.2% 0.134 225);\n  --color-5: oklch(90.7% 0.231 133);\n}\n\n@theme inline {\n  --color-background: var(--background);\n  --color-foreground: var(--foreground);\n  --color-card: var(--card);\n  --color-card-foreground: var(--card-foreground);\n  --color-popover: var(--popover);\n  --color-popover-foreground: var(--popover-foreground);\n  --color-primary: var(--primary);\n  --color-primary-foreground: var(--primary-foreground);\n  --color-secondary: var(--secondary);\n  --color-secondary-foreground: var(--secondary-foreground);\n  --color-muted: var(--muted);\n  --color-muted-foreground: var(--muted-foreground);\n  --color-accent: var(--accent);\n  --color-accent-foreground: var(--accent-foreground);\n  --color-destructive: var(--destructive);\n  --color-destructive-foreground: var(--destructive-foreground);\n  --color-border: var(--border);\n  --color-input: var(--input);\n  --color-ring: var(--ring);\n  --color-chart-1: var(--chart-1);\n  --color-chart-2: var(--chart-2);\n  --color-chart-3: var(--chart-3);\n  --color-chart-4: var(--chart-4);\n  --color-chart-5: var(--chart-5);\n  --color-sidebar-ring: var(--sidebar-ring);\n  --color-sidebar-border: var(--sidebar-border);\n  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);\n  --color-sidebar-accent: var(--sidebar-accent);\n  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);\n  --color-sidebar-primary: var(--sidebar-primary);\n  --color-sidebar-foreground: var(--sidebar-foreground);\n  --color-sidebar: var(--sidebar);\n\n  /* Shadcnblocks.com Colors */\n  --color-transparent: transparent;\n  --color-gradient-1: var(--gradient-1);\n  --color-gradient-2: var(--gradient-2);\n  --color-gradient-3: var(--gradient-3);\n\n  /* Alerts */\n  --color-error: var(--error);\n  --color-success: var(--success);\n  --color-info: var(--info);\n  --color-warning: var(--warning);\n\n  /* Magicui Colors */\n  --color-color-5: var(--color-5);\n  --color-color-4: var(--color-4);\n  --color-color-3: var(--color-3);\n  --color-color-2: var(--color-2);\n  --color-color-1: var(--color-1);\n\n  --radius-xs: calc(var(--radius) - 4px);\n  --radius-sm: calc(var(--radius) - 4px);\n  --radius-md: calc(var(--radius) - 2px);\n  --radius-lg: var(--radius);\n  --radius-xl: calc(var(--radius) + 4px);\n\n  --shadow-2xs: var(--shadow-2xs);\n  --shadow-xs: var(--shadow-xs);\n  --shadow-sm: var(--shadow-sm);\n  --shadow: var(--shadow);\n  --shadow-md: var(--shadow-md);\n  --shadow-lg: var(--shadow-lg);\n  --shadow-xl: var(--shadow-xl);\n  --shadow-2xl: var(--shadow-2xl);\n\n  --font-sans: var(--font-sans);\n  --font-serif: var(--font-serif);\n  --font-mono: var(--font-mono);\n\n  --font-inter: var(--font-inter);\n  --font-roboto-mono: var(--font-roboto-mono);\n  --font-playfair: var(--font-playfair);\n\n  --font-caveat: var(--font-caveat);\n  --font-calSans: var(--font-calSans);\n  --font-bebas-neue: var(--font-bebas-neue);\n  --font-instrumentSerif: var(--font-instrumentSerif);\n  --font-merriweather: var(--font-merriweather);\n  --font-ubuntu: var(--font-ubuntu);\n  --font-dm-sans: var(--font-dm-sans);\n  --font-instrument-sans: var(--font-instrument-sans);\n  --font-assistant: var(--font-assistant);\n  --font-poppins: var(--font-poppins);\n  --font-hedvigLettersSerif: var(--font-hedvigLettersSerif);\n  --font-antonio: var(--font-antonio);\n\n  --breakpoint-sm: 640px;\n  --breakpoint-md: 768px;\n  --breakpoint-lg: 1024px;\n  --breakpoint-xl: 1280px;\n  --breakpoint-2xl: 1536px;\n\n  --animate-accordion-down: accordion-down 0.2s ease-out;\n  --animate-accordion-up: accordion-up 0.2s ease-out;\n  --animate-fade-in-out: fade-in-out 4s ease-in-out;\n  --animate-fade-in: fade-in 0.7s ease-out forwards;\n  --animate-progress: progress 8s linear;\n  --animate-infinite-slider: infiniteSlider 20s linear infinite;\n  --animate-infinite-slider-reverse: infiniteSliderReverse 20s linear infinite;\n  --animate-shadow-ping: shadow-ping 1.5s ease-in-out infinite;\n  --animate-flip-btn: flip-btn 6s infinite steps(2, end);\n  --animate-rotate-btn: rotate-btn 3s linear infinite both;\n  --animate-light-to-right-top: light-to-right 4s linear infinite;\n  --animate-light-to-right-bottom: light-to-right 4s linear infinite;\n  --animate-marquee: marquee 25s linear infinite;\n  --animate-marquee-vertical: marquee-vertical 25s linear infinite;\n  --animate-slide-to-right: slide-to-right 3s linear infinite;\n  --animate-slide-to-top: slide-to-top 3s linear infinite;\n  --animate-shimmer-slide: shimmer-slide var(--speed) ease-in-out infinite alternate;\n  --animate-spin-around: spin-around calc(var(--speed) * 2) infinite linear;\n  --animate-shine: shine var(--duration) infinite linear;\n  --animate-ripple: ripple var(--duration, 2s) ease calc(var(--i, 0) * 0.2s) infinite;\n  --animate-orbit: orbit calc(var(--duration) * 1s) linear infinite;\n  --animate-meteor: meteor 5s linear infinite;\n  --animate-line-shadow: line-shadow 15s linear infinite;\n  --animate-aurora: aurora 8s ease-in-out infinite alternate;\n  --animate-aurora-background: aurora-background 60s linear infinite;\n  --animate-slide-down: slideDown 100ms ease-out;\n  --animate-slide-up: slideUp 100ms ease-out;\n  --animate-slide-left: slideLeft 250ms ease-out;\n  --animate-slide-right: slideRight 250ms ease-out;\n  --animate-rainbow: rainbow var(--speed, 2s) infinite linear;\n\n  @keyframes accordion-down {\n    from {\n      height: 0;\n    }\n    to {\n      height: var(--radix-accordion-content-height);\n    }\n  }\n\n  @keyframes accordion-up {\n    from {\n      height: var(--radix-accordion-content-height);\n    }\n    to {\n      height: 0;\n    }\n  }\n\n  @keyframes fade-in-out {\n    0% {\n      opacity: 0;\n    }\n    20% {\n      opacity: 1;\n    }\n    80% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0;\n    }\n  }\n\n  @keyframes progress {\n    from {\n      width: \"0%\";\n    }\n    to {\n      width: \"100%\";\n    }\n  }\n\n  @keyframes infiniteSlider {\n    0% {\n      transform: \"translateX(0)\";\n    }\n    100% {\n      transform: \"translateX(calc(-250px * 5))\";\n    }\n  }\n\n  @keyframes infiniteSliderReverse {\n    0% {\n      transform: \"translateX(calc(-250px * 5))\";\n    }\n    100% {\n      transform: \"translateX(0)\";\n    }\n  }\n\n  @keyframes fade-in-scale {\n    0% {\n      opacity: 0;\n      transform: scale(0.95);\n    }\n    100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  @keyframes fade-in-scale-down {\n    0% {\n      opacity: 0;\n      transform: scale(1.1);\n    }\n    100% {\n      opacity: 1;\n      transform: scale(1);\n    }\n  }\n\n  @keyframes fade-in-slide-down {\n    0% {\n      transform: translateY(-24px);\n      opacity: 0;\n    }\n    100% {\n      transform: translateY(0);\n      opacity: 1;\n    }\n  }\n\n  @keyframes transform1 {\n    0%,\n    25%,\n    100% {\n      width: 100%;\n      padding-bottom: 120%;\n    }\n    33.33%,\n    58.33% {\n      width: 0%;\n      padding-bottom: 0%;\n    }\n    66.66%,\n    91.66% {\n      width: 90%;\n      padding-bottom: 100%;\n    }\n  }\n\n  @keyframes transform2 {\n    0%,\n    25%,\n    100% {\n      width: 65%;\n      padding-bottom: 65%;\n    }\n    33.33%,\n    58.33% {\n      width: 95%;\n      padding-bottom: 114%;\n    }\n    66.66%,\n    91.66% {\n      width: 52%;\n      padding-bottom: 52%;\n    }\n  }\n\n  @keyframes transform3 {\n    0%,\n    25%,\n    100% {\n      width: 78%;\n      padding-bottom: 100%;\n    }\n    33.33%,\n    58.33% {\n      width: 78%;\n      padding-bottom: 94%;\n    }\n    66.66%,\n    91.66% {\n      width: 95%;\n      padding-bottom: 76%;\n    }\n  }\n\n  @keyframes transform4 {\n    0%,\n    25%,\n    66.66%,\n    91.66%,\n    100% {\n      width: 0%;\n      padding-bottom: 0%;\n    }\n    33.33%,\n    58.33% {\n      width: 65%;\n      padding-bottom: 46%;\n    }\n  }\n\n  @keyframes image1 {\n    0%,\n    25%,\n    100% {\n      opacity: 1;\n    }\n    33.33%,\n    58.33%,\n    66.66%,\n    91.66% {\n      opacity: 0;\n    }\n  }\n\n  @keyframes image2 {\n    0%,\n    25%,\n    33.33%,\n    58.33%,\n    100% {\n      opacity: 0;\n    }\n    66.66%,\n    91.66% {\n      opacity: 1;\n    }\n  }\n\n  @keyframes image3 {\n    0%,\n    25%,\n    66.66%,\n    91.66%,\n    100% {\n      opacity: 0;\n    }\n    33.33%,\n    58.33% {\n      opacity: 1;\n    }\n  }\n\n  @keyframes gradient-spin {\n    0% {\n      transform: translateX(-50%) translateY(-50%) rotate(0deg);\n    }\n    100% {\n      transform: translateX(-50%) translateY(-50%) rotate(360deg);\n    }\n  }\n\n  @keyframes shadow-ping {\n    0% {\n      boxshadow: 0 0 0 0px var(--color-neutral-100);\n    }\n    50% {\n      boxshadow: 0 0 0 12px var(--color-neutral-300);\n    }\n    100% {\n      boxshadow: 0 0 0 12px transparent;\n    }\n  }\n\n  @keyframes show-text {\n    0%,\n    14.28% {\n      opacity: 0;\n    }\n    17%,\n    26% {\n      opacity: 1;\n    }\n    28.58%,\n    100% {\n      opacity: 0;\n    }\n  }\n\n  @keyframes flip-btn {\n    to {\n      transform: rotate(360deg);\n    }\n  }\n\n  @keyframes rotate-btn {\n    to {\n      transform: rotate(90deg);\n    }\n  }\n\n  @keyframes slide-to-right {\n    0% {\n      opacity: 0;\n      left: 0;\n    }\n    50% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0;\n      left: 80%;\n    }\n  }\n\n  @keyframes slide-to-top {\n    0% {\n      opacity: 0;\n      bottom: 0;\n    }\n    50% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0;\n      bottom: 80%;\n    }\n  }\n\n  @keyframes light-to-right {\n    0% {\n      transform: translate(0%);\n      opacity: 0;\n    }\n    50% {\n      opacity: 1;\n    }\n    100% {\n      transform: translate(100%);\n      opacity: 0;\n    }\n  }\n\n  @keyframes marquee {\n    0% {\n      transform: translateX(0%);\n    }\n    100% {\n      transform: translateX(-100%);\n    }\n  }\n\n  @keyframes marquee-vertical {\n    from {\n      transform: translateY(0);\n    }\n    to {\n      transform: translateY(calc(-100% - var(--gap)));\n    }\n  }\n\n  @keyframes fade-in {\n    0% {\n      opacity: 0;\n      transform: translateY(20px);\n    }\n    100% {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n\n  @keyframes shimmer-slide {\n    to {\n      transform: translate(calc(100cqw - 100%), 0);\n    }\n  }\n\n  @keyframes spin-around {\n    0% {\n      transform: translateZ(0) rotate(0);\n    }\n    15%,\n    35% {\n      transform: translateZ(0) rotate(90deg);\n    }\n    65%,\n    85% {\n      transform: translateZ(0) rotate(270deg);\n    }\n    100% {\n      transform: translateZ(0) rotate(360deg);\n    }\n  }\n\n  @keyframes shine {\n    0% {\n      background-position: 0% 0%;\n    }\n    50% {\n      background-position: 100% 100%;\n    }\n    to {\n      background-position: 0% 0%;\n    }\n  }\n\n  @keyframes aurora-background {\n    from {\n      background-position:\n        50% 50%,\n        50% 50%;\n    }\n    to {\n      background-position:\n        350% 50%,\n        350% 50%;\n    }\n  }\n\n  @keyframes aurora {\n    0% {\n      background-position: 0% 50%;\n      transform: rotate(-5deg) scale(0.9);\n    }\n    25% {\n      background-position: 50% 100%;\n      transform: rotate(5deg) scale(1.1);\n    }\n    50% {\n      background-position: 100% 50%;\n      transform: rotate(-3deg) scale(0.95);\n    }\n    75% {\n      background-position: 50% 0%;\n      transform: rotate(3deg) scale(1.05);\n    }\n    100% {\n      background-position: 0% 50%;\n      transform: rotate(-5deg) scale(0.9);\n    }\n  }\n\n  @keyframes ripple {\n    0%,\n    100% {\n      transform: translate(-50%, -50%) scale(1);\n    }\n    50% {\n      transform: translate(-50%, -50%) scale(0.9);\n    }\n  }\n\n  @keyframes orbit {\n    0% {\n      transform: rotate(calc(var(--angle) * 1deg)) translateY(calc(var(--radius) * 1px)) rotate(calc(var(--angle) * -1deg));\n    }\n    100% {\n      transform: rotate(calc(var(--angle) * 1deg + 360deg)) translateY(calc(var(--radius) * 1px)) rotate(calc((var(--angle) * -1deg) - 360deg));\n    }\n  }\n\n  @keyframes meteor {\n    0% {\n      transform: rotate(var(--angle)) translateX(0);\n      opacity: 1;\n    }\n    70% {\n      opacity: 1;\n    }\n    100% {\n      transform: rotate(var(--angle)) translateX(-500px);\n      opacity: 0;\n    }\n  }\n\n  @keyframes line-shadow {\n    0% {\n      background-position: 0 0;\n    }\n    100% {\n      background-position: 100% -100%;\n    }\n  }\n\n  @keyframes slideDown {\n    from {\n      height: 0;\n    }\n    to {\n      height: var(--radix-collapsible-content-height);\n    }\n  }\n\n  @keyframes slideUp {\n    from {\n      height: var(--radix-collapsible-content-height);\n    }\n    to {\n      height: 0;\n    }\n  }\n\n  @keyframes slideLeft {\n    from {\n      width: 0;\n    }\n    to {\n      width: var(--radix-collapsible-content-width);\n    }\n  }\n  @keyframes slideRight {\n    from {\n      width: var(--radix-collapsible-content-width);\n    }\n    to {\n      width: 0;\n    }\n  }\n  @keyframes rainbow {\n    0% {\n      background-position: 0%;\n    }\n    100% {\n      background-position: 200%;\n    }\n  }\n}\n\n@utility container {\n  margin-inline: auto;\n  padding-inline: 2rem;\n}\n\n@layer components {\n  button {\n    cursor: pointer;\n  }\n  [class*=\"border\"] {\n    @apply border-border;\n  }\n}\n\n@layer base {\n  * {\n    @apply border-border outline-ring/50;\n  }\n  body {\n    @apply bg-background text-foreground font-sans antialiased;\n    scrollbar-gutter: stable;\n  }\n}\n\nhtml body[data-scroll-locked] {\n  overflow-y: scroll !important;\n  --removed-body-scroll-bar-size: 0 !important;\n  margin-right: 0 !important;\n}\n\n.hide-scrollbar {\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none; /* IE 10+ */\n}\n\n.hide-scrollbar::-webkit-scrollbar {\n  display: none; /* Chrome, Safari, Opera */\n}\n","path":null,"size_bytes":19766,"size_tokens":null},"shared/effect/straightRay.ts":{"content":"import * as THREE from \"three\";\nimport { resolveAssetPath, resolveAssetUrl } from \"../layer/engine\";\n\nexport type StraightRayOptions = {\n  layerCount?: number;\n  width?: number;\n  height?: number;\n  offsetStep?: number;\n  baseOpacity?: number;\n  opacityStep?: number;\n  speed?: number;\n};\n\nfunction getTextureUrl(imageId: string): string {\n  const path = resolveAssetPath(imageId);\n  if (!path) {\n    throw new Error(`[StraightRay] Missing asset for \"${imageId}\"`);\n  }\n  return resolveAssetUrl(path);\n}\n\n/**\n * Create stacked straight smoke/ray meshes (additive blended).\n * Caller is responsible for adding to scene and driving uTime uniforms.\n */\nexport function createStraightRay(\n  textureLoader: THREE.TextureLoader,\n  {\n    layerCount = 3,\n    width = 0.6,\n    height = 1.8,\n    offsetStep = 0.33,\n    baseOpacity = 0.5,\n    opacityStep = 0.1,\n    speed = 0.2,\n  }: StraightRayOptions = {},\n): THREE.Mesh[] {\n  const noiseTexture = textureLoader.load(getTextureUrl(\"alpha_noise_256_wave_22\"));\n  noiseTexture.wrapS = THREE.RepeatWrapping;\n  noiseTexture.wrapT = THREE.RepeatWrapping;\n\n  const vertexShader = `\n    varying vec2 vUv;\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  `;\n\n  const fragmentShader = `\n    uniform sampler2D uTexture;\n    uniform float uTime;\n    uniform float uOffset;\n    uniform float uOpacity;\n    uniform float uSpeed;\n    varying vec2 vUv;\n\n    void main() {\n      vec2 uv = vUv;\n      \n      // Animate upward without stretch\n      uv.y -= uTime * uSpeed + uOffset;\n      \n      // Sample texture normally\n      vec4 noise = texture2D(uTexture, uv);\n      \n      // Fade at tip for natural smoke dissipation\n      float fadeY = smoothstep(0.0, 0.15, vUv.y) * smoothstep(1.0, 0.7, vUv.y);\n      float fadeX = smoothstep(0.0, 0.1, vUv.x) * smoothstep(1.0, 0.9, vUv.x);\n      \n      gl_FragColor = vec4(noise.rgb, noise.a * fadeY * fadeX * uOpacity);\n    }\n  `;\n\n  const meshes: THREE.Mesh[] = [];\n\n  for (let i = 0; i < layerCount; i++) {\n    const material = new THREE.ShaderMaterial({\n      vertexShader,\n      fragmentShader,\n      uniforms: {\n        uTexture: { value: noiseTexture },\n        uTime: { value: 0 },\n        uOffset: { value: i * offsetStep },\n        uOpacity: { value: Math.max(0, baseOpacity - i * opacityStep) },\n        uSpeed: { value: speed },\n      },\n      transparent: true,\n      blending: THREE.AdditiveBlending,\n      depthWrite: false,\n    });\n\n    const geometry = new THREE.PlaneGeometry(width, height);\n    const mesh = new THREE.Mesh(geometry, material);\n    mesh.position.z = -i * 0.01;\n    meshes.push(mesh);\n  }\n\n  return meshes;\n}\n","path":null,"size_bytes":2681,"size_tokens":null},"shared/utils/logger.ts":{"content":"type LogLevel = \"info\" | \"warn\" | \"error\" | \"debug\" | \"success\";\n\ninterface LogOptions {\n  timestamp?: boolean;\n  stack?: boolean;\n}\n\nclass Logger {\n  private isDev: boolean;\n  private enableDebug: boolean;\n\n  constructor() {\n    const metaEnv = (import.meta as any)?.env;\n    const globalProcess = (globalThis as { process?: { env?: Record<string, string | undefined> } })\n      .process;\n    const processEnv = globalProcess?.env;\n    const explicitDev = typeof metaEnv?.DEV === \"boolean\" ? metaEnv.DEV : undefined;\n    const inferredDev = processEnv?.NODE_ENV ? processEnv.NODE_ENV !== \"production\" : undefined;\n    this.isDev = explicitDev ?? inferredDev ?? false;\n    const debugRaw = metaEnv?.DEBUG ?? processEnv?.DEBUG;\n    this.enableDebug = debugRaw === \"true\" || debugRaw === true || this.isDev;\n  }\n  private format(level: LogLevel, message: string, options: LogOptions = {}): string {\n    const parts: string[] = [];\n\n    if (options.timestamp !== false) {\n      parts.push(`[${new Date().toISOString()}]`);\n    }\n\n    const levelEmoji = {\n      info: \"ℹ️\",\n      warn: \"⚠️\",\n      error: \"🚨\",\n      debug: \"🔍\",\n      success: \"✅\",\n    };\n    parts.push(`${levelEmoji[level]} [${level.toUpperCase()}]`);\n\n    parts.push(message);\n\n    return parts.join(\" \");\n  }\n\n  info(message: string, ...args: any[]): void {\n    if (this.isDev) {\n      console.log(this.format(\"info\", message), ...args);\n    }\n  }\n\n  warn(message: string, ...args: any[]): void {\n    console.warn(this.format(\"warn\", message), ...args);\n  }\n\n  error(message: string, error?: Error | any, ...args: any[]): void {\n    console.error(this.format(\"error\", message), ...args);\n    if (error instanceof Error && error.stack) {\n      console.error(\"Stack trace:\", error.stack);\n    } else if (error) {\n      console.error(\"Error details:\", error);\n    }\n  }\n\n  debug(message: string, ...args: any[]): void {\n    if (this.enableDebug) {\n      console.log(this.format(\"debug\", message), ...args);\n    }\n  }\n\n  success(message: string, ...args: any[]): void {\n    if (this.isDev) {\n      console.log(this.format(\"success\", message), ...args);\n    }\n  }\n\n  time(label: string): void {\n    console.time(`⏱️  ${label}`);\n  }\n\n  timeEnd(label: string): void {\n    console.timeEnd(`⏱️  ${label}`);\n  }\n\n  scope(prefix: string) {\n    return {\n      info: (msg: string, ...args: any[]) => this.info(`[${prefix}] ${msg}`, ...args),\n      warn: (msg: string, ...args: any[]) => this.warn(`[${prefix}] ${msg}`, ...args),\n      error: (msg: string, err?: Error, ...args: any[]) =>\n        this.error(`[${prefix}] ${msg}`, err, ...args),\n      debug: (msg: string, ...args: any[]) => this.debug(`[${prefix}] ${msg}`, ...args),\n      success: (msg: string, ...args: any[]) => this.success(`[${prefix}] ${msg}`, ...args),\n    };\n  }\n\n  group(label: string, collapsed: boolean = false): void {\n    if (collapsed) {\n      console.groupCollapsed(label);\n    } else {\n      console.group(label);\n    }\n  }\n\n  groupEnd(): void {\n    console.groupEnd();\n  }\n\n  table(data: any): void {\n    if (this.isDev) {\n      console.table(data);\n    }\n  }\n}\n\nexport const logger = new Logger();\n\nexport default logger;\n","path":null,"size_bytes":3184,"size_tokens":null},"shared/fonts/taimingda.css":{"content":"@font-face {\n  font-family: \"Taimingda\";\n  src: url(\"./taimingda.ttf\") format(\"truetype\");\n  font-weight: 400;\n  font-style: normal;\n  font-display: swap;\n}\n","path":null,"size_bytes":157,"size_tokens":null},"shared/component/drawer_drawer-right-1.tsx":{"content":"\"use client\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Drawer,\n  DrawerClose,\n  DrawerContent,\n  DrawerDescription,\n  DrawerFooter,\n  DrawerHeader,\n  DrawerTitle,\n  DrawerTrigger,\n} from \"@/components/ui/drawer\";\n\nexport const title = \"Simple Right Drawer\";\n\nconst Example = () => (\n  <Drawer direction=\"right\">\n    <DrawerTrigger asChild>\n      <Button variant=\"outline\">Open Right Drawer</Button>\n    </DrawerTrigger>\n    <DrawerContent>\n      <DrawerHeader>\n        <DrawerTitle>Drawer Title</DrawerTitle>\n        <DrawerDescription>\n          This drawer slides in from the right side.\n        </DrawerDescription>\n      </DrawerHeader>\n      <div className=\"p-4\">\n        <p className=\"text-muted-foreground text-sm\">\n          Right-side drawers are great for supplementary content, settings, or\n          detail views.\n        </p>\n      </div>\n      <DrawerFooter>\n        <Button>Confirm</Button>\n        <DrawerClose asChild>\n          <Button variant=\"outline\">Cancel</Button>\n        </DrawerClose>\n      </DrawerFooter>\n    </DrawerContent>\n  </Drawer>\n);\n\nexport default Example;\n","path":null,"size_bytes":1114,"size_tokens":null},"shared/component/combobox_combobox-custom-actions-7.tsx":{"content":"\"use client\";\n\nimport { Check, ChevronsUpDown, X } from \"lucide-react\";\nimport { useState } from \"react\";\n\nimport { cn } from \"@/lib/utils\";\n\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"@/components/ui/command\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\n\nexport const title = \"Clear/Reset Button\";\n\nconst themes = [\n  { value: \"light\", label: \"Light\" },\n  { value: \"dark\", label: \"Dark\" },\n  { value: \"system\", label: \"System\" },\n];\n\nconst Example = () => {\n  const [open, setOpen] = useState(false);\n  const [value, setValue] = useState(\"system\");\n\n  return (\n    <Popover onOpenChange={setOpen} open={open}>\n      <PopoverTrigger asChild>\n        <Button\n          aria-expanded={open}\n          className=\"w-[200px] justify-between\"\n          role=\"combobox\"\n          variant=\"outline\"\n        >\n          {value\n            ? themes.find((theme) => theme.value === value)?.label\n            : \"Select theme...\"}\n          <div className=\"ml-2 flex items-center gap-1\">\n            {value && (\n              <button\n                className=\"rounded-sm hover:bg-accent\"\n                onClick={(e) => {\n                  e.preventDefault();\n                  e.stopPropagation();\n                  setValue(\"\");\n                }}\n              >\n                <X className=\"size-4 opacity-50 hover:opacity-100\" />\n              </button>\n            )}\n            <ChevronsUpDown className=\"size-4 shrink-0 opacity-50\" />\n          </div>\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-[200px] p-0\">\n        <Command>\n          <CommandInput placeholder=\"Search themes...\" />\n          <CommandList>\n            <CommandEmpty>No theme found.</CommandEmpty>\n            <CommandGroup>\n              {themes.map((theme) => (\n                <CommandItem\n                  key={theme.value}\n                  onSelect={(currentValue) => {\n                    setValue(currentValue === value ? \"\" : currentValue);\n                    setOpen(false);\n                  }}\n                  value={theme.value}\n                >\n                  <Check\n                    className={cn(\n                      \"mr-2 size-4\",\n                      value === theme.value ? \"opacity-100\" : \"opacity-0\"\n                    )}\n                  />\n                  {theme.label}\n                </CommandItem>\n              ))}\n            </CommandGroup>\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n};\n\nexport default Example;\n","path":null,"size_bytes":2662,"size_tokens":null},"shared/layer/math.ts":{"content":"/** LAYER MATH - Pure Calculation Functions. */\n\nimport type {\n  Point2D,\n  PercentPoint,\n  CoordinateBundle,\n  DualSpaceCoordinate,\n  ImageMapping,\n  RotationDirection,\n  ClockSpeedAlias,\n  TimeFormat,\n  DirectionSign,\n  ClockSpeedSetting,\n  ClockSpeedValue,\n  ClockMotionConfig,\n  ResolvedClockSpeed,\n} from \"./model\";\n\nimport { CLOCK_DEFAULTS, CLOCK_SPEED_ALIASES } from \"./model\";\n\n// Convert coordinates between different spaces (image/stage, pixel/percent)\n\n/** Transform a point from image space to stage space. */\nexport function imagePointToStagePoint(\n  imagePoint: Point2D,\n  imageDimensions: { width: number; height: number },\n  scale: Point2D,\n  position: Point2D,\n): Point2D {\n  const validImagePoint = validatePoint(imagePoint);\n  const validDimensions = validateDimensions(imageDimensions);\n  const validScale = validateScale(scale);\n  const validPosition = validatePoint(position);\n\n  const halfWidth = validDimensions.width / 2;\n  const halfHeight = validDimensions.height / 2;\n\n  const result = {\n    x: validPosition.x + (validImagePoint.x - halfWidth) * validScale.x,\n    y: validPosition.y + (validImagePoint.y - halfHeight) * validScale.y,\n  };\n\n  return validatePoint(result);\n}\n\n/** Transform a point from stage space to image space. */\nexport function stagePointToImagePoint(\n  stagePoint: Point2D,\n  imageDimensions: { width: number; height: number },\n  scale: Point2D,\n  position: Point2D,\n): Point2D {\n  const validStagePoint = validatePoint(stagePoint);\n  const validDimensions = validateDimensions(imageDimensions);\n  const validScale = validateScale(scale);\n  const validPosition = validatePoint(position);\n\n  const halfWidth = validDimensions.width / 2;\n  const halfHeight = validDimensions.height / 2;\n\n  // Prevent division by zero\n  const safeScaleX = validScale.x !== 0 ? validScale.x : 1;\n  const safeScaleY = validScale.y !== 0 ? validScale.y : 1;\n\n  const result = {\n    x: (validStagePoint.x - validPosition.x) / safeScaleX + halfWidth,\n    y: (validStagePoint.y - validPosition.y) / safeScaleY + halfHeight,\n  };\n\n  return validatePoint(result);\n}\n\n/** Convert image point (pixels) to percentage coordinates. */\nexport function imagePointToPercent(\n  imagePoint: Point2D,\n  imageDimensions: { width: number; height: number },\n): PercentPoint {\n  const invWidth = 100 / imageDimensions.width;\n  const invHeight = 100 / imageDimensions.height;\n  return {\n    x: imagePoint.x * invWidth,\n    y: imagePoint.y * invHeight,\n  };\n}\n\n/** Convert percentage coordinates to image point (pixels). */\nexport function imagePercentToImagePoint(\n  imagePercent: PercentPoint,\n  imageDimensions: { width: number; height: number },\n): Point2D {\n  const validDimensions = validateDimensions(imageDimensions);\n  const widthFactor = validDimensions.width / 100;\n  const heightFactor = validDimensions.height / 100;\n\n  const result = {\n    x: imagePercent.x * widthFactor,\n    y: imagePercent.y * heightFactor,\n  };\n\n  return validatePoint(result);\n}\n\n/** Convert stage point to percentage coordinates. */\nexport function stagePointToPercent(stagePoint: Point2D, stageSize: number): PercentPoint {\n  const invStage = 100 / stageSize;\n  return {\n    x: stagePoint.x * invStage,\n    y: stagePoint.y * invStage,\n  };\n}\n\n/** Convert percentage coordinates to stage point. */\nexport function stagePercentToStagePoint(stagePercent: PercentPoint, stageSize: number): Point2D {\n  const stageFactor = stageSize / 100;\n  return {\n    x: stagePercent.x * stageFactor,\n    y: stagePercent.y * stageFactor,\n  };\n}\n\n// Core positioning algorithm with rotation support for extended range pivots\n\n/** Get image center from ImageMapping. */\nexport function getImageCenter(mapping: ImageMapping): Point2D {\n  return {\n    x: mapping.imageDimensions.width / 2,\n    y: mapping.imageDimensions.height / 2,\n  };\n}\n\n/** Calculate layer position for pivot-based anchoring WITH ROTATION SUPPORT. */\nexport function calculatePositionForPivot(\n  stageAnchor: Point2D,\n  pivotPercent: PercentPoint,\n  imageMapping: ImageMapping,\n  scale: Point2D,\n  rotationDeg: number = 0,\n): Point2D {\n  const rotationRad = degreesToRadians(rotationDeg);\n  const imageCenter = getImageCenter(imageMapping);\n\n  // Convert pivot percent to image pixels (supports extended range)\n  const pivotPoint: Point2D = {\n    x: (pivotPercent.x / 100) * imageMapping.imageDimensions.width,\n    y: (pivotPercent.y / 100) * imageMapping.imageDimensions.height,\n  };\n\n  // Calculate offset from center to pivot point and apply scale\n  const offsetFromCenter: Point2D = {\n    x: (pivotPoint.x - imageCenter.x) * scale.x,\n    y: (pivotPoint.y - imageCenter.y) * scale.y,\n  };\n\n  // Rotate the scaled offset\n  const cosR = Math.cos(rotationRad);\n  const sinR = Math.sin(rotationRad);\n\n  const rotatedOffset: Point2D = {\n    x: offsetFromCenter.x * cosR - offsetFromCenter.y * sinR,\n    y: offsetFromCenter.x * sinR + offsetFromCenter.y * cosR,\n  };\n\n  // Calculate final position: stageAnchor - rotatedOffset\n  return {\n    x: stageAnchor.x - rotatedOffset.x,\n    y: stageAnchor.y - rotatedOffset.y,\n  };\n}\n\n// Create structured coordinate objects with both pixel and percent values\n\n/** Create a coordinate bundle (point + percent representation). */\nexport function createCoordinateBundle(point: Point2D, percent: PercentPoint): CoordinateBundle {\n  return { point, percent };\n}\n\n/** Create a dual-space coordinate (image + stage representations). */\nexport function createDualSpaceCoordinate(\n  imagePoint: Point2D,\n  imagePercent: PercentPoint,\n  stagePoint: Point2D,\n  stagePercent: PercentPoint,\n): DualSpaceCoordinate {\n  return {\n    image: createCoordinateBundle(imagePoint, imagePercent),\n    stage: createCoordinateBundle(stagePoint, stagePercent),\n  };\n}\n\n// Angle conversions, normalization, and orbital calculations\n\n/** Animation constants for common calculations. */\nexport const AnimationConstants = {\n  DEG_TO_RAD: Math.PI / 180,\n  RAD_TO_DEG: 180 / Math.PI,\n  TWO_PI: Math.PI * 2,\n  HALF_PI: Math.PI / 2,\n  QUARTER_PI: Math.PI / 4,\n} as const;\n\n/** Convert degrees to radians. */\nexport function degreesToRadians(degrees: number): number {\n  return degrees * AnimationConstants.DEG_TO_RAD;\n}\n\n/** Convert radians to degrees. */\nexport function radiansToDegrees(radians: number): number {\n  return radians * AnimationConstants.RAD_TO_DEG;\n}\n\n/** Normalize angle to 0-360 range. */\nexport function normalizeAngle(angle: number): number {\n  return ((angle % 360) + 360) % 360;\n}\n\n/** Apply rotation direction to angle. */\nexport function applyRotationDirection(angle: number, direction: \"cw\" | \"ccw\"): number {\n  return direction === \"ccw\" ? -angle : angle;\n}\n\n/** Calculate position on circular orbit. */\nexport function calculateOrbitPosition(\n  center: { x: number; y: number },\n  radius: number,\n  angleInDegrees: number,\n): { x: number; y: number } {\n  const angleRad = degreesToRadians(angleInDegrees);\n  return {\n    x: center.x + radius * Math.cos(angleRad),\n    y: center.y + radius * Math.sin(angleRad),\n  };\n}\n\n/** Calculate angle from center to point. */\nexport function calculateAngleToPoint(\n  center: { x: number; y: number },\n  point: { x: number; y: number },\n): number {\n  const dx = point.x - center.x;\n  const dy = point.y - center.y;\n  return radiansToDegrees(Math.atan2(dy, dx));\n}\n\n/** Check if point is within bounds (with optional margin). */\nexport function isPointInBounds(\n  point: { x: number; y: number },\n  bounds: { min: number; max: number },\n  margin: number = 0,\n): boolean {\n  return (\n    point.x >= bounds.min - margin &&\n    point.x <= bounds.max + margin &&\n    point.y >= bounds.min - margin &&\n    point.y <= bounds.max + margin\n  );\n}\n\n/** Calculate if orbital layer is visible on stage. */\nexport function calculateOrbitalVisibility(\n  position: { x: number; y: number },\n  dimensions: { width: number; height: number },\n  stageBounds: { min: number; max: number },\n): boolean {\n  const halfWidth = dimensions.width / 2;\n  const halfHeight = dimensions.height / 2;\n\n  return !(\n    position.x + halfWidth < stageBounds.min ||\n    position.x - halfWidth > stageBounds.max ||\n    position.y + halfHeight < stageBounds.min ||\n    position.y - halfHeight > stageBounds.max\n  );\n}\n\n/** Calculate distance between two points. */\nexport function distanceBetween(a: Point2D, b: Point2D): number {\n  const dx = a.x - b.x;\n  const dy = a.y - b.y;\n  return Math.hypot(dx, dy);\n}\n\n// Timezone parsing, clock speed resolution, rotation calculations\n\n// Constants for time calculations\nconst MILLIS_PER_MINUTE = 60_000;\nconst MILLIS_PER_HOUR = 60 * MILLIS_PER_MINUTE;\nconst TIMEZONE_REGEX = /^UTC(?:(?<sign>[+-])(?<hours>\\d{1,2})(?::?(?<minutes>\\d{2}))?)?$/i;\n\n// Check if running in development environment (for warnings)\nconst metaEnv = (import.meta as any)?.env;\nconst IS_DEV_ENV = Boolean(metaEnv?.DEV);\n\n/** Convert a rotation direction literal into a numeric sign (1 = CW, -1 = CCW). */\nexport function toDirectionSign(direction: RotationDirection): DirectionSign {\n  return direction === \"ccw\" ? -1 : 1;\n}\n\n/** Parse a timezone string in the form \"UTC\", \"UTC+8\", \"UTC-05\", \"UTC+05:30\". */\nexport function parseTimezoneOffset(input?: string | null): number {\n  if (!input) return 0;\n\n  const match = TIMEZONE_REGEX.exec(input.trim());\n  if (!match) {\n    if (IS_DEV_ENV) {\n      console.warn(`[math] Unsupported timezone format \"${input}\". Falling back to UTC.`);\n    }\n    return 0;\n  }\n\n  const sign = match.groups?.sign === \"-\" ? -1 : 1;\n  const hours = Number(match.groups?.hours ?? \"0\");\n  const minutes = Number(match.groups?.minutes ?? \"0\");\n\n  if (!Number.isFinite(hours) || !Number.isFinite(minutes)) {\n    return 0;\n  }\n\n  return sign * (hours * 60 + minutes);\n}\n\n/** Resolve timezone offset for a motion config, falling back to stage default. */\nexport function resolveTimezoneOffset(\n  motion: ClockMotionConfig | undefined,\n  defaultTimezoneOffset: number,\n): number {\n  if (!motion?.timezone) return defaultTimezoneOffset;\n  const offset = parseTimezoneOffset(motion.timezone);\n  return Number.isFinite(offset) ? offset : defaultTimezoneOffset;\n}\n\n/** Determine whether the speed setting references a real-time alias. */\nfunction isAliasSpeed(speed?: ClockSpeedSetting): speed is ClockSpeedAlias {\n  return typeof speed === \"string\" && CLOCK_SPEED_ALIASES.includes(speed as ClockSpeedAlias);\n}\n\n/** Extract numeric value from the speed setting when it is not an alias. */\nfunction resolveNumericValue(speed?: ClockSpeedSetting): number | undefined {\n  if (typeof speed === \"number\") return speed;\n  if (typeof speed === \"object\" && speed !== null && \"value\" in speed) {\n    const value = (speed as ClockSpeedValue).value;\n    return Number.isFinite(value) ? value : undefined;\n  }\n  return undefined;\n}\n\n/** Resolve direction preference from config with fallbacks. */\nfunction resolveDirection(\n  speed: ClockSpeedSetting | undefined,\n  motion: ClockMotionConfig | undefined,\n): RotationDirection {\n  if (typeof speed === \"object\" && speed !== null && \"direction\" in speed && speed.direction) {\n    return speed.direction;\n  }\n  if (motion?.direction) return motion.direction;\n  return CLOCK_DEFAULTS.direction;\n}\n\n/** Resolve time format preference with fallback to defaults. */\nfunction resolveFormat(motion?: ClockMotionConfig): TimeFormat {\n  const format = motion?.format;\n  return format === \"12\" || format === \"24\" ? format : CLOCK_DEFAULTS.timeFormat;\n}\n\n/** Resolve motion configuration into runtime structure. */\nexport function resolveClockSpeed(\n  motion: ClockMotionConfig | undefined,\n  defaultTimezoneOffset: number,\n  fallbackNumericSpeed: number = CLOCK_DEFAULTS.numericSpeed,\n): ResolvedClockSpeed {\n  const format = resolveFormat(motion);\n  const timezoneOffset = resolveTimezoneOffset(motion, defaultTimezoneOffset);\n  const speed = motion?.speed;\n\n  // Alias speeds (second, minute, hour) - always follow real time\n  if (isAliasSpeed(speed)) {\n    return {\n      kind: \"alias\",\n      alias: speed,\n      format,\n      timezoneOffsetMinutes: timezoneOffset,\n    };\n  }\n\n  // Numeric speeds (rotations per hour)\n  const numericValue = resolveNumericValue(speed);\n  const value = numericValue !== undefined ? numericValue : fallbackNumericSpeed;\n\n  // Warn about negative speeds in development\n  if (numericValue !== undefined && numericValue < 0 && IS_DEV_ENV) {\n    console.warn(\n      `[math] Negative speed \"${numericValue}\" detected. Using absolute value for rotations per hour.`,\n    );\n  }\n\n  // Static (no rotation)\n  if (!Number.isFinite(value) || value === 0) {\n    return {\n      kind: \"static\",\n      format,\n      timezoneOffsetMinutes: timezoneOffset,\n    };\n  }\n\n  // Numeric rotation\n  const direction = resolveDirection(speed, motion);\n  return {\n    kind: \"numeric\",\n    rotationsPerHour: Math.abs(value),\n    directionSign: toDirectionSign(direction),\n    format,\n    timezoneOffsetMinutes: timezoneOffset,\n  };\n}\n\n/** Get a cached Date instance shifted by timezone offset. */\nfunction getZonedDate(baseDate: Date, offsetMinutes: number, cache: Map<number, Date>): Date {\n  let cached = cache.get(offsetMinutes);\n  const targetTime = baseDate.getTime() + offsetMinutes * MILLIS_PER_MINUTE;\n\n  if (!cached) {\n    cached = new Date(targetTime);\n    cache.set(offsetMinutes, cached);\n  } else {\n    cached.setTime(targetTime);\n  }\n\n  return cached;\n}\n\n/** Calculate rotation degrees for alias speeds using clock semantics. */\nfunction calculateAliasAngleDegrees(\n  alias: ClockSpeedAlias,\n  format: TimeFormat,\n  date: Date,\n): number {\n  const seconds = date.getUTCSeconds() + date.getUTCMilliseconds() / 1000;\n  const minutes = date.getUTCMinutes() + seconds / 60;\n  const hours24 = date.getUTCHours() + minutes / 60;\n\n  switch (alias) {\n    case \"second\": {\n      const fraction = seconds / 60;\n      return (fraction % 1) * 360;\n    }\n    case \"minute\": {\n      const fraction = minutes / 60;\n      return (fraction % 1) * 360;\n    }\n    case \"hour\": {\n      if (format === \"24\") {\n        // 24-hour format: 0-24 hours maps to full circle\n        const hours = hours24 % 24;\n        // Offset by 12 hours so 12:00 is at top (270°)\n        const adjusted = ((hours - 12 + 24) % 24) / 24;\n        return (adjusted % 1) * 360;\n      }\n      // 12-hour format: 0-12 hours maps to full circle\n      const hours = hours24 % 12;\n      const fraction = hours / 12;\n      return (fraction % 1) * 360;\n    }\n    default:\n      return 0;\n  }\n}\n\n/** Calculate rotation degrees for numeric speeds (rotations per hour). */\nfunction calculateNumericAngleDegrees(\n  rotationsPerHour: number,\n  directionSign: DirectionSign,\n  elapsedMs: number,\n): number {\n  if (rotationsPerHour === 0) return 0;\n\n  const elapsedHours = elapsedMs / MILLIS_PER_HOUR;\n  const rotations = (elapsedHours * rotationsPerHour) % 1;\n  const degrees = rotations * 360 * directionSign;\n\n  // Normalize to 0-360 range\n  return normalizeAngle(degrees);\n}\n\n/** Compute rotation angle in degrees for a resolved speed. */\nexport function calculateRotationDegrees(\n  resolved: ResolvedClockSpeed,\n  baseDate: Date,\n  cache: Map<number, Date>,\n  startTimestampMs?: number,\n): number {\n  if (resolved.kind === \"static\") {\n    return 0;\n  }\n\n  if (resolved.kind === \"numeric\") {\n    const elapsedMs =\n      startTimestampMs !== undefined ? Math.max(0, baseDate.getTime() - startTimestampMs) : 0;\n    return calculateNumericAngleDegrees(\n      resolved.rotationsPerHour,\n      resolved.directionSign,\n      elapsedMs,\n    );\n  }\n\n  // Alias - use timezone-adjusted date\n  const date = getZonedDate(baseDate, resolved.timezoneOffsetMinutes, cache);\n  return calculateAliasAngleDegrees(resolved.alias, resolved.format, date);\n}\n\n// Ensure all values are safe, finite, and within expected ranges\n\n/** Validate and sanitize a 2D point. */\nexport function validatePoint(point: Point2D, fallback: Point2D = { x: 0, y: 0 }): Point2D {\n  const x = Number.isFinite(point.x) ? point.x : fallback.x;\n  const y = Number.isFinite(point.y) ? point.y : fallback.y;\n  return { x, y };\n}\n\n/** Validate and sanitize scale values. */\nexport function validateScale(scale: Point2D, fallback: Point2D = { x: 1, y: 1 }): Point2D {\n  let x = Number.isFinite(scale.x) && scale.x > 0 ? scale.x : fallback.x;\n  let y = Number.isFinite(scale.y) && scale.y > 0 ? scale.y : fallback.y;\n\n  // Clamp to reasonable range (0.01 to 10)\n  x = Math.max(0.01, Math.min(10, x));\n  y = Math.max(0.01, Math.min(10, y));\n\n  return { x, y };\n}\n\n/** Validate dimensions object. */\nexport function validateDimensions(\n  dimensions: { width: number; height: number },\n  fallback: { width: number; height: number } = { width: 100, height: 100 },\n): { width: number; height: number } {\n  const width =\n    Number.isFinite(dimensions.width) && dimensions.width > 0 ? dimensions.width : fallback.width;\n  const height =\n    Number.isFinite(dimensions.height) && dimensions.height > 0\n      ? dimensions.height\n      : fallback.height;\n  return { width, height };\n}\n\n/** Clamp percentage value to 0-100 range. */\nexport function clampPercent(value: number): number {\n  if (!Number.isFinite(value)) return 0;\n  return Math.max(0, Math.min(100, value));\n}\n\n/** Normalize percentage value (supports extended range for external points). */\nexport function normalizePercent(value: number): number {\n  if (!Number.isFinite(value)) return 0;\n  return value;\n}\n\n/** Clamp stage coordinate to valid range. */\nexport function clampStage(value: number, stageSize: number): number {\n  if (!Number.isFinite(value)) return 0;\n  return Math.max(0, Math.min(stageSize, value));\n}\n\n/** Convert percentage to scale factor with clamping. */\nexport function clampedPercentToScale(percent: number): number {\n  const clamped = Math.max(10, Math.min(500, percent));\n  return clamped / 100;\n}\n\n/** Normalize array input to [x, y] pair. */\nexport function normalizePair(\n  value: number[] | undefined,\n  fallbackX: number,\n  fallbackY: number,\n): [number, number] {\n  if (!Array.isArray(value) || value.length === 0) return [fallbackX, fallbackY];\n  const [first, second] = value;\n  const x = typeof first === \"number\" && Number.isFinite(first) ? first : fallbackX;\n  const y = typeof second === \"number\" && Number.isFinite(second) ? second : fallbackY;\n  return [x, y];\n}\n\n/** Normalize percentage input to PercentPoint. */\nexport function normalizePercentInput(\n  value: number[] | PercentPoint | undefined,\n  fallbackX: number,\n  fallbackY: number,\n): PercentPoint {\n  if (Array.isArray(value) && value.length >= 2) {\n    return {\n      x: normalizePercent(value[0] ?? fallbackX),\n      y: normalizePercent(value[1] ?? fallbackY),\n    };\n  }\n  if (value && typeof value === \"object\" && \"x\" in value && \"y\" in value) {\n    const { x, y } = value as PercentPoint;\n    return {\n      x: normalizePercent(x),\n      y: normalizePercent(y),\n    };\n  }\n  return {\n    x: normalizePercent(fallbackX),\n    y: normalizePercent(fallbackY),\n  };\n}\n\n/** Normalize array input to stage Point2D. */\nexport function normalizeStagePointInput(\n  value: number[] | undefined,\n  fallback: Point2D,\n  stageSize: number,\n): Point2D {\n  if (Array.isArray(value) && value.length >= 2) {\n    return {\n      x: clampStage(value[0] ?? fallback.x, stageSize),\n      y: clampStage(value[1] ?? fallback.y, stageSize),\n    };\n  }\n  return fallback;\n}\n\n// Smooth animation curves for transitions and effects\n\n/** Ease-in-out quadratic easing function. */\nexport function easeInOutQuad(t: number): number {\n  return t < 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2;\n}\n\n/** Elastic easing out function. */\nexport function easeOutElastic(t: number): number {\n  const c4 = (2 * Math.PI) / 3;\n  return t === 0 ? 0 : t === 1 ? 1 : Math.pow(2, -10 * t) * Math.sin((t * 10 - 0.75) * c4) + 1;\n}\n\n/** Bounce easing out function. */\nexport function easeOutBounce(t: number): number {\n  const n1 = 7.5625;\n  const d1 = 2.75;\n  if (t < 1 / d1) {\n    return n1 * t * t;\n  }\n  if (t < 2 / d1) {\n    const p = t - 1.5 / d1;\n    return n1 * p * p + 0.75;\n  }\n  if (t < 2.5 / d1) {\n    const p = t - 2.25 / d1;\n    return n1 * p * p + 0.9375;\n  }\n  const p = t - 2.625 / d1;\n  return n1 * p * p + 0.984375;\n}\n","path":null,"size_bytes":20104,"size_tokens":null},"shared/component/list2.tsx":{"content":"import {\n  ArrowRight,\n  Award,\n  Building2,\n  HeartHandshake,\n  Leaf,\n  Lightbulb,\n  Trophy,\n} from \"lucide-react\";\nimport React from \"react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\n\ninterface ListItem {\n  icon: React.ReactNode;\n  title: string;\n  category: string;\n  description: string;\n  link: string;\n}\n\ninterface List2Props {\n  heading?: string;\n  items?: ListItem[];\n}\n\nconst List2 = ({\n  heading = \"Our Achievements & Recognition\",\n  items = [\n    {\n      icon: <Trophy />,\n      title: \"Industry Recognition\",\n      category: \"Achievement\",\n      description: \"Outstanding Performance Award.\",\n      link: \"#\",\n    },\n    {\n      icon: <Award />,\n      title: \"Excellence Award\",\n      category: \"Recognition\",\n      description: \"Best in Category Winner.\",\n      link: \"#\",\n    },\n    {\n      icon: <Lightbulb />,\n      title: \"Innovation Prize\",\n      category: \"Technology\",\n      description: \"Breakthrough Solution of the Year.\",\n      link: \"#\",\n    },\n    {\n      icon: <HeartHandshake />,\n      title: \"Customer Success\",\n      category: \"Service\",\n      description: \"Top-Rated Solution Provider.\",\n      link: \"#\",\n    },\n    {\n      icon: <Building2 />,\n      title: \"Global Leadership\",\n      category: \"Management\",\n      description: \"Executive Team of the Year.\",\n      link: \"#\",\n    },\n    {\n      icon: <Leaf />,\n      title: \"Sustainability Impact\",\n      category: \"Environmental\",\n      description: \"Green Initiative Excellence.\",\n      link: \"#\",\n    },\n  ],\n}: List2Props) => {\n  return (\n    <section className=\"py-32\">\n      <div className=\"container px-0 md:px-8\">\n        <h1 className=\"mb-10 px-4 text-3xl font-semibold md:mb-14 md:text-4xl\">\n          {heading}\n        </h1>\n        <div className=\"flex flex-col\">\n          <Separator />\n          {items.map((item, index) => (\n            <React.Fragment key={index}>\n              <div className=\"grid items-center gap-4 px-4 py-5 md:grid-cols-4\">\n                <div className=\"order-2 flex items-center gap-2 md:order-none\">\n                  <span className=\"bg-muted flex h-14 w-16 shrink-0 items-center justify-center rounded-md\">\n                    {item.icon}\n                  </span>\n                  <div className=\"flex flex-col gap-1\">\n                    <h3 className=\"font-semibold\">{item.title}</h3>\n                    <p className=\"text-muted-foreground text-sm\">\n                      {item.category}\n                    </p>\n                  </div>\n                </div>\n                <p className=\"order-1 text-2xl font-semibold md:order-none md:col-span-2\">\n                  {item.description}\n                </p>\n                <Button variant=\"outline\" asChild>\n                  <a\n                    className=\"order-3 ml-auto w-fit gap-2 md:order-none\"\n                    href={item.link}\n                  >\n                    <span>View project</span>\n                    <ArrowRight className=\"h-4 w-4\" />\n                  </a>\n                </Button>\n              </div>\n              <Separator />\n            </React.Fragment>\n          ))}\n        </div>\n      </div>\n    </section>\n  );\n};\n\nexport { List2 };\n","path":null,"size_bytes":3220,"size_tokens":null},"replit.md":{"content":"# Yuzha Animation Framework\n\n## Overview\n\nThe Yuzha Animation Framework is a modern TypeScript-based animation framework that generates animated visual outputs using a JSON-based \"Layer System.\" Built as a monorepo with React, Vite, Three.js (WebGL), and Canvas 2D, it features an intelligent dual-renderer system. The project aims to provide a robust and performant solution for creating complex animations with clear architecture and efficient rendering.\n\n## User Preferences\n\nCommunication: Simple, everyday language\n\n## System Architecture\n\nThe framework utilizes a dual-renderer system, defaulting to Three.js WebGL for production and falling back to Canvas 2D for AI agents or screenshot generation, with automatic headless browser detection. Both renderers share identical animation patterns and operate on a fixed 2048x2048 coordinate system that dynamically scales.\n\nCore animation logic is driven by a Layer System where JSON configurations define layers processed by a pipeline (e.g., `Spin Processor`) before rendering. The configuration separates layer identity from feature-specific groups. Performance is optimized through pipeline caching, pre-calculated math constants, static layer buffering, and lazy calculations. Debugging is supported by an Image Mapping Debug visualization system with configurable visual helpers. The system uses an extended coordinate system supporting negative and >100% percent values for advanced animation capabilities.\n\n**Key Technical Implementations & Design Choices:**\n\n- **Monorepo Structure:** `yuzha/` for the main application and `shared/` for common logic.\n- **Rendering:** Three.js (WebGL) for high-performance; Canvas 2D as fallback.\n- **Coordinate System:** Stage2048 system (2048x2048 pixels) for consistent scaling, `normalizePercent()` for extended range.\n- **Layer System:** JSON config drives `LayerCore` with extensible processors for transformations and animations, consolidated under `shared/layer/`.\n- **Configuration:** `ConfigYuzha.json` defines layer properties and animation parameters in a flat structure, with `transformConfig` for conditional overrides and clock alias normalization.\n- **Performance:** Pipeline caching, pre-calculated constants, `StaticLayerBuffer`, image dimension/mapping caches, lazy calculations, and `React.memo`.\n- **Debugging:** `ImageMappingDebugConfig` for visual helpers across renderers.\n- **TypeScript:** Strict type checking with Vite for compilation.\n\n## Recent Architecture Changes\n\n### Timestamp Overlay System Refactoring (Dec 2025) - COMPLETED\n\n**Objective:** Transform hardcoded 3-section text overlay system into a dynamic, expandable overlay system supporting unlimited text and image overlays.\n\n**Phase 1 - Dynamic Overlay Array Architecture:**\n\n1. **Type System Redesign:**\n   - Created `BaseOverlay`, `TextOverlay`, `ImageOverlay` discriminated union types\n   - Unified overlay structure with `id`, `type`, `position`, and type-specific fields\n   - Location: `yuzha/src/timestamp/types.ts`\n\n2. **State Management Consolidation:**\n   - Replaced 3 separate useState hooks with single `overlays: Overlay[]` array\n   - Map-based ref management: `useRef<Map<string, TimestampFloatingRef>>`\n   - Added `syncOverlayPositionsFromRefs()` for position synchronization\n   - Location: `yuzha/src/timestamp/timestampScreen.tsx`\n\n**Phase 2 - Collision Detection:**\n\n1. **AABB Collision Utilities:**\n   - `checkAABBCollision()` - Tests if two bounding boxes overlap\n   - `resolveCollision()` - Uses previous position to determine minimal axis correction\n   - Location: `yuzha/src/timestamp/types.ts`\n\n2. **Block Behavior:**\n   - Overlays cannot overlap; dragging into another overlay pushes it back\n   - Visual feedback: red outline during collision state\n   - Collision checks happen in real-time during drag events\n\n**Phase 3 - Image Overlay Support:**\n\n1. **ImageFloating Component:**\n   - Created `yuzha/src/timestamp/ImageFloating.tsx`\n   - Supports drag and resize with corner handles\n   - Separate ref management: `imageOverlayRefsMap` for image overlays\n   - Interface: `ImageFloatingRef` with `getRelativePosition`, `setRelativePosition`, `getSize`\n\n2. **Image Lifecycle:**\n   - `addImageOverlay(src, width, height)` - Creates new image overlay with auto-scaling\n   - `deleteImageOverlay(id)` - Removes image overlay and cleans up refs\n   - `nextImageId` uses functional updates to prevent ID reuse after deletions\n\n3. **Canvas Export:**\n   - `handleSave()` awaits all image loads via Promise.all before drawing\n   - Images render correctly in exported PNG\n\n**Phase 4 - V3 Preset Migration:**\n\n1. **TimestampPresetV3 Format:**\n   - Stores full `overlays: Overlay[]` array including image overlays\n   - Replaces separate `time`, `date`, `location` fields from V2\n\n2. **Automatic Migration:**\n   - `migrateV2toV3()` converts V2 presets to V3 on load\n   - Chain migration: V1 → V2 → V3 for legacy presets\n   - Location: `yuzha/src/timestamp/PresetManager.ts`\n\n3. **Save/Load Updates:**\n   - `handleSavePreset()` saves complete overlays array with synced positions\n   - `handleLoadPreset()` restores all overlays including images, resets `nextImageId`\n\n**Architecture Principles:**\n\n- `overlays` state = Single source of truth for overlay data\n- Refs store real-time drag positions; sync to state before saves/history\n- `getCurrentState()` always fetches fresh positions from refs\n- `DEFAULT_OVERLAYS` defines the 3 permanent sections (time, date, location)\n- Collision resolution uses previous position for stable \"block\" behavior\n- Image overlay IDs use functional state updates to prevent reuse\n- Blob URLs are revoked on delete/preset load to prevent memory leaks\n\n**Known Limitations:**\n\n- Image overlays use blob: URLs which are session-only; saved presets store the URL but images will not persist across browser sessions\n- For persistent images, a future enhancement could convert to base64 or server storage\n\n**Key Files:**\n\n- `yuzha/src/timestamp/types.ts` - Type definitions, collision utilities\n- `yuzha/src/timestamp/timestampScreen.tsx` - Main component, state management\n- `yuzha/src/timestamp/TimestampFloating.tsx` - Text overlay component\n- `yuzha/src/timestamp/ImageFloating.tsx` - Image overlay component\n- `yuzha/src/timestamp/TimestampSettings.tsx` - Settings panel, preset UI\n- `yuzha/src/timestamp/PresetManager.ts` - Preset storage, V1/V2/V3 migration\n\n### Layer Module Simplification Refactoring (Nov 2025)\n\n**Objective:** Consolidate duplicate code in the `shared/layer/` module to establish clear single sources of truth and improve maintainability.\n\n**Changes Implemented:**\n\n1. **Asset Path Case Sensitivity Fix:**\n   - Renamed `shared/Asset/` → `shared/asset/` for Linux/production compatibility\n   - Updated all references in `engine.ts` and `ImageRegistry.json`\n\n2. **Configuration Consolidation:**\n   - **Before:** Duplicate config loading in `Config.ts` and `model.ts`\n   - **After:** `model.ts` is the single source for types and config loading\n   - Deleted: `shared/layer/Config.ts`\n   - All imports now use barrel exports from `index.ts` → `model.ts`\n\n3. **Math/Clock Function Consolidation:**\n   - **Before:** Clock/time functions split between `clockTime.ts` and `math.ts`\n   - **After:** `math.ts` is the single source for all pure calculation functions\n   - Deleted: `shared/layer/clockTime.ts`\n   - Consolidated: `resolveClockSpeed`, `calculateRotationDegrees`, timezone parsing, etc.\n\n4. **Asset Loading Production Fix:**\n   - **Critical Issue:** Dynamic `new URL()` construction prevented Vite from bundling assets in production\n   - **Solution:** Implemented static asset manifest using `import.meta.glob('../asset/*.{png,jpg,...}', { eager: true, query: '?url', import: 'default' })`\n   - **Result:** Vite can now statically analyze and bundle all assets for production builds\n\n5. **Barrel Export Cleanup:**\n   - Updated `shared/layer/index.ts` to export from `model.ts` and `math.ts`\n   - Fixed all import paths in `StageSystem.ts`, `engine.ts` to use barrel exports\n   - Removed unused imports and fixed ESLint violations\n\n**Architecture Principles for Future AI Agents:**\n\n- `model.ts` = Single source of truth for types, constants, and configuration loading\n- `math.ts` = Single source of truth for pure calculation functions (no side effects)\n- `engine.ts` = Runtime execution layer that imports from `model.ts` and `math.ts`\n- `index.ts` = Barrel export that re-exports from the above modules\n- Asset loading MUST use `import.meta.glob` for Vite static analysis (critical for production builds)\n\n**Validation:**\n\n- ✅ TypeScript typecheck passes\n- ✅ ESLint passes (max-warnings=0)\n- ✅ Prettier formatting verified\n- ✅ All 19 layers load successfully in dev mode\n- ✅ Zero runtime errors in browser console\n- ✅ Production build compatibility ensured via static asset manifest\n\n## External Dependencies\n\n- **React 18:** Frontend UI library.\n- **TypeScript:** Programming language.\n- **Vite 7:** Build tool and development server.\n- **Three.js:** WebGL 3D library.\n- **Tailwind CSS:** Utility-first CSS framework.\n","path":null,"size_bytes":9088,"size_tokens":null},"shared/component/pagination_pagination-advanced-5.tsx":{"content":"import {\n  Pagination,\n  PaginationContent,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n} from \"@/components/ui/pagination\";\n\nexport const title = \"Disabled State\";\n\nconst Example = () => (\n  <Pagination>\n    <PaginationContent>\n      <PaginationItem>\n        <PaginationPrevious\n          className=\"pointer-events-none opacity-50\"\n          href=\"#\"\n        />\n      </PaginationItem>\n      <PaginationItem>\n        <PaginationLink href=\"#\" isActive>\n          1\n        </PaginationLink>\n      </PaginationItem>\n      <PaginationItem>\n        <PaginationLink href=\"#\">2</PaginationLink>\n      </PaginationItem>\n      <PaginationItem>\n        <PaginationLink href=\"#\">3</PaginationLink>\n      </PaginationItem>\n      <PaginationItem>\n        <PaginationNext href=\"#\" />\n      </PaginationItem>\n    </PaginationContent>\n  </Pagination>\n);\n\nexport default Example;\n","path":null,"size_bytes":897,"size_tokens":null}},"version":2}